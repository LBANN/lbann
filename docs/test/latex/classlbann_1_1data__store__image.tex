\hypertarget{classlbann_1_1data__store__image}{}\section{lbann\+:\+:data\+\_\+store\+\_\+image Class Reference}
\label{classlbann_1_1data__store__image}\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}


{\ttfamily \#include $<$data\+\_\+store\+\_\+image.\+hpp$>$}



Inheritance diagram for lbann\+:\+:data\+\_\+store\+\_\+image\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for lbann\+:\+:data\+\_\+store\+\_\+image\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image__coll__graph}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structlbann_1_1data__store__image_1_1Triple}{Triple}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1data__store__image_a8fd8c5546f405a964511823aed8ac986}{data\+\_\+store\+\_\+image} (\hyperlink{classlbann_1_1generic__data__reader}{generic\+\_\+data\+\_\+reader} $\ast$reader, \hyperlink{classlbann_1_1model}{model} $\ast$m)
\begin{DoxyCompactList}\small\item\em ctor \end{DoxyCompactList}\item 
\hyperlink{classlbann_1_1data__store__image_a12a813dca36d7faf2e3b36635faf2aab}{data\+\_\+store\+\_\+image} (const \hyperlink{classlbann_1_1data__store__image}{data\+\_\+store\+\_\+image} \&)=default
\begin{DoxyCompactList}\small\item\em copy ctor \end{DoxyCompactList}\item 
\hyperlink{classlbann_1_1data__store__image}{data\+\_\+store\+\_\+image} \& \hyperlink{classlbann_1_1data__store__image_a997fd4f7961b173e1b03dfe1d81ad96f}{operator=} (const \hyperlink{classlbann_1_1data__store__image}{data\+\_\+store\+\_\+image} \&)=default
\begin{DoxyCompactList}\small\item\em operator= \end{DoxyCompactList}\item 
\hyperlink{classlbann_1_1generic__data__store}{generic\+\_\+data\+\_\+store} $\ast$ \hyperlink{classlbann_1_1data__store__image_ab62efcb2dbe3118bf2815fa5d51fee61}{copy} () const override=0
\item 
\hyperlink{classlbann_1_1data__store__image_a1c6e508be9cbadcd63f79f2e2c24dba8}{$\sim$data\+\_\+store\+\_\+image} () override
\begin{DoxyCompactList}\small\item\em dtor \end{DoxyCompactList}\item 
void \hyperlink{classlbann_1_1data__store__image_a79280b3aa9a207dfacad2bcc9824ec73}{setup} () override
\begin{DoxyCompactList}\small\item\em called by \hyperlink{classlbann_1_1generic__data__reader_a8b2a09d38512fc11f1b9d572c89100a7}{generic\+\_\+data\+\_\+reader\+::setup\+\_\+data\+\_\+store} \end{DoxyCompactList}\item 
void \hyperlink{classlbann_1_1data__store__image_aa9e47fb3cad58dda4eaddcccc9bfa523}{get\+\_\+data\+\_\+buf} (int data\+\_\+id, std\+::vector$<$ unsigned char $>$ $\ast$\&buf, int multi\+\_\+idx=0) override
\begin{DoxyCompactList}\small\item\em data readers call this method \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classlbann_1_1data__store__image_a5ff5eccbd469caca692e8259f6f8c021}{exchange\+\_\+data} () override
\item 
virtual void \hyperlink{classlbann_1_1data__store__image_a8694bc9157c5fdc80bb5c251e68e18cb}{get\+\_\+file\+\_\+sizes} ()=0
\begin{DoxyCompactList}\small\item\em fills in m\+\_\+file\+\_\+sizes \end{DoxyCompactList}\item 
virtual void \hyperlink{classlbann_1_1data__store__image_a477529f2ba3f86598bbd409d3c2b6901}{exchange\+\_\+file\+\_\+sizes} (std\+::vector$<$ \hyperlink{structlbann_1_1data__store__image_1_1Triple}{Triple} $>$ \&my\+\_\+file\+\_\+sizes, int num\+\_\+global\+\_\+indices)
\begin{DoxyCompactList}\small\item\em called by get\+\_\+file\+\_\+sizes \end{DoxyCompactList}\item 
void \hyperlink{classlbann_1_1data__store__image_af74877e493b5a822dd3d3793a95ceb9d}{allocate\+\_\+memory} ()
\begin{DoxyCompactList}\small\item\em allocate mem for m\+\_\+data \end{DoxyCompactList}\item 
void \hyperlink{classlbann_1_1data__store__image_a8a53bab58d75554821f90c38d14078aa}{load\+\_\+file} (const std\+::string \&dir, const std\+::string \&fn, unsigned char $\ast$p, size\+\_\+t sz)
\begin{DoxyCompactList}\small\item\em loads file from disk into $\ast$p; checks that bytes read = sz \end{DoxyCompactList}\item 
virtual void \hyperlink{classlbann_1_1data__store__image_a146874a68c24213f5509efb9727cb6e5}{read\+\_\+files} ()=0
\begin{DoxyCompactList}\small\item\em reads all files assigned to this processor into memory (m\+\_\+data) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::unordered\+\_\+map$<$ size\+\_\+t, size\+\_\+t $>$ \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\+\_\+file\+\_\+sizes}
\begin{DoxyCompactList}\small\item\em maps a global index (wrt image\+\_\+list) to number of bytes in the file \end{DoxyCompactList}\item 
std\+::unordered\+\_\+map$<$ size\+\_\+t, size\+\_\+t $>$ \hyperlink{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}{m\+\_\+offsets}
\item 
std\+::unordered\+\_\+map$<$ int, std\+::vector$<$ unsigned char $>$ $>$ \hyperlink{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}{m\+\_\+my\+\_\+minibatch\+\_\+data}
\begin{DoxyCompactList}\small\item\em buffers that will be passed to reader\+::fetch\+\_\+datum \end{DoxyCompactList}\item 
unsigned int \hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\+\_\+num\+\_\+img\+\_\+srcs}
\begin{DoxyCompactList}\small\item\em in multi-\/image scenarios, the number of images in each sample \end{DoxyCompactList}\item 
std\+::vector$<$ unsigned char $>$ \hyperlink{classlbann_1_1data__store__image_a10e9aa0c240785bc0a961f24e87a1c16}{m\+\_\+data}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
todo 

Definition at line 40 of file data\+\_\+store\+\_\+image.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a8fd8c5546f405a964511823aed8ac986}\label{classlbann_1_1data__store__image_a8fd8c5546f405a964511823aed8ac986}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!data\+\_\+store\+\_\+image@{data\+\_\+store\+\_\+image}}
\index{data\+\_\+store\+\_\+image@{data\+\_\+store\+\_\+image}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{data\+\_\+store\+\_\+image()}{data\_store\_image()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily lbann\+::data\+\_\+store\+\_\+image\+::data\+\_\+store\+\_\+image (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1generic__data__reader}{generic\+\_\+data\+\_\+reader} $\ast$}]{reader,  }\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



ctor 



Definition at line 44 of file data\+\_\+store\+\_\+image.\+hpp.


\begin{DoxyCode}
44                                                           :
45     \hyperlink{classlbann_1_1generic__data__store_acbcd88161c06f4bb9a70bbae857d4ee0}{generic\_data\_store}(reader, m),
46     \hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs}(1) \{\}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a8fd8c5546f405a964511823aed8ac986_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a12a813dca36d7faf2e3b36635faf2aab}\label{classlbann_1_1data__store__image_a12a813dca36d7faf2e3b36635faf2aab}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!data\+\_\+store\+\_\+image@{data\+\_\+store\+\_\+image}}
\index{data\+\_\+store\+\_\+image@{data\+\_\+store\+\_\+image}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{data\+\_\+store\+\_\+image()}{data\_store\_image()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily lbann\+::data\+\_\+store\+\_\+image\+::data\+\_\+store\+\_\+image (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1data__store__image}{data\+\_\+store\+\_\+image} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



copy ctor 

\mbox{\Hypertarget{classlbann_1_1data__store__image_a1c6e508be9cbadcd63f79f2e2c24dba8}\label{classlbann_1_1data__store__image_a1c6e508be9cbadcd63f79f2e2c24dba8}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!````~data\+\_\+store\+\_\+image@{$\sim$data\+\_\+store\+\_\+image}}
\index{````~data\+\_\+store\+\_\+image@{$\sim$data\+\_\+store\+\_\+image}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{$\sim$data\+\_\+store\+\_\+image()}{~data\_store\_image()}}
{\footnotesize\ttfamily lbann\+::data\+\_\+store\+\_\+image\+::$\sim$data\+\_\+store\+\_\+image (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}}



dtor 



Definition at line 35 of file data\+\_\+store\+\_\+image.\+cpp.


\begin{DoxyCode}
35                                     \{
36 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a1c6e508be9cbadcd63f79f2e2c24dba8_icgraph}
\end{center}
\end{figure}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1data__store__image_af74877e493b5a822dd3d3793a95ceb9d}\label{classlbann_1_1data__store__image_af74877e493b5a822dd3d3793a95ceb9d}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!allocate\+\_\+memory@{allocate\+\_\+memory}}
\index{allocate\+\_\+memory@{allocate\+\_\+memory}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{allocate\+\_\+memory()}{allocate\_memory()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+image\+::allocate\+\_\+memory (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



allocate mem for m\+\_\+data 



Definition at line 98 of file data\+\_\+store\+\_\+image.\+cpp.


\begin{DoxyCode}
98                                        \{
99   \textcolor{keywordtype}{size\_t} m = 0;
100   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} t : \hyperlink{classlbann_1_1generic__data__store_abd38f8d8aab0648959e09d011abfe20a}{m\_my\_datastore\_indices}) \{
101     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<\hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs}; i++) \{
102       m += \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}[t*m\_num\_img\_srcs+i];
103     \}    
104   \}    
105   \hyperlink{classlbann_1_1data__store__image_a10e9aa0c240785bc0a961f24e87a1c16}{m\_data}.resize(m);
106 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_af74877e493b5a822dd3d3793a95ceb9d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_ab62efcb2dbe3118bf2815fa5d51fee61}\label{classlbann_1_1data__store__image_ab62efcb2dbe3118bf2815fa5d51fee61}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!copy@{copy}}
\index{copy@{copy}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1generic__data__store}{generic\+\_\+data\+\_\+store}$\ast$ lbann\+::data\+\_\+store\+\_\+image\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [pure virtual]}}



Implements \hyperlink{classlbann_1_1generic__data__store_ae06e089790aa023b839be508a3c020c6}{lbann\+::generic\+\_\+data\+\_\+store}.



Implemented in \hyperlink{classlbann_1_1data__store__multi__images_a1046efda9448bab9b42e9fcdf71e03f1}{lbann\+::data\+\_\+store\+\_\+multi\+\_\+images}, \hyperlink{classlbann_1_1data__store__triplet_a446ee3b1fa3097e51bd0e198de960cd4}{lbann\+::data\+\_\+store\+\_\+triplet}, \hyperlink{classlbann_1_1data__store__imagenet_ae3b0d31ac020c36f41766999288e2d25}{lbann\+::data\+\_\+store\+\_\+imagenet}, and \hyperlink{classlbann_1_1data__store__imagenet__patches_a5067e8299f5cf073497a5005ee9db759}{lbann\+::data\+\_\+store\+\_\+imagenet\+\_\+patches}.

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_ab62efcb2dbe3118bf2815fa5d51fee61_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a5ff5eccbd469caca692e8259f6f8c021}\label{classlbann_1_1data__store__image_a5ff5eccbd469caca692e8259f6f8c021}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!exchange\+\_\+data@{exchange\+\_\+data}}
\index{exchange\+\_\+data@{exchange\+\_\+data}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{exchange\+\_\+data()}{exchange\_data()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+image\+::exchange\+\_\+data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Implements \hyperlink{classlbann_1_1generic__data__store_a5a34663fbbc3714d45743a6ca7195f51}{lbann\+::generic\+\_\+data\+\_\+store}.



Definition at line 134 of file data\+\_\+store\+\_\+image.\+cpp.


\begin{DoxyCode}
134                                      \{
135   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"starting exchange\_data\(\backslash\)n"};
136   std::stringstream err;
137 
138   \textcolor{comment}{//build map: proc -> global indices that proc needs for this epoch, and}
139   \textcolor{comment}{//                   which I own}
140   std::unordered\_map<int, std::unordered\_set<int>> proc\_to\_indices;
141   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} p=0; p<\hyperlink{classlbann_1_1generic__data__store_afd21d4f029e450328f8703dd72702e73}{m\_all\_minibatch\_indices}.size(); p++) \{
142     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} idx : \hyperlink{classlbann_1_1generic__data__store_afd21d4f029e450328f8703dd72702e73}{m\_all\_minibatch\_indices}[p]) \{
143       \textcolor{keywordtype}{int} index = (*m\_shuffled\_indices)[idx];
144       \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_abd38f8d8aab0648959e09d011abfe20a}{m\_my\_datastore\_indices}.find(index) != 
      \hyperlink{classlbann_1_1generic__data__store_abd38f8d8aab0648959e09d011abfe20a}{m\_my\_datastore\_indices}.end()) \{
145         proc\_to\_indices[p].insert(index);
146       \}
147     \}
148   \}
149 
150   \textcolor{comment}{//start sends}
151   std::vector<std::vector<MPI\_Request>> send\_req(\hyperlink{classlbann_1_1generic__data__store_afcd4f99959c265c8c03dcf8ad3779d85}{m\_np});
152   std::vector<std::vector<MPI\_Status>> send\_status(\hyperlink{classlbann_1_1generic__data__store_afcd4f99959c265c8c03dcf8ad3779d85}{m\_np});
153   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p=0; p<\hyperlink{classlbann_1_1generic__data__store_afcd4f99959c265c8c03dcf8ad3779d85}{m\_np}; p++) \{
154     send\_req[p].resize(proc\_to\_indices[p].size()*\hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs});
155     send\_status[p].resize(proc\_to\_indices[p].size()*\hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs});
156     \textcolor{keywordtype}{size\_t} jj = 0;
157     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} idx : proc\_to\_indices[p]) \{
158       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} k=0; k<\hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs}; k++) \{
159         \textcolor{keywordtype}{int} index = idx*m\_num\_img\_srcs+k;
160         \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}.find(index) == \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}.end()) \{
161           err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
162               << \textcolor{stringliteral}{" m\_file\_sizes.find("} << index << \textcolor{stringliteral}{") failed"};
163           \textcolor{keywordflow}{throw} lbann\_exception(err.str());
164         \}
165         \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}{m\_offsets}.find(index) == \hyperlink{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}{m\_offsets}.end()) \{
166           err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
167               << \textcolor{stringliteral}{" m\_offets.find("} << index << \textcolor{stringliteral}{") failed"};
168           \textcolor{keywordflow}{throw} lbann\_exception(err.str());
169         \}
170         \textcolor{keywordtype}{int} len = \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}[index];
171         \textcolor{keywordtype}{size\_t} offset = \hyperlink{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}{m\_offsets}[index];
172         MPI\_Isend(\hyperlink{classlbann_1_1data__store__image_a10e9aa0c240785bc0a961f24e87a1c16}{m\_data}.data()+offset, len, MPI\_BYTE, p, index, 
      \hyperlink{classlbann_1_1generic__data__store_ae2d2d61d5d766a7f525eedcb05e0dbf6}{m\_mpi\_comm}, &(send\_req[p][jj++]));
173       \}
174     \}
175     \textcolor{keywordflow}{if} (jj != send\_req[p].size()) \textcolor{keywordflow}{throw} lbann\_exception(\textcolor{stringliteral}{"ERROR 1"});
176   \} \textcolor{comment}{//start sends}
177 
178 
179   \textcolor{comment}{//build map: proc -> global indices that proc owns that I need}
180   proc\_to\_indices.clear();
181   \textcolor{comment}{//note: datastore indices are global; no need to consult shuffled\_indices}
182   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} idx : \hyperlink{classlbann_1_1generic__data__store_a41f7fec1f1f3d6568a5765be7a6784eb}{m\_my\_minibatch\_indices\_v}) \{
183     \textcolor{keywordtype}{int} index = (*m\_shuffled\_indices)[idx];
184     \textcolor{keywordtype}{int} owner = \hyperlink{classlbann_1_1generic__data__store_ad0de5ac2cdcf3f692acb252a019a2aed}{get\_index\_owner}(index);
185     proc\_to\_indices[owner].insert(index);
186   \}
187   
188   \textcolor{comment}{//start recvs}
189   \hyperlink{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}{m\_my\_minibatch\_data}.clear();
190   std::vector<std::vector<MPI\_Request>> recv\_req(m\_np);
191   std::vector<std::vector<MPI\_Status>> recv\_status(m\_np);
192   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} t : proc\_to\_indices) \{
193     \textcolor{keywordtype}{int} owner = t.first;
194     \textcolor{keywordtype}{size\_t} jj = 0;
195     \textcolor{keyword}{const} std::unordered\_set<int> &s = t.second;
196     recv\_req[owner].resize(s.size()*\hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs});
197     recv\_status[owner].resize(s.size()*\hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs});
198     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} idx : s) \{
199       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} k=0; k<\hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs}; k++) \{
200         \textcolor{keywordtype}{size\_t} index = idx*m\_num\_img\_srcs+k;
201         \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}.find(index) == \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}.end()) \{
202           err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
203               << \textcolor{stringliteral}{" m\_file\_sizes.find("} << index << \textcolor{stringliteral}{") failed"}
204               << \textcolor{stringliteral}{" m\_file\_sizes.size(): "} << \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}.size()
205               << \textcolor{stringliteral}{" m\_my\_minibatch\_indices\_v.size(): "} << m\_my\_minibatch\_indices\_v.size();
206         \}
207         \textcolor{keywordtype}{size\_t} len = \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}[index];
208         \hyperlink{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}{m\_my\_minibatch\_data}[index].resize(len);
209         MPI\_Irecv(\hyperlink{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}{m\_my\_minibatch\_data}[index].\hyperlink{namespacelbann_1_1cnpy__utils_a9ac86d96ccb1f8b4b2ea16441738781f}{data}(), len, MPI\_BYTE, owner, index, 
      \hyperlink{classlbann_1_1generic__data__store_ae2d2d61d5d766a7f525eedcb05e0dbf6}{m\_mpi\_comm}, &(recv\_req[owner][jj++]));
210       \}
211     \}
212   \}
213 
214   \textcolor{comment}{//wait for sends to finish}
215   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<send\_req.size(); i++) \{
216     MPI\_Waitall(send\_req[i].size(), send\_req[i].\hyperlink{namespacelbann_1_1cnpy__utils_a9ac86d96ccb1f8b4b2ea16441738781f}{data}(), send\_status[i].\hyperlink{namespacelbann_1_1cnpy__utils_a9ac86d96ccb1f8b4b2ea16441738781f}{data}());
217   \}
218 
219   \textcolor{comment}{//wait for recvs to finish}
220   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<recv\_req.size(); i++) \{
221     MPI\_Waitall(recv\_req[i].size(), recv\_req[i].\hyperlink{namespacelbann_1_1cnpy__utils_a9ac86d96ccb1f8b4b2ea16441738781f}{data}(), recv\_status[i].\hyperlink{namespacelbann_1_1cnpy__utils_a9ac86d96ccb1f8b4b2ea16441738781f}{data}());
222   \}
223 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a5ff5eccbd469caca692e8259f6f8c021_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a5ff5eccbd469caca692e8259f6f8c021_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a477529f2ba3f86598bbd409d3c2b6901}\label{classlbann_1_1data__store__image_a477529f2ba3f86598bbd409d3c2b6901}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!exchange\+\_\+file\+\_\+sizes@{exchange\+\_\+file\+\_\+sizes}}
\index{exchange\+\_\+file\+\_\+sizes@{exchange\+\_\+file\+\_\+sizes}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{exchange\+\_\+file\+\_\+sizes()}{exchange\_file\_sizes()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+image\+::exchange\+\_\+file\+\_\+sizes (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{structlbann_1_1data__store__image_1_1Triple}{Triple} $>$ \&}]{my\+\_\+file\+\_\+sizes,  }\item[{int}]{num\+\_\+global\+\_\+indices }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



called by get\+\_\+file\+\_\+sizes 



Definition at line 226 of file data\+\_\+store\+\_\+image.\+cpp.


\begin{DoxyCode}
226                                                                                                    \{
227   std::vector<int> num\_bytes(\hyperlink{classlbann_1_1generic__data__store_afcd4f99959c265c8c03dcf8ad3779d85}{m\_np});
228   \textcolor{keywordtype}{int} bytes = my\_file\_sizes.size()*\textcolor{keyword}{sizeof}(Triple);
229   MPI\_Allgather(&bytes, 1, MPI\_INT,
230                  num\_bytes.data(), 1, MPI\_INT,
231                  \hyperlink{classlbann_1_1generic__data__store_ae2d2d61d5d766a7f525eedcb05e0dbf6}{m\_mpi\_comm});
232 
233   std::vector<int> disp(\hyperlink{classlbann_1_1generic__data__store_a4381c1192e029d24c5b02cbd68988f77}{m\_num\_readers}); 
234   disp[0] = 0;
235   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h=1; h<(int)\hyperlink{classlbann_1_1generic__data__store_a4381c1192e029d24c5b02cbd68988f77}{m\_num\_readers}; h++) \{
236     disp[h] = disp[h-1] + num\_bytes[h-1];
237   \}
238   std::vector<Triple> global\_file\_sizes(num\_global\_indices);
239 
240   \textcolor{comment}{//@todo: couldn't get m\_comm->model\_gatherv to work}
241   \textcolor{comment}{//m\_comm->model\_gatherv(&my\_file\_sizes[0], my\_file\_sizes.size(), }
242    \textcolor{comment}{//                     &global\_file\_sizes[0], &num\_images[0], &disp[0]);}
243   MPI\_Allgatherv(my\_file\_sizes.data(), my\_file\_sizes.size()*\textcolor{keyword}{sizeof}(Triple), MPI\_BYTE,
244                  global\_file\_sizes.data(), num\_bytes.data(), disp.data(), MPI\_BYTE,
245                  \hyperlink{classlbann_1_1generic__data__store_ae2d2d61d5d766a7f525eedcb05e0dbf6}{m\_mpi\_comm});
246 
247   \textcolor{keywordtype}{size\_t} j = 0;
248   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} t : global\_file\_sizes) \{
249     \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}[t.global\_index] = t.num\_bytes;
250     \hyperlink{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}{m\_offsets}[t.global\_index] = t.offset;
251     \textcolor{keywordflow}{if} (t.num\_bytes <= 0) \{
252       std::stringstream err;
253       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "} 
254         << \textcolor{stringliteral}{"num\_bytes  <= 0 ("} << t.num\_bytes << \textcolor{stringliteral}{")"}
255         << \textcolor{stringliteral}{" for # "} << j << \textcolor{stringliteral}{" of "} << global\_file\_sizes.size();
256       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
257     \}
258     \textcolor{comment}{//m\_owner\_mapping[t.global\_index] = t.rank;}
259     ++j;
260   \}
261 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a477529f2ba3f86598bbd409d3c2b6901_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_aa9e47fb3cad58dda4eaddcccc9bfa523}\label{classlbann_1_1data__store__image_aa9e47fb3cad58dda4eaddcccc9bfa523}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!get\+\_\+data\+\_\+buf@{get\+\_\+data\+\_\+buf}}
\index{get\+\_\+data\+\_\+buf@{get\+\_\+data\+\_\+buf}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{get\+\_\+data\+\_\+buf()}{get\_data\_buf()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+image\+::get\+\_\+data\+\_\+buf (\begin{DoxyParamCaption}\item[{int}]{data\+\_\+id,  }\item[{std\+::vector$<$ unsigned char $>$ $\ast$\&}]{buf,  }\item[{int}]{multi\+\_\+idx = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



data readers call this method 



Reimplemented from \hyperlink{classlbann_1_1generic__data__store_a2abb3d0327b528d36e23fcef9b937798}{lbann\+::generic\+\_\+data\+\_\+store}.



Definition at line 84 of file data\+\_\+store\+\_\+image.\+cpp.


\begin{DoxyCode}
84                                                                                               \{
85   std::stringstream err;
86   \textcolor{keywordtype}{int} index = data\_id * \hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs} + multi\_idx;
87   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}{m\_my\_minibatch\_data}.find(index) == \hyperlink{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}{m\_my\_minibatch\_data}.end()) \{
88     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
89         << \textcolor{stringliteral}{"failed to find index: "} << index << \textcolor{stringliteral}{" m\_num\_img\_srcs: "} << 
      \hyperlink{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}{m\_num\_img\_srcs}
90         << \textcolor{stringliteral}{" multi\_idx: "} << multi\_idx << \textcolor{stringliteral}{" in m\_my\_data\_hash; role: "}
91         << \hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader}->\hyperlink{classlbann_1_1generic__data__reader_a92982e1b399f37e2ead5aa440883cba5}{get\_role}();
92     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
93   \}
94 
95   buf = &\hyperlink{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}{m\_my\_minibatch\_data}[index];
96 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_aa9e47fb3cad58dda4eaddcccc9bfa523_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_aa9e47fb3cad58dda4eaddcccc9bfa523_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a8694bc9157c5fdc80bb5c251e68e18cb}\label{classlbann_1_1data__store__image_a8694bc9157c5fdc80bb5c251e68e18cb}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!get\+\_\+file\+\_\+sizes@{get\+\_\+file\+\_\+sizes}}
\index{get\+\_\+file\+\_\+sizes@{get\+\_\+file\+\_\+sizes}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{get\+\_\+file\+\_\+sizes()}{get\_file\_sizes()}}
{\footnotesize\ttfamily virtual void lbann\+::data\+\_\+store\+\_\+image\+::get\+\_\+file\+\_\+sizes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}



fills in m\+\_\+file\+\_\+sizes 



Implemented in \hyperlink{classlbann_1_1data__store__multi__images_a25963dfa7d6de983e7b250f8ef7e2a0e}{lbann\+::data\+\_\+store\+\_\+multi\+\_\+images}, and \hyperlink{classlbann_1_1data__store__imagenet_ae8f5d8741ddd762ffd3a477504bca619}{lbann\+::data\+\_\+store\+\_\+imagenet}.

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a8694bc9157c5fdc80bb5c251e68e18cb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a8a53bab58d75554821f90c38d14078aa}\label{classlbann_1_1data__store__image_a8a53bab58d75554821f90c38d14078aa}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!load\+\_\+file@{load\+\_\+file}}
\index{load\+\_\+file@{load\+\_\+file}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{load\+\_\+file()}{load\_file()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+image\+::load\+\_\+file (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{dir,  }\item[{const std\+::string \&}]{fn,  }\item[{unsigned char $\ast$}]{p,  }\item[{size\+\_\+t}]{sz }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



loads file from disk into $\ast$p; checks that bytes read = sz 



Definition at line 108 of file data\+\_\+store\+\_\+image.\+cpp.


\begin{DoxyCode}
108                                                                                                        \{
109   std::string imagepath;
110   \textcolor{keywordflow}{if} (dir != \textcolor{stringliteral}{""}) \{
111     imagepath = dir + fn;
112   \} \textcolor{keywordflow}{else} \{
113     imagepath = fn;
114   \}
115   std::ifstream in(imagepath.c\_str(), std::ios::in | std::ios::binary);
116   \textcolor{keywordflow}{if} (!in) \{
117     std::stringstream err;
118     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
119         << \textcolor{stringliteral}{"failed to open "} << imagepath << \textcolor{stringliteral}{" for reading"}
120         << \textcolor{stringliteral}{"; dir: "} << dir << \textcolor{stringliteral}{"  fn: "} << fn;
121     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
122   \}
123   in.read((\textcolor{keywordtype}{char}*)p, sz);
124   \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{int})sz != in.gcount()) \{
125     std::stringstream err;
126     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
127         << \textcolor{stringliteral}{"failed to read "} << sz << \textcolor{stringliteral}{" bytes from "} << imagepath
128         << \textcolor{stringliteral}{" num bytes read: "} << in.gcount();
129     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
130   \}
131   in.close();
132 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a8a53bab58d75554821f90c38d14078aa_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a997fd4f7961b173e1b03dfe1d81ad96f}\label{classlbann_1_1data__store__image_a997fd4f7961b173e1b03dfe1d81ad96f}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1data__store__image}{data\+\_\+store\+\_\+image}\& lbann\+::data\+\_\+store\+\_\+image\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1data__store__image}{data\+\_\+store\+\_\+image} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



operator= 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a997fd4f7961b173e1b03dfe1d81ad96f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a146874a68c24213f5509efb9727cb6e5}\label{classlbann_1_1data__store__image_a146874a68c24213f5509efb9727cb6e5}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!read\+\_\+files@{read\+\_\+files}}
\index{read\+\_\+files@{read\+\_\+files}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{read\+\_\+files()}{read\_files()}}
{\footnotesize\ttfamily virtual void lbann\+::data\+\_\+store\+\_\+image\+::read\+\_\+files (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}



reads all files assigned to this processor into memory (m\+\_\+data) 



Implemented in \hyperlink{classlbann_1_1data__store__imagenet_a70cfd8f529aad8d66993000da7350ec5}{lbann\+::data\+\_\+store\+\_\+imagenet}, and \hyperlink{classlbann_1_1data__store__multi__images_a8ce8ccf3c7b0d19adfb838108bec075b}{lbann\+::data\+\_\+store\+\_\+multi\+\_\+images}.

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a146874a68c24213f5509efb9727cb6e5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a79280b3aa9a207dfacad2bcc9824ec73}\label{classlbann_1_1data__store__image_a79280b3aa9a207dfacad2bcc9824ec73}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!setup@{setup}}
\index{setup@{setup}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{setup()}{setup()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+image\+::setup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



called by \hyperlink{classlbann_1_1generic__data__reader_a8b2a09d38512fc11f1b9d572c89100a7}{generic\+\_\+data\+\_\+reader\+::setup\+\_\+data\+\_\+store} 



Reimplemented from \hyperlink{classlbann_1_1generic__data__store_a1cff17def02ee21b6ca0befeb04bb582}{lbann\+::generic\+\_\+data\+\_\+store}.



Reimplemented in \hyperlink{classlbann_1_1data__store__multi__images_a7b5e9ec7b7132872299a204d5d24ee62}{lbann\+::data\+\_\+store\+\_\+multi\+\_\+images}, \hyperlink{classlbann_1_1data__store__triplet_aca66b9cf71d7ba2b9870e76c5b92b5e8}{lbann\+::data\+\_\+store\+\_\+triplet}, \hyperlink{classlbann_1_1data__store__imagenet_a611aa1734a491c443396a077b49fe4fe}{lbann\+::data\+\_\+store\+\_\+imagenet}, and \hyperlink{classlbann_1_1data__store__imagenet__patches_aa8cfaf12c87f3dbbbb4fc808f6ca26ad}{lbann\+::data\+\_\+store\+\_\+imagenet\+\_\+patches}.



Definition at line 38 of file data\+\_\+store\+\_\+image.\+cpp.


\begin{DoxyCode}
38                              \{
39 
40   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"starting data\_store\_image::setup(); calling
       generic\_data\_store::setup()\(\backslash\)n"};
41   \hyperlink{classlbann_1_1generic__data__store_a1cff17def02ee21b6ca0befeb04bb582}{generic\_data\_store::setup}();
42 
43   \hyperlink{classlbann_1_1generic__data__store_a853741295a07b5687921fc56d0d7d5b2}{set\_name}(\textcolor{stringliteral}{"data\_store\_image"});
44 
45   \textcolor{comment}{//@todo needs to be designed and implemented!}
46   \textcolor{keywordflow}{if} (! \hyperlink{classlbann_1_1generic__data__store_a1a9cc7b097cd7dd6ae0d12d52bb43ea1}{m\_in\_memory}) \{
47     \hyperlink{base_8hpp_a80b1d707117e968a6951b7222e4b2b87}{LBANN\_ERROR}(\textcolor{stringliteral}{"not yet implemented"});
48   \} 
49   
50   \textcolor{keywordflow}{else} \{
51     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"calling get\_minibatch\_index\_vector\(\backslash\)n"};
52     \hyperlink{classlbann_1_1generic__data__store_ab861db5f81e45a6063b8922a331dd007}{get\_minibatch\_index\_vector}();
53 
54     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"calling exchange\_mb\_indices\(\backslash\)n"};
55     \hyperlink{classlbann_1_1generic__data__store_aa0ef8d7528f6775d47641ffe5ac229da}{exchange\_mb\_indices}();
56 
57     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"calling get\_my\_datastore\_indices\(\backslash\)n"};
58     \hyperlink{classlbann_1_1generic__data__store_a3558f87939755b08ae151623a5799127}{get\_my\_datastore\_indices}();
59 
60     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"calling get\_file\_sizes\(\backslash\)n"};
61     \textcolor{keywordtype}{double} tma = \hyperlink{namespacelbann_a478d36031ff0659893c4322cd856157f}{get\_time}();
62     \hyperlink{classlbann_1_1data__store__image_a8694bc9157c5fdc80bb5c251e68e18cb}{get\_file\_sizes}();
63     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"get\_file\_sizes time: "} << \hyperlink{namespacelbann_a478d36031ff0659893c4322cd856157f}{get\_time}() - tma << \textcolor{stringliteral}{"\(\backslash\)n"};
64 
65     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"calling allocate\_memory\(\backslash\)n"};
66     \hyperlink{classlbann_1_1data__store__image_af74877e493b5a822dd3d3793a95ceb9d}{allocate\_memory}();
67 
68     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"calling read\_files\(\backslash\)n"};
69     tma = \hyperlink{namespacelbann_a478d36031ff0659893c4322cd856157f}{get\_time}();
70     \hyperlink{classlbann_1_1data__store__image_a146874a68c24213f5509efb9727cb6e5}{read\_files}();
71     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"read\_files time: "} << \hyperlink{namespacelbann_a478d36031ff0659893c4322cd856157f}{get\_time}() - tma << \textcolor{stringliteral}{"\(\backslash\)n"};
72 
73     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"calling exchange\_data\(\backslash\)n"};
74     \hyperlink{classlbann_1_1data__store__image_a5ff5eccbd469caca692e8259f6f8c021}{exchange\_data}();
75 
76     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a5e64702aa4a38c8533fa52944a8473d5}{m\_extended\_testing}) \{
77       \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"calling extended\_testing\(\backslash\)n"};
78       \hyperlink{classlbann_1_1generic__data__store_ae569426f71f9317e88fe1078d58c98e7}{extended\_testing}();
79     \}
80   \}
81 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a79280b3aa9a207dfacad2bcc9824ec73_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__image_a79280b3aa9a207dfacad2bcc9824ec73_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classlbann_1_1data__store__image_a10e9aa0c240785bc0a961f24e87a1c16}\label{classlbann_1_1data__store__image_a10e9aa0c240785bc0a961f24e87a1c16}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!m\+\_\+data@{m\+\_\+data}}
\index{m\+\_\+data@{m\+\_\+data}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{m\+\_\+data}{m\_data}}
{\footnotesize\ttfamily std\+::vector$<$unsigned char$>$ lbann\+::data\+\_\+store\+\_\+image\+::m\+\_\+data\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 102 of file data\+\_\+store\+\_\+image.\+hpp.

\mbox{\Hypertarget{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}\label{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!m\+\_\+file\+\_\+sizes@{m\+\_\+file\+\_\+sizes}}
\index{m\+\_\+file\+\_\+sizes@{m\+\_\+file\+\_\+sizes}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{m\+\_\+file\+\_\+sizes}{m\_file\_sizes}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$size\+\_\+t, size\+\_\+t$>$ lbann\+::data\+\_\+store\+\_\+image\+::m\+\_\+file\+\_\+sizes\hspace{0.3cm}{\ttfamily [protected]}}



maps a global index (wrt image\+\_\+list) to number of bytes in the file 



Definition at line 76 of file data\+\_\+store\+\_\+image.\+hpp.

\mbox{\Hypertarget{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}\label{classlbann_1_1data__store__image_a627a08479de191dcef74e633c4cded8c}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!m\+\_\+my\+\_\+minibatch\+\_\+data@{m\+\_\+my\+\_\+minibatch\+\_\+data}}
\index{m\+\_\+my\+\_\+minibatch\+\_\+data@{m\+\_\+my\+\_\+minibatch\+\_\+data}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{m\+\_\+my\+\_\+minibatch\+\_\+data}{m\_my\_minibatch\_data}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$int, std\+::vector$<$unsigned char$>$ $>$ lbann\+::data\+\_\+store\+\_\+image\+::m\+\_\+my\+\_\+minibatch\+\_\+data\hspace{0.3cm}{\ttfamily [protected]}}



buffers that will be passed to reader\+::fetch\+\_\+datum 



Definition at line 91 of file data\+\_\+store\+\_\+image.\+hpp.

\mbox{\Hypertarget{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}\label{classlbann_1_1data__store__image_a2f660053e7621a9cc70a7c4eef53c9cc}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!m\+\_\+num\+\_\+img\+\_\+srcs@{m\+\_\+num\+\_\+img\+\_\+srcs}}
\index{m\+\_\+num\+\_\+img\+\_\+srcs@{m\+\_\+num\+\_\+img\+\_\+srcs}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{m\+\_\+num\+\_\+img\+\_\+srcs}{m\_num\_img\_srcs}}
{\footnotesize\ttfamily unsigned int lbann\+::data\+\_\+store\+\_\+image\+::m\+\_\+num\+\_\+img\+\_\+srcs\hspace{0.3cm}{\ttfamily [protected]}}



in multi-\/image scenarios, the number of images in each sample 



Definition at line 100 of file data\+\_\+store\+\_\+image.\+hpp.

\mbox{\Hypertarget{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}\label{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}} 
\index{lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}!m\+\_\+offsets@{m\+\_\+offsets}}
\index{m\+\_\+offsets@{m\+\_\+offsets}!lbann\+::data\+\_\+store\+\_\+image@{lbann\+::data\+\_\+store\+\_\+image}}
\subsubsection{\texorpdfstring{m\+\_\+offsets}{m\_offsets}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$size\+\_\+t, size\+\_\+t$>$ lbann\+::data\+\_\+store\+\_\+image\+::m\+\_\+offsets\hspace{0.3cm}{\ttfamily [protected]}}

maps a global index (wrt image\+\_\+list) to the file\textquotesingle{}s data location wrt m\+\_\+data 

Definition at line 80 of file data\+\_\+store\+\_\+image.\+hpp.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/data\+\_\+store/\hyperlink{data__store__image_8hpp}{data\+\_\+store\+\_\+image.\+hpp}\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/src/data\+\_\+store/\hyperlink{data__store__image_8cpp}{data\+\_\+store\+\_\+image.\+cpp}\end{DoxyCompactItemize}
