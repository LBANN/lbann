\hypertarget{classlbann_1_1concatenation__layer}{}\section{lbann\+:\+:concatenation\+\_\+layer$<$ T\+\_\+layout $>$ Class Template Reference}
\label{classlbann_1_1concatenation__layer}\index{lbann\+::concatenation\+\_\+layer$<$ T\+\_\+layout $>$@{lbann\+::concatenation\+\_\+layer$<$ T\+\_\+layout $>$}}


{\ttfamily \#include $<$concatenation.\+hpp$>$}



Inheritance diagram for lbann\+:\+:concatenation\+\_\+layer$<$ T\+\_\+layout $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=195pt]{classlbann_1_1concatenation__layer__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for lbann\+:\+:concatenation\+\_\+layer$<$ T\+\_\+layout $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1concatenation__layer_ab826328d5224933dfc90e246d16de50e}{concatenation\+\_\+layer} (\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm}, int concatenation\+\_\+axis, \hyperlink{classlbann_1_1cudnn_1_1cudnn__manager}{cudnn\+::cudnn\+\_\+manager} $\ast$cudnn=nullptr)
\item 
\hyperlink{classlbann_1_1concatenation__layer_a0498925fcb0a42f1bc8fd1913b9090fc}{concatenation\+\_\+layer} (const \hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer} \&other)
\item 
\hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer} \& \hyperlink{classlbann_1_1concatenation__layer_af91f0850e13dd854e095f2c9d00d58b2}{operator=} (const \hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer} \&other)
\item 
virtual \hyperlink{classlbann_1_1concatenation__layer_a5c2b47a4e494ba1fe20f4ec956f981e1}{$\sim$concatenation\+\_\+layer} () override
\item 
\hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer} $\ast$ \hyperlink{classlbann_1_1concatenation__layer_a8cdb0b6f5dee578477a3125f5da74573}{copy} () const override
\item 
std\+::string \hyperlink{classlbann_1_1concatenation__layer_a5c6edd4ca11a102b809987851f51e2d4}{get\+\_\+type} () const override
\item 
\hyperlink{base_8hpp_a786677cbfb3f5677b4d84f3056eb08db}{data\+\_\+layout} \hyperlink{classlbann_1_1concatenation__layer_afa17d94708fe6d35db2925f664104d42}{get\+\_\+data\+\_\+layout} () const override
\item 
std\+::string \hyperlink{classlbann_1_1concatenation__layer_a2154ad33b4bacbb5caed95fdebc735ca}{get\+\_\+description} () const override
\item 
void \hyperlink{classlbann_1_1concatenation__layer_a20c1588e7a506bc7b0acb4d63586ece9}{setup\+\_\+pointers} () override
\item 
void \hyperlink{classlbann_1_1concatenation__layer_a9c305ea0cbee1b7b6fe822f514c48d42}{setup\+\_\+matrices} (const \hyperlink{base_8hpp_a9951bb1719d534e0401b1f06cad19eab}{El\+::\+Grid} \&grid) override
\item 
void \hyperlink{classlbann_1_1concatenation__layer_abc44199934950480dbde30e0b7058a78}{setup\+\_\+dims} () override
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classlbann_1_1concatenation__layer_a27938ca2422fd120cfbdf823705af01a}{fp\+\_\+compute} () override
\item 
void \hyperlink{classlbann_1_1concatenation__layer_abd2a2a3aa260646c98d842993fee6247}{bp\+\_\+compute} () override
\item 
void \hyperlink{classlbann_1_1concatenation__layer_a53b3f53828d4982452dd6e79b8ebce50}{fp\+\_\+compute\+\_\+cpu} ()
\item 
void \hyperlink{classlbann_1_1concatenation__layer_a530ff478d02f3d69baf8432473979d00}{bp\+\_\+compute\+\_\+cpu} ()
\item 
void \hyperlink{classlbann_1_1concatenation__layer_afd6cb5cf50acf95c2e3ba2e365be3525}{fp\+\_\+compute\+\_\+gpu} ()
\item 
void \hyperlink{classlbann_1_1concatenation__layer_aa024e4ba8d10aec75c89075e6e0cc28d}{bp\+\_\+compute\+\_\+gpu} ()
\item 
std\+::vector$<$ int $>$ \hyperlink{classlbann_1_1concatenation__layer_af0e60f4a7e00657ceb429aaa8d7f5040}{get\+\_\+prev\+\_\+neuron\+\_\+dims} (int parent\+\_\+index=0) const override
\item 
int \hyperlink{classlbann_1_1concatenation__layer_aca8e6d21d827a3d5a8434db88bf3e63a}{get\+\_\+num\+\_\+prev\+\_\+neurons} (int parent\+\_\+index=0) const override
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\+\_\+concatenation\+\_\+axis}
\item 
std\+::vector$<$ int $>$ \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\+\_\+concatenation\+\_\+points}
\item 
\hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} $\ast$ \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\+\_\+input\+\_\+region\+\_\+v}
\item 
\hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} $\ast$ \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\+\_\+output\+\_\+region\+\_\+v}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\subsubsection*{template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$\newline
class lbann\+::concatenation\+\_\+layer$<$ T\+\_\+layout $>$}

Concatenation layer. This layer concatenates input tensors along a specified axis. 

Definition at line 40 of file concatenation.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_ab826328d5224933dfc90e246d16de50e}\label{classlbann_1_1concatenation__layer_ab826328d5224933dfc90e246d16de50e}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!concatenation\+\_\+layer@{concatenation\+\_\+layer}}
\index{concatenation\+\_\+layer@{concatenation\+\_\+layer}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{concatenation\+\_\+layer()}{concatenation\_layer()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
\hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::\hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer} (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$}]{comm,  }\item[{int}]{concatenation\+\_\+axis,  }\item[{\hyperlink{classlbann_1_1cudnn_1_1cudnn__manager}{cudnn\+::cudnn\+\_\+manager} $\ast$}]{cudnn = {\ttfamily nullptr} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 55 of file concatenation.\+hpp.


\begin{DoxyCode}
58     : \hyperlink{classlbann_1_1transform__layer_a4b72501e0f4d0745c8b13c5331055e65}{transform\_layer}(\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm}),
59       \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}(concatenation\_axis),
60       \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v}(\textcolor{keyword}{nullptr}),
61       \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v}(\textcolor{keyword}{nullptr}) \{
62 
63     \textcolor{comment}{// Concatenation layer has no limit on parents}
64     \hyperlink{classlbann_1_1Layer_a841b96b25555247f52921c7f13ae1dfa}{m\_expected\_num\_parent\_layers} = -1;
65 
66 \textcolor{preprocessor}{  #ifdef LBANN\_HAS\_CUDNN}
67     \textcolor{comment}{// Initialize GPU if available}
68     \textcolor{keywordflow}{if}(cudnn) \{
69       this->\hyperlink{classlbann_1_1Layer_af7881cb5eff5207c15fa835d65462e8f}{m\_using\_gpus} = \textcolor{keyword}{true};
70       this->\hyperlink{classlbann_1_1Layer_a08dbb94239e3b8c96329786c57c72e21}{m\_cudnn} = cudnn;
71     \}
72 \textcolor{preprocessor}{  #endif // LBANN\_HAS\_CUDNN}
73 
74   \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_ab826328d5224933dfc90e246d16de50e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a0498925fcb0a42f1bc8fd1913b9090fc}\label{classlbann_1_1concatenation__layer_a0498925fcb0a42f1bc8fd1913b9090fc}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!concatenation\+\_\+layer@{concatenation\+\_\+layer}}
\index{concatenation\+\_\+layer@{concatenation\+\_\+layer}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{concatenation\+\_\+layer()}{concatenation\_layer()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
\hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::\hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer} (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer}$<$ T\+\_\+layout $>$ \&}]{other }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 76 of file concatenation.\+hpp.


\begin{DoxyCode}
77     : \hyperlink{classlbann_1_1transform__layer_a4b72501e0f4d0745c8b13c5331055e65}{transform\_layer}(other),
78       \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}(other.m\_concatenation\_axis),
79       \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}(other.m\_concatenation\_points),
80       \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v}(other.m\_input\_region\_v),
81       \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v}(other.m\_output\_region\_v) \{
82     \textcolor{comment}{// Deep copy matrices}
83     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} != \textcolor{keyword}{nullptr}) \{
84       \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} = \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v}->Copy();
85     \}
86     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} != \textcolor{keyword}{nullptr}) \{
87       \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} = \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v}->Copy();
88     \}
89   \}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a5c2b47a4e494ba1fe20f4ec956f981e1}\label{classlbann_1_1concatenation__layer_a5c2b47a4e494ba1fe20f4ec956f981e1}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!````~concatenation\+\_\+layer@{$\sim$concatenation\+\_\+layer}}
\index{````~concatenation\+\_\+layer@{$\sim$concatenation\+\_\+layer}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{$\sim$concatenation\+\_\+layer()}{~concatenation\_layer()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
virtual \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::$\sim$\hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Definition at line 110 of file concatenation.\+hpp.


\begin{DoxyCode}
110                                           \{
111     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} != \textcolor{keyword}{nullptr})  \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v}; \}
112     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} != \textcolor{keyword}{nullptr}) \{ \textcolor{keyword}{delete} 
      \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v}; \}
113   \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_abd2a2a3aa260646c98d842993fee6247}\label{classlbann_1_1concatenation__layer_abd2a2a3aa260646c98d842993fee6247}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!bp\+\_\+compute@{bp\+\_\+compute}}
\index{bp\+\_\+compute@{bp\+\_\+compute}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{bp\+\_\+compute()}{bp\_compute()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::bp\+\_\+compute (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Perform the computation for the backward propagation step. 

Implements \hyperlink{classlbann_1_1Layer_a7442e01f9ee1294df2de811efcf5171e}{lbann\+::\+Layer}.



Definition at line 218 of file concatenation.\+hpp.


\begin{DoxyCode}
218                              \{
219     \textcolor{keywordflow}{if}(this->\hyperlink{classlbann_1_1Layer_af7881cb5eff5207c15fa835d65462e8f}{m\_using\_gpus}) \{
220       \hyperlink{classlbann_1_1concatenation__layer_aa024e4ba8d10aec75c89075e6e0cc28d}{bp\_compute\_gpu}();
221     \} \textcolor{keywordflow}{else} \{
222       \hyperlink{classlbann_1_1concatenation__layer_a530ff478d02f3d69baf8432473979d00}{bp\_compute\_cpu}();
223     \}
224   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_abd2a2a3aa260646c98d842993fee6247_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a530ff478d02f3d69baf8432473979d00}\label{classlbann_1_1concatenation__layer_a530ff478d02f3d69baf8432473979d00}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!bp\+\_\+compute\+\_\+cpu@{bp\+\_\+compute\+\_\+cpu}}
\index{bp\+\_\+compute\+\_\+cpu@{bp\+\_\+compute\+\_\+cpu}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{bp\+\_\+compute\+\_\+cpu()}{bp\_compute\_cpu()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::bp\+\_\+compute\+\_\+cpu (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Definition at line 277 of file concatenation.\+hpp.


\begin{DoxyCode}
277                         \{
278 
279     \textcolor{comment}{// Gradient w.r.t. output}
280     \textcolor{keyword}{const} \textcolor{keyword}{auto}& gradient\_wrt\_output = \hyperlink{classlbann_1_1Layer_a7ac4579d3c1671dfaf86e3b618d6938a}{get\_prev\_error\_signals}();
281 
282     \textcolor{comment}{// Get number of contiguous regions in a tensor slice of width 1}
283     \textcolor{keyword}{const} \textcolor{keyword}{auto}& output\_dims = this->\hyperlink{classlbann_1_1Layer_abb34bb8031f57a483e2e327a5f229f48}{m\_neuron\_dims};
284     \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_regions = std::accumulate(output\_dims.begin(),
285                                             output\_dims.begin() + 
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis},
286                                             1,
287                                             std::multiplies<int>());
288     \textcolor{keyword}{const} \textcolor{keywordtype}{int} unit\_region\_size = std::accumulate(output\_dims.begin() + 
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis} + 1,
289                                                  output\_dims.end(),
290                                                  1,
291                                                  std::multiplies<int>());
292 
293     \textcolor{comment}{// Get stride between contiguous regions in input tensor slice}
294     \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_slice\_dim = output\_dims[\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}];
295     \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_stride = output\_slice\_dim * unit\_region\_size;
296     
297     \textcolor{comment}{// Populate output tensors with concatenations of input tensor}
298     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classlbann_1_1Layer_ac9290d4a6453ccda5f6b4d8b57b49ba3}{get\_num\_parents}(); ++i) \{
299       \textcolor{keyword}{auto}& gradient\_wrt\_input = \hyperlink{classlbann_1_1Layer_adb561e140e0bb601f3c5a8ee053a71d2}{get\_error\_signals}(i);
300 
301       \textcolor{comment}{// Get stride between contiguous regions in output tensor concatenations}
302       \textcolor{keyword}{const} \textcolor{keywordtype}{int} input\_slice\_dim = \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[i+1] - 
      \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[i];
303       \textcolor{keyword}{const} \textcolor{keywordtype}{int} input\_region\_stride = input\_slice\_dim * unit\_region\_size;
304 
305       \textcolor{comment}{// Get position of first contiguous region in output tensor}
306       \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_start = m\_concatenation\_points[i] * unit\_region\_size;
307       \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_end = m\_concatenation\_points[i+1] * unit\_region\_size;
308 
309       \textcolor{comment}{// Populate current output tensor}
310       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} region = 0; region < num\_regions; ++region) \{
311         El::LockedView(*\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v},
312                        gradient\_wrt\_output,
313                        El::IR(output\_region\_start + region * output\_region\_stride,
314                               output\_region\_end + region * output\_region\_stride),
315                        El::ALL);
316         El::View(*\hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v},
317                  gradient\_wrt\_input,
318                  El::IR(region * input\_region\_stride,
319                         (region+1) * input\_region\_stride),
320                  El::ALL);
321         El::Axpy(DataType(1), *\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v}, *
      \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v});
322       \}
323     \}
324 
325   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_a530ff478d02f3d69baf8432473979d00_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_a530ff478d02f3d69baf8432473979d00_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_aa024e4ba8d10aec75c89075e6e0cc28d}\label{classlbann_1_1concatenation__layer_aa024e4ba8d10aec75c89075e6e0cc28d}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!bp\+\_\+compute\+\_\+gpu@{bp\+\_\+compute\+\_\+gpu}}
\index{bp\+\_\+compute\+\_\+gpu@{bp\+\_\+compute\+\_\+gpu}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{bp\+\_\+compute\+\_\+gpu()}{bp\_compute\_gpu()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::bp\+\_\+compute\+\_\+gpu (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Definition at line 390 of file concatenation.\+hpp.


\begin{DoxyCode}
390                         \{
391 \textcolor{preprocessor}{  #ifndef LBANN\_HAS\_CUDNN}
392     std::stringstream err;
393     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: concatenation\_layer: cuDNN not detected"};
394     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
395 \textcolor{preprocessor}{  #else}
396 
397     \textcolor{comment}{// Gradient w.r.t. output}
398     \textcolor{keyword}{const} \textcolor{keyword}{auto}& gradient\_wrt\_output\_d = m\_prev\_error\_signals\_d[0];
399 
400     \textcolor{comment}{// Get number of contiguous regions in a tensor slice of width 1}
401     \textcolor{keyword}{const} \textcolor{keyword}{auto}& output\_dims = this->\hyperlink{classlbann_1_1Layer_abb34bb8031f57a483e2e327a5f229f48}{m\_neuron\_dims};
402     \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_regions = std::accumulate(output\_dims.begin(),
403                                             output\_dims.begin() + 
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis},
404                                             1,
405                                             std::multiplies<int>());
406     \textcolor{keyword}{const} \textcolor{keywordtype}{int} unit\_region\_size = std::accumulate(output\_dims.begin() + 
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis} + 1,
407                                                  output\_dims.end(),
408                                                  1,
409                                                  std::multiplies<int>());
410 
411     \textcolor{comment}{// Get stride between contiguous regions in input tensor slice}
412     \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_slice\_dim = output\_dims[\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}];
413     \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_stride = output\_slice\_dim * unit\_region\_size;
414     
415     \textcolor{comment}{// Populate output tensors with concatenations of input tensor}
416     cudnn::matrix gradient\_wrt\_input\_region\_d(\hyperlink{classlbann_1_1Layer_a08dbb94239e3b8c96329786c57c72e21}{m\_cudnn});
417     cudnn::matrix gradient\_wrt\_output\_region\_d(\hyperlink{classlbann_1_1Layer_a08dbb94239e3b8c96329786c57c72e21}{m\_cudnn});
418     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classlbann_1_1Layer_ac9290d4a6453ccda5f6b4d8b57b49ba3}{get\_num\_parents}(); ++i) \{
419       \textcolor{keyword}{auto}& gradient\_wrt\_input\_d = m\_error\_signals\_d[i];
420 
421       \textcolor{comment}{// Get stride between contiguous regions in output tensor concatenations}
422       \textcolor{keyword}{const} \textcolor{keywordtype}{int} input\_slice\_dim = \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[i+1] - 
      \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[i];
423       \textcolor{keyword}{const} \textcolor{keywordtype}{int} input\_region\_stride = input\_slice\_dim * unit\_region\_size;
424 
425       \textcolor{comment}{// Get position of first contiguous region in output tensor}
426       \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_start = m\_concatenation\_points[i] * unit\_region\_size;
427 
428       \textcolor{comment}{// Populate current output tensor}
429       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} region = 0; region < num\_regions; ++region) \{
430         \textcolor{keyword}{auto} gradient\_wrt\_input\_ptrs = gradient\_wrt\_input\_d.get\_data();
431         \textcolor{keyword}{auto} gradient\_wrt\_output\_ptrs = gradient\_wrt\_output\_d.get\_locked\_data();
432         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& ptr : gradient\_wrt\_input\_ptrs) \{
433           ptr += region * input\_region\_stride;
434         \}
435         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& ptr : gradient\_wrt\_output\_ptrs) \{
436           ptr += output\_region\_start + region * output\_region\_stride;
437         \}
438         gradient\_wrt\_input\_region\_d.attach(gradient\_wrt\_input\_ptrs,
439                                            input\_region\_stride,
440                                            this->m\_mini\_batch\_size\_per\_gpu,
441                                            gradient\_wrt\_input\_d.get\_leading\_dim());
442         gradient\_wrt\_output\_region\_d.locked\_attach(gradient\_wrt\_output\_ptrs,
443                                                    input\_region\_stride,
444                                                    this->m\_mini\_batch\_size\_per\_gpu,
445                                                    gradient\_wrt\_output\_d.get\_leading\_dim());
446         \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_gpus = \hyperlink{classlbann_1_1Layer_a08dbb94239e3b8c96329786c57c72e21}{m\_cudnn}->get\_num\_gpus();
447         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} gpu = 0; gpu < num\_gpus; ++gpu) \{
448           CHECK\_CUDA(cudaSetDevice(this->\hyperlink{classlbann_1_1Layer_a08dbb94239e3b8c96329786c57c72e21}{m\_cudnn}->get\_gpu(gpu)));
449           cublas::geam(this->\hyperlink{classlbann_1_1Layer_a08dbb94239e3b8c96329786c57c72e21}{m\_cudnn}->get\_cublas\_handle(gpu),
450                        CUBLAS\_OP\_N, CUBLAS\_OP\_N,
451                        gradient\_wrt\_input\_region\_d.get\_height(),
452                        this->m\_mini\_batch\_size\_per\_gpu,
453                        DataType(1),
454                        gradient\_wrt\_output\_region\_d.get\_locked\_data(gpu),
455                        gradient\_wrt\_output\_region\_d.get\_leading\_dim(),
456                        DataType(1),
457                        gradient\_wrt\_input\_region\_d.get\_locked\_data(gpu),
458                        gradient\_wrt\_input\_region\_d.get\_leading\_dim(),
459                        gradient\_wrt\_input\_region\_d.get\_data(gpu),
460                        gradient\_wrt\_input\_region\_d.get\_leading\_dim());
461         \}
462       \}
463 
464     \}
465 
466 \textcolor{preprocessor}{  #endif // LBANN\_HAS\_CUDNN}
467   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_aa024e4ba8d10aec75c89075e6e0cc28d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_aa024e4ba8d10aec75c89075e6e0cc28d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a8cdb0b6f5dee578477a3125f5da74573}\label{classlbann_1_1concatenation__layer_a8cdb0b6f5dee578477a3125f5da74573}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!copy@{copy}}
\index{copy@{copy}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
\hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer}$\ast$ \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Copy function. This function dynamically allocates memory for a layer instance and instantiates a copy. The caller is responsible for deallocating the instance. 

Implements \hyperlink{classlbann_1_1Layer_af420f22bbac801c85483ade84588a23f}{lbann\+::\+Layer}.



Definition at line 115 of file concatenation.\+hpp.


\begin{DoxyCode}
115 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{new} \hyperlink{classlbann_1_1concatenation__layer_ab826328d5224933dfc90e246d16de50e}{concatenation\_layer}(*\textcolor{keyword}{this}); \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_a8cdb0b6f5dee578477a3125f5da74573_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a27938ca2422fd120cfbdf823705af01a}\label{classlbann_1_1concatenation__layer_a27938ca2422fd120cfbdf823705af01a}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!fp\+\_\+compute@{fp\+\_\+compute}}
\index{fp\+\_\+compute@{fp\+\_\+compute}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{fp\+\_\+compute()}{fp\_compute()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::fp\+\_\+compute (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Perform the computation for the forward propagation step. 

Implements \hyperlink{classlbann_1_1Layer_a523319dd1bd87a0612afa1912bb5aad7}{lbann\+::\+Layer}.



Definition at line 210 of file concatenation.\+hpp.


\begin{DoxyCode}
210                              \{
211     \textcolor{keywordflow}{if}(this->\hyperlink{classlbann_1_1Layer_af7881cb5eff5207c15fa835d65462e8f}{m\_using\_gpus}) \{
212       \hyperlink{classlbann_1_1concatenation__layer_afd6cb5cf50acf95c2e3ba2e365be3525}{fp\_compute\_gpu}();
213     \} \textcolor{keywordflow}{else} \{
214       \hyperlink{classlbann_1_1concatenation__layer_a53b3f53828d4982452dd6e79b8ebce50}{fp\_compute\_cpu}();
215     \}
216   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_a27938ca2422fd120cfbdf823705af01a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a53b3f53828d4982452dd6e79b8ebce50}\label{classlbann_1_1concatenation__layer_a53b3f53828d4982452dd6e79b8ebce50}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!fp\+\_\+compute\+\_\+cpu@{fp\+\_\+compute\+\_\+cpu}}
\index{fp\+\_\+compute\+\_\+cpu@{fp\+\_\+compute\+\_\+cpu}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{fp\+\_\+compute\+\_\+cpu()}{fp\_compute\_cpu()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::fp\+\_\+compute\+\_\+cpu (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Definition at line 226 of file concatenation.\+hpp.


\begin{DoxyCode}
226                         \{
227 
228     \textcolor{comment}{// Gradient w.r.t. input}
229     \textcolor{keyword}{auto}& output = \hyperlink{classlbann_1_1Layer_a1134b1a4385af199d7272c5aa827fa99}{get\_activations}();
230 
231     \textcolor{comment}{// Get number of contiguous regions in a tensor slice of width 1}
232     \textcolor{keyword}{const} \textcolor{keyword}{auto}& output\_dims = this->\hyperlink{classlbann_1_1Layer_abb34bb8031f57a483e2e327a5f229f48}{m\_neuron\_dims};
233     \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_regions = std::accumulate(output\_dims.begin(),
234                                             output\_dims.begin() + 
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis},
235                                             1,
236                                             std::multiplies<int>());
237     \textcolor{keyword}{const} \textcolor{keywordtype}{int} unit\_region\_size = std::accumulate(output\_dims.begin() + 
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis} + 1,
238                                                  output\_dims.end(),
239                                                  1,
240                                                  std::multiplies<int>());
241 
242     \textcolor{comment}{// Get stride between contiguous regions in output tensor slices}
243     \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_slice\_dim = output\_dims[\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}];
244     \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_stride = output\_slice\_dim * unit\_region\_size;
245     
246     \textcolor{comment}{// Populate output with slices of inputs}
247     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classlbann_1_1Layer_ac9290d4a6453ccda5f6b4d8b57b49ba3}{get\_num\_parents}(); ++i) \{
248       \textcolor{keyword}{const} \textcolor{keyword}{auto}& input = \hyperlink{classlbann_1_1Layer_a45853df73a2e72bfaa774665a0f37ed7}{get\_prev\_activations}(i);
249 
250       \textcolor{comment}{// Get stride between contiguous regions in input tensor slices}
251       \textcolor{keyword}{const} \textcolor{keywordtype}{int} input\_slice\_dim = \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[i+1] - 
      \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[i];
252       \textcolor{keyword}{const} \textcolor{keywordtype}{int} input\_region\_stride = input\_slice\_dim * unit\_region\_size;
253 
254       \textcolor{comment}{// Get position of first contiguous region in output tensor}
255       \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_start = m\_concatenation\_points[i] * unit\_region\_size;
256       \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_end = m\_concatenation\_points[i+1] * unit\_region\_size;
257 
258       \textcolor{comment}{// Populate concatenation of gradient w.r.t. input}
259       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} region = 0; region < num\_regions; ++region) \{
260         El::LockedView(*\hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v},
261                        input,
262                        El::IR(region * input\_region\_stride,
263                               (region+1) * input\_region\_stride),
264                        El::ALL);
265         El::View(*\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v},
266                  output,
267                  El::IR(output\_region\_start + region * output\_region\_stride,
268                         output\_region\_end + region * output\_region\_stride),
269                  El::ALL);
270         El::Copy(*\hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v}, *\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v});
271       \}
272 
273     \}
274 
275   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_a53b3f53828d4982452dd6e79b8ebce50_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=347pt]{classlbann_1_1concatenation__layer_a53b3f53828d4982452dd6e79b8ebce50_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_afd6cb5cf50acf95c2e3ba2e365be3525}\label{classlbann_1_1concatenation__layer_afd6cb5cf50acf95c2e3ba2e365be3525}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!fp\+\_\+compute\+\_\+gpu@{fp\+\_\+compute\+\_\+gpu}}
\index{fp\+\_\+compute\+\_\+gpu@{fp\+\_\+compute\+\_\+gpu}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{fp\+\_\+compute\+\_\+gpu()}{fp\_compute\_gpu()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::fp\+\_\+compute\+\_\+gpu (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Definition at line 327 of file concatenation.\+hpp.


\begin{DoxyCode}
327                         \{
328 \textcolor{preprocessor}{  #ifndef LBANN\_HAS\_CUDNN}
329     std::stringstream err;
330     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: concatenation\_layer: cuDNN not detected"};
331     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
332 \textcolor{preprocessor}{  #else}
333 
334     \textcolor{comment}{// Gradient w.r.t. input}
335     \textcolor{keyword}{auto}& output\_d = m\_activations\_d[0];
336 
337     \textcolor{comment}{// Get number of contiguous regions in a tensor slice of width 1}
338     \textcolor{keyword}{const} \textcolor{keyword}{auto}& output\_dims = this->\hyperlink{classlbann_1_1Layer_abb34bb8031f57a483e2e327a5f229f48}{m\_neuron\_dims};
339     \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_regions = std::accumulate(output\_dims.begin(),
340                                             output\_dims.begin() + 
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis},
341                                             1,
342                                             std::multiplies<int>());
343     \textcolor{keyword}{const} \textcolor{keywordtype}{int} unit\_region\_size = std::accumulate(output\_dims.begin() + 
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis} + 1,
344                                                  output\_dims.end(),
345                                                  1,
346                                                  std::multiplies<int>());
347 
348     \textcolor{comment}{// Get stride between contiguous regions in output tensor slices}
349     \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_slice\_dim = output\_dims[\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}];
350     \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_stride = output\_slice\_dim * unit\_region\_size;
351     
352     \textcolor{comment}{// Populate output with slices of inputs}
353     cudnn::matrix input\_region\_d(\hyperlink{classlbann_1_1Layer_a08dbb94239e3b8c96329786c57c72e21}{m\_cudnn}), output\_region\_d(\hyperlink{classlbann_1_1Layer_a08dbb94239e3b8c96329786c57c72e21}{m\_cudnn});
354     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classlbann_1_1Layer_ac9290d4a6453ccda5f6b4d8b57b49ba3}{get\_num\_parents}(); ++i) \{
355       \textcolor{keyword}{const} \textcolor{keyword}{auto}& input\_d = m\_prev\_activations\_d[i];
356 
357       \textcolor{comment}{// Get stride between contiguous regions in input tensor slices}
358       \textcolor{keyword}{const} \textcolor{keywordtype}{int} input\_slice\_dim = \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[i+1] - 
      \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[i];
359       \textcolor{keyword}{const} \textcolor{keywordtype}{int} input\_region\_stride = input\_slice\_dim * unit\_region\_size;
360 
361       \textcolor{comment}{// Get position of first contiguous region in output tensor}
362       \textcolor{keyword}{const} \textcolor{keywordtype}{int} output\_region\_start = m\_concatenation\_points[i] * unit\_region\_size;
363 
364       \textcolor{comment}{// Populate slice of output}
365       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} region = 0; region < num\_regions; ++region) \{
366         \textcolor{keyword}{auto} input\_ptrs = input\_d.get\_locked\_data();
367         \textcolor{keyword}{auto} output\_ptrs = output\_d.get\_data();
368         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& ptr : input\_ptrs) \{
369           ptr += region * input\_region\_stride;
370         \}
371         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& ptr : output\_ptrs) \{
372           ptr += output\_region\_start + region * output\_region\_stride;
373         \}
374         input\_region\_d.locked\_attach(input\_ptrs,
375                                      input\_region\_stride,
376                                      this->m\_mini\_batch\_size\_per\_gpu,
377                                      input\_d.get\_leading\_dim());
378         output\_region\_d.attach(output\_ptrs,
379                                input\_region\_stride,
380                                this->m\_mini\_batch\_size\_per\_gpu,
381                                output\_d.get\_leading\_dim());
382         output\_region\_d.copy(input\_region\_d);
383       \}
384 
385     \}
386 
387 \textcolor{preprocessor}{  #endif // LBANN\_HAS\_CUDNN}
388   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_afd6cb5cf50acf95c2e3ba2e365be3525_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=348pt]{classlbann_1_1concatenation__layer_afd6cb5cf50acf95c2e3ba2e365be3525_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_afa17d94708fe6d35db2925f664104d42}\label{classlbann_1_1concatenation__layer_afa17d94708fe6d35db2925f664104d42}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!get\+\_\+data\+\_\+layout@{get\+\_\+data\+\_\+layout}}
\index{get\+\_\+data\+\_\+layout@{get\+\_\+data\+\_\+layout}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{get\+\_\+data\+\_\+layout()}{get\_data\_layout()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
\hyperlink{base_8hpp_a786677cbfb3f5677b4d84f3056eb08db}{data\+\_\+layout} \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::get\+\_\+data\+\_\+layout (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Get data layout of the data tensors. We assume that the data layouts of the previous activations, activations, previous error signals, and error signals are the same. Each concrete layer that is templated on its data layout should override this function to return its template parameter. 

Implements \hyperlink{classlbann_1_1Layer_a5dfb66e81fc085997402a5e2241316bd}{lbann\+::\+Layer}.



Definition at line 117 of file concatenation.\+hpp.


\begin{DoxyCode}
117 \{ \textcolor{keywordflow}{return} T\_layout; \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_afa17d94708fe6d35db2925f664104d42_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a2154ad33b4bacbb5caed95fdebc735ca}\label{classlbann_1_1concatenation__layer_a2154ad33b4bacbb5caed95fdebc735ca}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!get\+\_\+description@{get\+\_\+description}}
\index{get\+\_\+description@{get\+\_\+description}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{get\+\_\+description()}{get\_description()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
std\+::string \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::get\+\_\+description (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Returns description of ctor params 

Reimplemented from \hyperlink{classlbann_1_1Layer_acc0803d3428914ca1eb5988c4309174a}{lbann\+::\+Layer}.



Definition at line 120 of file concatenation.\+hpp.


\begin{DoxyCode}
120                                              \{
121     std::stringstream s;
122     s << \textcolor{stringliteral}{" concatenation; concatenation\_axis: "}
123       << \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis} << \textcolor{stringliteral}{" parents: "};
124     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} h=0; h<this->\hyperlink{classlbann_1_1Layer_a3fa7c6cf1a22bb14ab0e85e3dc6027c5}{m\_parent\_layers}.size(); h++) \{
125       s << this->\hyperlink{classlbann_1_1Layer_a3fa7c6cf1a22bb14ab0e85e3dc6027c5}{m\_parent\_layers}[h]->get\_name() << \textcolor{stringliteral}{" "} << this->
      \hyperlink{classlbann_1_1Layer_a3fa7c6cf1a22bb14ab0e85e3dc6027c5}{m\_parent\_layers}[h]->get\_type() << \textcolor{stringliteral}{" "};
126     \}
127     s << \textcolor{stringliteral}{" concatenation\_points: "};
128     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} h=0; h<this->\hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}.size(); h++) \{
129       s << this->\hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[h] << \textcolor{stringliteral}{" "};
130     \}
131     s << \textcolor{stringliteral}{" dataLayout: "} << this->\hyperlink{classlbann_1_1Layer_ae3f4a5602df821f4221614b1e3782dc1}{get\_data\_layout\_string}(
      \hyperlink{classlbann_1_1concatenation__layer_afa17d94708fe6d35db2925f664104d42}{get\_data\_layout}());
132     \textcolor{keywordflow}{return} s.str();
133   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_a2154ad33b4bacbb5caed95fdebc735ca_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_aca8e6d21d827a3d5a8434db88bf3e63a}\label{classlbann_1_1concatenation__layer_aca8e6d21d827a3d5a8434db88bf3e63a}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!get\+\_\+num\+\_\+prev\+\_\+neurons@{get\+\_\+num\+\_\+prev\+\_\+neurons}}
\index{get\+\_\+num\+\_\+prev\+\_\+neurons@{get\+\_\+num\+\_\+prev\+\_\+neurons}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{get\+\_\+num\+\_\+prev\+\_\+neurons()}{get\_num\_prev\_neurons()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
int \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::get\+\_\+num\+\_\+prev\+\_\+neurons (\begin{DoxyParamCaption}\item[{int}]{parent\+\_\+index = {\ttfamily 0} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Get the size of a previous activations tensor. 

Reimplemented from \hyperlink{classlbann_1_1Layer_a27112eb70bbfbd7f3c3e749960400dec}{lbann\+::\+Layer}.



Definition at line 476 of file concatenation.\+hpp.


\begin{DoxyCode}
476                                                                 \{
477     \textcolor{keyword}{const} \textcolor{keyword}{auto}& prev\_neuron\_dims = \hyperlink{classlbann_1_1concatenation__layer_af0e60f4a7e00657ceb429aaa8d7f5040}{get\_prev\_neuron\_dims}(parent\_index);
478     \textcolor{keywordflow}{return} std::accumulate(prev\_neuron\_dims.begin(),
479                            prev\_neuron\_dims.end(),
480                            1,
481                            std::multiplies<int>());
482   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_aca8e6d21d827a3d5a8434db88bf3e63a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_af0e60f4a7e00657ceb429aaa8d7f5040}\label{classlbann_1_1concatenation__layer_af0e60f4a7e00657ceb429aaa8d7f5040}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!get\+\_\+prev\+\_\+neuron\+\_\+dims@{get\+\_\+prev\+\_\+neuron\+\_\+dims}}
\index{get\+\_\+prev\+\_\+neuron\+\_\+dims@{get\+\_\+prev\+\_\+neuron\+\_\+dims}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{get\+\_\+prev\+\_\+neuron\+\_\+dims()}{get\_prev\_neuron\_dims()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
std\+::vector$<$int$>$ \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::get\+\_\+prev\+\_\+neuron\+\_\+dims (\begin{DoxyParamCaption}\item[{int}]{parent\+\_\+index = {\ttfamily 0} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Get the dimensions of a previous activations tensor. 

Reimplemented from \hyperlink{classlbann_1_1Layer_a1acc0fa44acdeffbac158fdac3467973}{lbann\+::\+Layer}.



Definition at line 469 of file concatenation.\+hpp.


\begin{DoxyCode}
469                                                                            \{
470     std::vector<int> prev\_neuron\_dims = \hyperlink{classlbann_1_1Layer_ae204d1a2a79606eaa117273857ff62a3}{m\_prev\_neuron\_dims};
471     prev\_neuron\_dims[\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}]
472       = (\hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[parent\_index+1] - 
      \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}[parent\_index]);
473     \textcolor{keywordflow}{return} prev\_neuron\_dims;
474   \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_af0e60f4a7e00657ceb429aaa8d7f5040_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a5c6edd4ca11a102b809987851f51e2d4}\label{classlbann_1_1concatenation__layer_a5c6edd4ca11a102b809987851f51e2d4}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!get\+\_\+type@{get\+\_\+type}}
\index{get\+\_\+type@{get\+\_\+type}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{get\+\_\+type()}{get\_type()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
std\+::string \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::get\+\_\+type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Get the layer type\textquotesingle{}s name. A layer type name should be brief, human-\/readable description of the layer\textquotesingle{}s mathematical operation. 

Implements \hyperlink{classlbann_1_1Layer_a0fa0ea9160b490c151c0a17fde4f7239}{lbann\+::\+Layer}.



Definition at line 116 of file concatenation.\+hpp.


\begin{DoxyCode}
116 \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"concatenation"}; \}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_af91f0850e13dd854e095f2c9d00d58b2}\label{classlbann_1_1concatenation__layer_af91f0850e13dd854e095f2c9d00d58b2}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
\hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer}\& \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1concatenation__layer}{concatenation\+\_\+layer}$<$ T\+\_\+layout $>$ \&}]{other }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 91 of file concatenation.\+hpp.


\begin{DoxyCode}
91                                                                    \{
92     \hyperlink{classlbann_1_1Layer_a00d8acde68fda2f38c4a39ef8c89234a}{transform\_layer::operator=}(other);
93     \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis} = other.m\_concatenation\_axis;
94     \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points} = other.m\_concatenation\_points;
95 
96     \textcolor{comment}{// Deep copy matrices}
97     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} != \textcolor{keyword}{nullptr})  \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v}; \}
98     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} != \textcolor{keyword}{nullptr}) \{ \textcolor{keyword}{delete} 
      \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v}; \}
99     \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} = other.m\_input\_region\_v;
100     \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} = other.m\_output\_region\_v;
101     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} != \textcolor{keyword}{nullptr}) \{
102       \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} = \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v}->Copy();
103     \}
104     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} != \textcolor{keyword}{nullptr}) \{
105       \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} = \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v}->Copy();
106     \}
107 
108   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_af91f0850e13dd854e095f2c9d00d58b2_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_abc44199934950480dbde30e0b7058a78}\label{classlbann_1_1concatenation__layer_abc44199934950480dbde30e0b7058a78}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!setup\+\_\+dims@{setup\+\_\+dims}}
\index{setup\+\_\+dims@{setup\+\_\+dims}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{setup\+\_\+dims()}{setup\_dims()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::setup\+\_\+dims (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Setup tensor dimensions Called by the setup function. The base method sets the dimensions of the activation tensors equal to the dimensions of the first previous activation tensor. 

Reimplemented from \hyperlink{classlbann_1_1Layer_a90fce1b06c1f2abb480e18cfe08a9746}{lbann\+::\+Layer}.



Definition at line 154 of file concatenation.\+hpp.


\begin{DoxyCode}
154                              \{
155     std::stringstream err;
156 
157     \textcolor{comment}{// Initialize previous neuron tensor dimensions}
158     \hyperlink{classlbann_1_1Layer_a90fce1b06c1f2abb480e18cfe08a9746}{transform\_layer::setup\_dims}();
159 
160     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis} >= (\textcolor{keywordtype}{int}) \hyperlink{classlbann_1_1Layer_ae204d1a2a79606eaa117273857ff62a3}{m\_prev\_neuron\_dims}.size()) \{
161       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
162           << \textcolor{stringliteral}{"layer "} << \hyperlink{classlbann_1_1Layer_a80027550202fa7dbb1dd55fa8a66c84b}{get\_name}() << \textcolor{stringliteral}{" cannot concatenate along "}
163           << \textcolor{stringliteral}{"axis "} << \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis} << \textcolor{stringliteral}{" since it only has "}
164           << \hyperlink{classlbann_1_1Layer_ae204d1a2a79606eaa117273857ff62a3}{m\_prev\_neuron\_dims}.size() << \textcolor{stringliteral}{" dimensions"};
165       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
166     \}
167 
168     \textcolor{comment}{// Get concatenation axis indices corresponding to parent layers}
169     \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}.empty();
170     \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}.push\_back(0);
171     \textcolor{keyword}{auto} expected\_dims = \hyperlink{classlbann_1_1Layer_ae204d1a2a79606eaa117273857ff62a3}{m\_prev\_neuron\_dims};
172     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& parent : this->\hyperlink{classlbann_1_1Layer_a3fa7c6cf1a22bb14ab0e85e3dc6027c5}{m\_parent\_layers}) \{
173       \textcolor{keyword}{const} \textcolor{keyword}{auto}& parent\_dims = parent->fp\_output\_dims(\textcolor{keyword}{this});
174 
175       \textcolor{comment}{// Check that dimensions are valid}
176       \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{int}) parent\_dims.size() > \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}) \{
177         expected\_dims[\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}] = parent\_dims[
      \hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}];
178       \}
179       \textcolor{keywordflow}{if} (parent\_dims != expected\_dims) \{
180         err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
181             << \textcolor{stringliteral}{"layer "} << \hyperlink{classlbann_1_1Layer_a80027550202fa7dbb1dd55fa8a66c84b}{get\_name}() << \textcolor{stringliteral}{" expects inputs with "}
182             << \textcolor{stringliteral}{"dimensions "};
183         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < expected\_dims.size(); ++i) \{
184           err << (i > 0 ? \textcolor{stringliteral}{"x"} : \textcolor{stringliteral}{""}) << expected\_dims[i];
185         \}
186         err << \textcolor{stringliteral}{", but layer "} << parent->get\_name() << \textcolor{stringliteral}{" outputs with "}
187             << \textcolor{stringliteral}{"dimensions "};
188         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < parent\_dims.size(); ++i) \{
189           err << (i > 0 ? \textcolor{stringliteral}{"x"} : \textcolor{stringliteral}{""}) << parent\_dims[i];
190         \}
191       \}
192 
193       \textcolor{comment}{// Get concatentation axis upper bound for parent layer}
194       \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}.push\_back(
      \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}.back()
195                                        + parent\_dims[\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}]);
196 
197     \}    
198 
199     \textcolor{comment}{// Update neuron dimensions}
200     this->\hyperlink{classlbann_1_1Layer_abb34bb8031f57a483e2e327a5f229f48}{m\_neuron\_dims}[\hyperlink{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}{m\_concatenation\_axis}] = 
      \hyperlink{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}{m\_concatenation\_points}.back();
201     this->\hyperlink{classlbann_1_1Layer_a6b5ebc8a7d9329d8a773ed787e7b41d8}{m\_num\_neurons} = std::accumulate(\hyperlink{classlbann_1_1Layer_abb34bb8031f57a483e2e327a5f229f48}{m\_neuron\_dims}.begin(),
202                                           \hyperlink{classlbann_1_1Layer_abb34bb8031f57a483e2e327a5f229f48}{m\_neuron\_dims}.end(),
203                                           1,
204                                           std::multiplies<int>());
205 
206   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_abc44199934950480dbde30e0b7058a78_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a9c305ea0cbee1b7b6fe822f514c48d42}\label{classlbann_1_1concatenation__layer_a9c305ea0cbee1b7b6fe822f514c48d42}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!setup\+\_\+matrices@{setup\+\_\+matrices}}
\index{setup\+\_\+matrices@{setup\+\_\+matrices}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{setup\+\_\+matrices()}{setup\_matrices()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::setup\+\_\+matrices (\begin{DoxyParamCaption}\item[{const \hyperlink{base_8hpp_a9951bb1719d534e0401b1f06cad19eab}{El\+::\+Grid} \&}]{grid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Instantiate distributed matrices. If the layer has already been setup, this function should destroy all matrices and reinstantiate them. However, it is not guaranteed that derived classes will obey this behavior. 

Reimplemented from \hyperlink{classlbann_1_1Layer_a57bbe21131dc00ab5cf9ea5e3656808e}{lbann\+::\+Layer}.



Definition at line 145 of file concatenation.\+hpp.


\begin{DoxyCode}
145                                                    \{
146     \hyperlink{classlbann_1_1Layer_a57bbe21131dc00ab5cf9ea5e3656808e}{transform\_layer::setup\_matrices}(grid);
147     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} != \textcolor{keyword}{nullptr})  \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v}; \}
148     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} != \textcolor{keyword}{nullptr}) \{ \textcolor{keyword}{delete} 
      \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v}; \}
149     \textcolor{keyword}{const} \textcolor{keyword}{auto}& input = \hyperlink{classlbann_1_1Layer_a45853df73a2e72bfaa774665a0f37ed7}{get\_prev\_activations}();
150     \hyperlink{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}{m\_input\_region\_v} = input.Construct(input.Grid(), input.Root());
151     \hyperlink{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}{m\_output\_region\_v} = input.Construct(input.Grid(), input.Root());
152   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_a9c305ea0cbee1b7b6fe822f514c48d42_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a20c1588e7a506bc7b0acb4d63586ece9}\label{classlbann_1_1concatenation__layer_a20c1588e7a506bc7b0acb4d63586ece9}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!setup\+\_\+pointers@{setup\+\_\+pointers}}
\index{setup\+\_\+pointers@{setup\+\_\+pointers}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{setup\+\_\+pointers()}{setup\_pointers()}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
void \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::setup\+\_\+pointers (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Setup pointers to parent and child layers. Called by the setup function. The base method checks that the number of parents and children are valid. Pointers to the parent/child layers are assumed to be already initialized. 

Reimplemented from \hyperlink{classlbann_1_1Layer_a71b7a62afd9b73c23b2c0267b8ba0981}{lbann\+::\+Layer}.



Definition at line 135 of file concatenation.\+hpp.


\begin{DoxyCode}
135                                  \{
136     \hyperlink{classlbann_1_1Layer_a71b7a62afd9b73c23b2c0267b8ba0981}{transform\_layer::setup\_pointers}();
137     std::stringstream err;
138     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1Layer_ac9290d4a6453ccda5f6b4d8b57b49ba3}{get\_num\_parents}() <= 0) \{
139       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: concatenation\_layer: "}
140           << \textcolor{stringliteral}{"concatenation layer has no parents"};
141       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
142     \}
143   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1concatenation__layer_a20c1588e7a506bc7b0acb4d63586ece9_cgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}\label{classlbann_1_1concatenation__layer_a4ac4a931dc85d622e9ea8fddb9625d38}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!m\+\_\+concatenation\+\_\+axis@{m\+\_\+concatenation\+\_\+axis}}
\index{m\+\_\+concatenation\+\_\+axis@{m\+\_\+concatenation\+\_\+axis}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{m\+\_\+concatenation\+\_\+axis}{m\_concatenation\_axis}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
int \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::m\+\_\+concatenation\+\_\+axis\hspace{0.3cm}{\ttfamily [private]}}

Tensor dimension to concatenation. 

Definition at line 44 of file concatenation.\+hpp.

\mbox{\Hypertarget{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}\label{classlbann_1_1concatenation__layer_a363324fe6cd104740334f3396085328c}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!m\+\_\+concatenation\+\_\+points@{m\+\_\+concatenation\+\_\+points}}
\index{m\+\_\+concatenation\+\_\+points@{m\+\_\+concatenation\+\_\+points}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{m\+\_\+concatenation\+\_\+points}{m\_concatenation\_points}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
std\+::vector$<$int$>$ \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::m\+\_\+concatenation\+\_\+points\hspace{0.3cm}{\ttfamily [private]}}

Concatenation points for each child layer. 

Definition at line 46 of file concatenation.\+hpp.

\mbox{\Hypertarget{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}\label{classlbann_1_1concatenation__layer_afa68f2e5d3ea2de57f4974a37c01fc7b}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!m\+\_\+input\+\_\+region\+\_\+v@{m\+\_\+input\+\_\+region\+\_\+v}}
\index{m\+\_\+input\+\_\+region\+\_\+v@{m\+\_\+input\+\_\+region\+\_\+v}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{m\+\_\+input\+\_\+region\+\_\+v}{m\_input\_region\_v}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
\hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat}$\ast$ \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::m\+\_\+input\+\_\+region\+\_\+v\hspace{0.3cm}{\ttfamily [private]}}

View into region of input tensor. 

Definition at line 49 of file concatenation.\+hpp.

\mbox{\Hypertarget{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}\label{classlbann_1_1concatenation__layer_af141bf9cf1569121a65a68e4ae97855c}} 
\index{lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}!m\+\_\+output\+\_\+region\+\_\+v@{m\+\_\+output\+\_\+region\+\_\+v}}
\index{m\+\_\+output\+\_\+region\+\_\+v@{m\+\_\+output\+\_\+region\+\_\+v}!lbann\+::concatenation\+\_\+layer@{lbann\+::concatenation\+\_\+layer}}
\subsubsection{\texorpdfstring{m\+\_\+output\+\_\+region\+\_\+v}{m\_output\_region\_v}}
{\footnotesize\ttfamily template$<$data\+\_\+layout T\+\_\+layout = data\+\_\+layout\+::\+D\+A\+T\+A\+\_\+\+P\+A\+R\+A\+L\+L\+EL$>$ \\
\hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat}$\ast$ \hyperlink{classlbann_1_1concatenation__layer}{lbann\+::concatenation\+\_\+layer}$<$ T\+\_\+layout $>$\+::m\+\_\+output\+\_\+region\+\_\+v\hspace{0.3cm}{\ttfamily [private]}}

View into region of output tensor. 

Definition at line 51 of file concatenation.\+hpp.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/layers/transform/\hyperlink{concatenation_8hpp}{concatenation.\+hpp}\end{DoxyCompactItemize}
