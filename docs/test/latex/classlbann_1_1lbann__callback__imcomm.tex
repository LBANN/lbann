\hypertarget{classlbann_1_1lbann__callback__imcomm}{}\section{lbann\+:\+:lbann\+\_\+callback\+\_\+imcomm Class Reference}
\label{classlbann_1_1lbann__callback__imcomm}\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}


{\ttfamily \#include $<$callback\+\_\+imcomm.\+hpp$>$}



Inheritance diagram for lbann\+:\+:lbann\+\_\+callback\+\_\+imcomm\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=192pt]{classlbann_1_1lbann__callback__imcomm__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for lbann\+:\+:lbann\+\_\+callback\+\_\+imcomm\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{classlbann_1_1lbann__callback__imcomm__coll__graph}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structlbann_1_1lbann__callback__imcomm_1_1imcomm__params}{imcomm\+\_\+params}
\end{DoxyCompactItemize}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type} \{ \newline
\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03}{N\+O\+NE}, 
\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e}{N\+O\+R\+M\+AL}, 
\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33}{O\+N\+E\+B\+I\+T\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}, 
\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4}{T\+H\+R\+E\+S\+H\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}, 
\newline
\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aaeb95973ab89fc579b91554cd783031b7}{A\+D\+A\+P\+T\+I\+V\+E\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}
 \}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1lbann__callback__imcomm_a06dc9efdcd77c9e1cf714ecf709a6e3a}{lbann\+\_\+callback\+\_\+imcomm} (\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type} ct=\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e}{N\+O\+R\+M\+AL}, \hyperlink{classlbann_1_1lbann__summary}{lbann\+\_\+summary} $\ast$summarizer=nullptr)
\item 
\hyperlink{classlbann_1_1lbann__callback__imcomm_a95ae70dd6a90c023ee3bd0638dc24888}{lbann\+\_\+callback\+\_\+imcomm} (const \hyperlink{classlbann_1_1lbann__callback__imcomm}{lbann\+\_\+callback\+\_\+imcomm} \&)=default
\item 
\hyperlink{classlbann_1_1lbann__callback__imcomm}{lbann\+\_\+callback\+\_\+imcomm} \& \hyperlink{classlbann_1_1lbann__callback__imcomm_a01ee7aaa808987e1f7fcca0e85cc1f73}{operator=} (const \hyperlink{classlbann_1_1lbann__callback__imcomm}{lbann\+\_\+callback\+\_\+imcomm} \&)=default
\item 
\hyperlink{classlbann_1_1lbann__callback__imcomm}{lbann\+\_\+callback\+\_\+imcomm} $\ast$ \hyperlink{classlbann_1_1lbann__callback__imcomm_a9d59535b4789389a8c3c9e406cd1e2d3}{copy} () const override
\item 
\hyperlink{classlbann_1_1lbann__callback__imcomm_aadc785d2f27ad0b03fce8c2785cff4fb}{lbann\+\_\+callback\+\_\+imcomm} (\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type} ct, std\+::unordered\+\_\+set$<$ \hyperlink{classlbann_1_1weights}{weights} $\ast$$>$ weights\+\_\+list, \hyperlink{classlbann_1_1lbann__summary}{lbann\+\_\+summary} $\ast$summarizer=nullptr)
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_a6ad492f30a34de2ac62fe459037e1d12}{set\+\_\+weights\+\_\+comm} (\hyperlink{classlbann_1_1weights}{weights} $\ast$w, \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type} ct)
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_a5e0f7d9f85da8d2e579dbe4092bc3100}{set\+\_\+weights\+\_\+adaptive} (\hyperlink{classlbann_1_1weights}{weights} $\ast$w, int proportion)
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_acf71333f73d26714217ffcd93aa31830}{set\+\_\+weights\+\_\+threshold} (\hyperlink{classlbann_1_1weights}{weights} $\ast$w, Data\+Type pos\+\_\+thresh, Data\+Type neg\+\_\+thresh)
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_a096555a87ce1bb011ceafb44081c4192}{setup} (\hyperlink{classlbann_1_1model}{model} $\ast$m) override
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_a332ba4ceca91939c79fae2735fdc8ff3}{on\+\_\+train\+\_\+begin} (\hyperlink{classlbann_1_1model}{model} $\ast$m) override
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_a3160dbf536def4f930e0ea0aabdebc11}{on\+\_\+epoch\+\_\+end} (\hyperlink{classlbann_1_1model}{model} $\ast$m) override
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_a0a425ba562f7637b25cd6ba094e7885b}{on\+\_\+backward\+\_\+prop\+\_\+end} (\hyperlink{classlbann_1_1model}{model} $\ast$m) override
\item 
std\+::string \hyperlink{classlbann_1_1lbann__callback__imcomm_af058602425005a1d198df40b7845e16e}{name} () const override
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705}{ct\+\_\+does\+\_\+quantization} (\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type} ct) const
\item 
bool \hyperlink{classlbann_1_1lbann__callback__imcomm_ab7106f5ee53672f5ef5a58371eb39f0b}{ct\+\_\+needs\+\_\+reshape} (\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type} ct) const
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_a13fe710b841f72e28daf8de029f6c2f9}{reshape\+\_\+mat} (\hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} \&mat, \hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} \&reshaped, El\+::\+Int height, El\+::\+Int width)
\item 
void \hyperlink{classlbann_1_1lbann__callback__imcomm_ad45c39a7a85fb8e1d99eca97aa4d9d09}{do\+\_\+summary} (\hyperlink{classlbann_1_1model}{model} $\ast$m, \hyperlink{classlbann_1_1weights}{weights} $\ast$w, \hyperlink{base_8hpp_a3266f5ac18504bbadea983c109566867}{Eval\+Type} im\+\_\+time)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type} \hyperlink{classlbann_1_1lbann__callback__imcomm_ac3df687b12721a7278877c303357bc09}{m\+\_\+default\+\_\+ct}
\item 
std\+::unordered\+\_\+map$<$ \hyperlink{classlbann_1_1weights}{weights} $\ast$, \hyperlink{structlbann_1_1lbann__callback__imcomm_1_1imcomm__params}{imcomm\+\_\+params} $>$ \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\+\_\+weights\+\_\+params}
\item 
\hyperlink{classlbann_1_1lbann__quantizer}{lbann\+\_\+quantizer} \hyperlink{classlbann_1_1lbann__callback__imcomm_a4994863d7f69e801c042c5d460bb3f34}{m\+\_\+quantizer}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
Support inter-\/model communication after each mini-\/batch to synchronize gradient updates. This optionally supports quantizing the gradient updates before communication in order to reduce bandwidth requirements. 

Definition at line 46 of file callback\+\_\+imcomm.\+hpp.



\subsection{Member Enumeration Documentation}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}\label{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!comm\+\_\+type@{comm\+\_\+type}}
\index{comm\+\_\+type@{comm\+\_\+type}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{comm\+\_\+type}{comm\_type}}
{\footnotesize\ttfamily enum \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::comm\+\_\+type}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{N\+O\+NE@{N\+O\+NE}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!N\+O\+NE@{N\+O\+NE}}}\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03}\label{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03}} 
N\+O\+NE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{N\+O\+R\+M\+AL@{N\+O\+R\+M\+AL}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!N\+O\+R\+M\+AL@{N\+O\+R\+M\+AL}}}\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e}\label{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e}} 
N\+O\+R\+M\+AL&Do no gradient updates. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{O\+N\+E\+B\+I\+T\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON@{O\+N\+E\+B\+I\+T\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!O\+N\+E\+B\+I\+T\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON@{O\+N\+E\+B\+I\+T\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}}}\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33}\label{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33}} 
O\+N\+E\+B\+I\+T\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON&Simply sum gradient updates. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{T\+H\+R\+E\+S\+H\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON@{T\+H\+R\+E\+S\+H\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!T\+H\+R\+E\+S\+H\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON@{T\+H\+R\+E\+S\+H\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}}}\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4}\label{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4}} 
T\+H\+R\+E\+S\+H\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON&Do one-\/bit quantization. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{A\+D\+A\+P\+T\+I\+V\+E\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON@{A\+D\+A\+P\+T\+I\+V\+E\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!A\+D\+A\+P\+T\+I\+V\+E\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON@{A\+D\+A\+P\+T\+I\+V\+E\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON}}}\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aaeb95973ab89fc579b91554cd783031b7}\label{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aaeb95973ab89fc579b91554cd783031b7}} 
A\+D\+A\+P\+T\+I\+V\+E\+\_\+\+Q\+U\+A\+N\+T\+I\+Z\+A\+T\+I\+ON&Do threshold quantization. \\
\hline

\end{DoxyEnumFields}


Definition at line 50 of file callback\+\_\+imcomm.\+hpp.


\begin{DoxyCode}
50                  \{
51     \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03}{NONE},  
52     \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e}{NORMAL},  
53     \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33}{ONEBIT\_QUANTIZATION},  
54     \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4}{THRESH\_QUANTIZATION},  
55     \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aaeb95973ab89fc579b91554cd783031b7}{ADAPTIVE\_QUANTIZATION},  
56   \};
\end{DoxyCode}


\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a06dc9efdcd77c9e1cf714ecf709a6e3a}\label{classlbann_1_1lbann__callback__imcomm_a06dc9efdcd77c9e1cf714ecf709a6e3a}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!lbann\+\_\+callback\+\_\+imcomm@{lbann\+\_\+callback\+\_\+imcomm}}
\index{lbann\+\_\+callback\+\_\+imcomm@{lbann\+\_\+callback\+\_\+imcomm}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{lbann\+\_\+callback\+\_\+imcomm()}{lbann\_callback\_imcomm()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::lbann\+\_\+callback\+\_\+imcomm (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{lbann\+\_\+callback\+\_\+imcomm\+::comm\+\_\+type}}]{ct = {\ttfamily \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e}{N\+O\+R\+M\+AL}},  }\item[{\hyperlink{classlbann_1_1lbann__summary}{lbann\+\_\+summary} $\ast$}]{summarizer = {\ttfamily nullptr} }\end{DoxyParamCaption})}

Initialize with ct being used for all weights. 

Definition at line 37 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
38                                :
39   \hyperlink{classlbann_1_1lbann__callback_a679057298a41ddd47f08c157f756c584}{lbann\_callback}(1, summarizer), \hyperlink{classlbann_1_1lbann__callback__imcomm_ac3df687b12721a7278877c303357bc09}{m\_default\_ct}(ct) \{\}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a06dc9efdcd77c9e1cf714ecf709a6e3a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a95ae70dd6a90c023ee3bd0638dc24888}\label{classlbann_1_1lbann__callback__imcomm_a95ae70dd6a90c023ee3bd0638dc24888}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!lbann\+\_\+callback\+\_\+imcomm@{lbann\+\_\+callback\+\_\+imcomm}}
\index{lbann\+\_\+callback\+\_\+imcomm@{lbann\+\_\+callback\+\_\+imcomm}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{lbann\+\_\+callback\+\_\+imcomm()}{lbann\_callback\_imcomm()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::lbann\+\_\+callback\+\_\+imcomm (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1lbann__callback__imcomm}{lbann\+\_\+callback\+\_\+imcomm} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}

\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_aadc785d2f27ad0b03fce8c2785cff4fb}\label{classlbann_1_1lbann__callback__imcomm_aadc785d2f27ad0b03fce8c2785cff4fb}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!lbann\+\_\+callback\+\_\+imcomm@{lbann\+\_\+callback\+\_\+imcomm}}
\index{lbann\+\_\+callback\+\_\+imcomm@{lbann\+\_\+callback\+\_\+imcomm}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{lbann\+\_\+callback\+\_\+imcomm()}{lbann\_callback\_imcomm()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::lbann\+\_\+callback\+\_\+imcomm (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{lbann\+\_\+callback\+\_\+imcomm\+::comm\+\_\+type}}]{ct,  }\item[{std\+::unordered\+\_\+set$<$ \hyperlink{classlbann_1_1weights}{weights} $\ast$$>$}]{weights\+\_\+list,  }\item[{\hyperlink{classlbann_1_1lbann__summary}{lbann\+\_\+summary} $\ast$}]{summarizer = {\ttfamily nullptr} }\end{DoxyParamCaption})}

Convenience initialization to do one update type for specific weights. Implies no inter-\/model updates for other weights. 

Definition at line 41 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
43                                :
44   \hyperlink{classlbann_1_1lbann__callback__imcomm_a06dc9efdcd77c9e1cf714ecf709a6e3a}{lbann\_callback\_imcomm}(ct, summarizer) \{
45   \textcolor{keywordflow}{for} (weights *w : weights\_list) \{
46     \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w] = \{\};
47     \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].ct = ct;
48   \}
49 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a9d59535b4789389a8c3c9e406cd1e2d3}\label{classlbann_1_1lbann__callback__imcomm_a9d59535b4789389a8c3c9e406cd1e2d3}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!copy@{copy}}
\index{copy@{copy}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1lbann__callback__imcomm}{lbann\+\_\+callback\+\_\+imcomm}$\ast$ lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \hyperlink{classlbann_1_1lbann__callback_a9f545d1269a8c7af335625d049691f26}{lbann\+::lbann\+\_\+callback}.



Definition at line 65 of file callback\+\_\+imcomm.\+hpp.


\begin{DoxyCode}
65                                                \{
66     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \hyperlink{classlbann_1_1lbann__callback__imcomm_a06dc9efdcd77c9e1cf714ecf709a6e3a}{lbann\_callback\_imcomm}(*\textcolor{keyword}{this});
67   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a9d59535b4789389a8c3c9e406cd1e2d3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705}\label{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!ct\+\_\+does\+\_\+quantization@{ct\+\_\+does\+\_\+quantization}}
\index{ct\+\_\+does\+\_\+quantization@{ct\+\_\+does\+\_\+quantization}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{ct\+\_\+does\+\_\+quantization()}{ct\_does\_quantization()}}
{\footnotesize\ttfamily bool lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::ct\+\_\+does\+\_\+quantization (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type}}]{ct }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}

Return true if the comm type does quantization. 

Definition at line 119 of file callback\+\_\+imcomm.\+hpp.


\begin{DoxyCode}
119                                                        \{
120     \textcolor{keywordflow}{return} (ct == \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33}{ONEBIT\_QUANTIZATION} ||
121             ct == \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4}{THRESH\_QUANTIZATION} ||
122             ct == \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aaeb95973ab89fc579b91554cd783031b7}{ADAPTIVE\_QUANTIZATION});
123   \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_ab7106f5ee53672f5ef5a58371eb39f0b}\label{classlbann_1_1lbann__callback__imcomm_ab7106f5ee53672f5ef5a58371eb39f0b}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!ct\+\_\+needs\+\_\+reshape@{ct\+\_\+needs\+\_\+reshape}}
\index{ct\+\_\+needs\+\_\+reshape@{ct\+\_\+needs\+\_\+reshape}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{ct\+\_\+needs\+\_\+reshape()}{ct\_needs\_reshape()}}
{\footnotesize\ttfamily bool lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::ct\+\_\+needs\+\_\+reshape (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type}}]{ct }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}

Return true if the comm type prefers reshaping. 

Definition at line 126 of file callback\+\_\+imcomm.\+hpp.


\begin{DoxyCode}
126                                                    \{
127     \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705}{ct\_does\_quantization}(ct);  \textcolor{comment}{// Currently, all quantization reshapes.}
128   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_ab7106f5ee53672f5ef5a58371eb39f0b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_ab7106f5ee53672f5ef5a58371eb39f0b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_ad45c39a7a85fb8e1d99eca97aa4d9d09}\label{classlbann_1_1lbann__callback__imcomm_ad45c39a7a85fb8e1d99eca97aa4d9d09}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!do\+\_\+summary@{do\+\_\+summary}}
\index{do\+\_\+summary@{do\+\_\+summary}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{do\+\_\+summary()}{do\_summary()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::do\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m,  }\item[{\hyperlink{classlbann_1_1weights}{weights} $\ast$}]{w,  }\item[{\hyperlink{base_8hpp_a3266f5ac18504bbadea983c109566867}{Eval\+Type}}]{im\+\_\+time }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Summarize relevant statistics. 

Definition at line 207 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
208                                                          \{
209   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer} == \textcolor{keyword}{nullptr}) \{
210     \textcolor{keywordflow}{return};
211   \}
212   lbann\_comm *\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm} = m->get\_comm();
213   std::string prefix = w->get\_name() + \textcolor{stringliteral}{"/imcomm\_"};
214   \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"time"},
215                               im\_time, m->get\_cur\_step());
216   \textcolor{keywordtype}{size\_t} bytes\_sent = 0;
217   \textcolor{keywordtype}{size\_t} bytes\_received = 0;
218   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705}{ct\_does\_quantization}(\hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].ct)) \{
219     bytes\_sent = comm->get\_ar\_bytes\_sent();
220     bytes\_received = comm->get\_ar\_bytes\_received();
221   \} \textcolor{keywordflow}{else} \{
222     \textcolor{comment}{// Use the same approximation the comm layer does.}
223     \textcolor{keyword}{const} \hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat}& local\_gradients =
224       w->get\_optimizer()->get\_gradient().LockedMatrix();
225     bytes\_sent =
226       \textcolor{keyword}{sizeof}(DataType) * local\_gradients.Height() * local\_gradients.Width();
227     bytes\_received =
228       \textcolor{keyword}{sizeof}(DataType) * local\_gradients.Height() * local\_gradients.Width();
229   \}
230   \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"bytes\_sent"},
231                               bytes\_sent, m->get\_cur\_step());
232   \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"bytes\_received"},
233                               bytes\_received, m->get\_cur\_step());
234   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705}{ct\_does\_quantization}(\hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].ct)) \{
235     \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"rs\_bytes\_sent"},
236                                 comm->get\_ar\_rs\_bytes\_sent(),
237                                 m->get\_cur\_step());
238     \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"ag\_bytes\_sent"},
239                                 comm->get\_ar\_ag\_bytes\_sent(),
240                                 m->get\_cur\_step());
241     \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"rs\_bytes\_received"},
242                                 comm->get\_ar\_rs\_bytes\_received(),
243                                 m->get\_cur\_step());
244     \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"ag\_bytes\_received"},
245                                 comm->get\_ar\_ag\_bytes\_received(),
246                                 m->get\_cur\_step());
247     \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"ar\_send\_trans\_time"},
248                                 comm->get\_ar\_send\_transform\_time(),
249                                 m->get\_cur\_step());
250     \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"ar\_recv\_trans\_time"},
251                                 comm->get\_ar\_recv\_transform\_time(),
252                                 m->get\_cur\_step());
253     \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"ar\_recv\_apply\_trans\_time"},
254                                 comm->get\_ar\_recv\_apply\_transform\_time(),
255                                 m->get\_cur\_step());
256     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].ct == \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aaeb95973ab89fc579b91554cd783031b7}{ADAPTIVE\_QUANTIZATION}) \{
257       \hyperlink{classlbann_1_1lbann__callback_a277d46138184f85f161a8263b8322c76}{m\_summarizer}->\hyperlink{classlbann_1_1lbann__summary_a3e0b9aae1f80403a195567fd25ea2525}{reduce\_scalar}(prefix + \textcolor{stringliteral}{"quantized\_count"},
258                                   \hyperlink{classlbann_1_1lbann__callback__imcomm_a4994863d7f69e801c042c5d460bb3f34}{m\_quantizer}.\hyperlink{classlbann_1_1lbann__quantizer_afe560823e51a64b1bb42c6f6cbd83ee0}{get\_quantized\_count}(),
259                                   m->get\_cur\_step());
260     \}
261     \hyperlink{classlbann_1_1lbann__callback__imcomm_a4994863d7f69e801c042c5d460bb3f34}{m\_quantizer}.\hyperlink{classlbann_1_1lbann__quantizer_aee1ea46e3191ad25fd310938eaf5a2e0}{reset\_counters}();
262     comm->reset\_stats\_counters();
263   \}
264 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_ad45c39a7a85fb8e1d99eca97aa4d9d09_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_ad45c39a7a85fb8e1d99eca97aa4d9d09_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_af058602425005a1d198df40b7845e16e}\label{classlbann_1_1lbann__callback__imcomm_af058602425005a1d198df40b7845e16e}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!name@{name}}
\index{name@{name}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{name()}{name()}}
{\footnotesize\ttfamily std\+::string lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Return this callback\textquotesingle{}s name. 

Implements \hyperlink{classlbann_1_1lbann__callback_a7522c7a14f1d6a1ea762cc2d7248eb3a}{lbann\+::lbann\+\_\+callback}.



Definition at line 93 of file callback\+\_\+imcomm.\+hpp.


\begin{DoxyCode}
93 \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"imcomm"}; \}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a0a425ba562f7637b25cd6ba094e7885b}\label{classlbann_1_1lbann__callback__imcomm_a0a425ba562f7637b25cd6ba094e7885b}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!on\+\_\+backward\+\_\+prop\+\_\+end@{on\+\_\+backward\+\_\+prop\+\_\+end}}
\index{on\+\_\+backward\+\_\+prop\+\_\+end@{on\+\_\+backward\+\_\+prop\+\_\+end}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{on\+\_\+backward\+\_\+prop\+\_\+end()}{on\_backward\_prop\_end()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::on\+\_\+backward\+\_\+prop\+\_\+end (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Do inter-\/model gradient updates. 

Reimplemented from \hyperlink{classlbann_1_1lbann__callback_af183624e63ba65e0003fa988f53dee0c}{lbann\+::lbann\+\_\+callback}.



Definition at line 156 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
156                                                          \{
157   lbann\_comm *\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm} = m->get\_comm();
158   \textcolor{keywordflow}{if} (comm->get\_num\_models() == 1 ||
159       m->get\_execution\_mode() != \hyperlink{base_8hpp_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214}{execution\_mode::training}) \{
160     \textcolor{keywordflow}{return};  \textcolor{comment}{// No point with only one model.}
161   \}
162   \textcolor{keywordflow}{for} (weights *w : m->get\_weights()) \{
163     \hyperlink{base_8hpp_a3266f5ac18504bbadea983c109566867}{EvalType} start\_time = \hyperlink{namespacelbann_a478d36031ff0659893c4322cd856157f}{get\_time}();
164     imcomm\_params& params = \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w];
165     \textcolor{keywordflow}{if} (params.ct == \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03}{NONE}) \{
166       \textcolor{keywordflow}{continue};
167     \}
168     optimizer *opt = w->get\_optimizer();
169     \textcolor{keyword}{auto} gradient = opt->get\_gradient().Copy();
170     \hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat}* local\_gradients = \textcolor{keyword}{nullptr};
171     \hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} reshaped;
172     \textcolor{keywordflow}{if} (params.reshape\_height > 0) \{
173       \hyperlink{classlbann_1_1lbann__callback__imcomm_a13fe710b841f72e28daf8de029f6c2f9}{reshape\_mat}(gradient->Matrix(),
174                   reshaped, params.reshape\_height, params.reshape\_width);
175       local\_gradients = &reshaped;
176     \} \textcolor{keywordflow}{else} \{
177       local\_gradients = &(gradient->Matrix());
178     \}
179     \textcolor{keywordflow}{switch} (params.ct) \{
180     \textcolor{keywordflow}{case} \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e}{NORMAL}:
181       comm->intermodel\_sum\_matrix(*local\_gradients);
182       \textcolor{keywordflow}{break};
183     \textcolor{keywordflow}{case} \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33}{ONEBIT\_QUANTIZATION}:
184       \hyperlink{classlbann_1_1lbann__callback__imcomm_a4994863d7f69e801c042c5d460bb3f34}{m\_quantizer}.\hyperlink{classlbann_1_1lbann__quantizer_a4b326de1ca5b7eba6415b6f42f83335b}{intermodel\_sum\_onebit\_quantized}(
185         comm, *local\_gradients, params.error);
186       \textcolor{keywordflow}{break};
187     \textcolor{keywordflow}{case} \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4}{THRESH\_QUANTIZATION}:
188       \hyperlink{classlbann_1_1lbann__callback__imcomm_a4994863d7f69e801c042c5d460bb3f34}{m\_quantizer}.\hyperlink{classlbann_1_1lbann__quantizer_a0bd572557675705c5e080b92d74b02ae}{intermodel\_sum\_threshold\_quantized}(
189         comm, *local\_gradients, params.error, params.pos\_thresh, params.neg\_thresh);
190       \textcolor{keywordflow}{break};
191     \textcolor{keywordflow}{case} \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aaeb95973ab89fc579b91554cd783031b7}{ADAPTIVE\_QUANTIZATION}:
192       \hyperlink{classlbann_1_1lbann__callback__imcomm_a4994863d7f69e801c042c5d460bb3f34}{m\_quantizer}.\hyperlink{classlbann_1_1lbann__quantizer_a87e856d8bf5e8a678a39cdb8f547dfd9}{intermodel\_sum\_adaptive\_quantized}(
193         comm, *local\_gradients, params.error, params.proportion);
194       \textcolor{keywordflow}{break};
195     \textcolor{keywordflow}{default}:
196       \textcolor{keywordflow}{throw}(std::string\{\} + \_\_FILE\_\_ + \textcolor{stringliteral}{" "} + std::to\_string(\_\_LINE\_\_) + \textcolor{stringliteral}{" :: "}
197          + \textcolor{stringliteral}{"imcomm: unknown comm type"});
198     \}
199     opt->clear\_gradient();
200     opt->add\_to\_gradient(*gradient);
201     \textcolor{keyword}{delete} gradient;
202     \hyperlink{base_8hpp_a3266f5ac18504bbadea983c109566867}{EvalType} im\_time = \hyperlink{namespacelbann_a478d36031ff0659893c4322cd856157f}{get\_time}() - start\_time;
203     \hyperlink{classlbann_1_1lbann__callback__imcomm_ad45c39a7a85fb8e1d99eca97aa4d9d09}{do\_summary}(m, w, im\_time);
204   \}
205 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a0a425ba562f7637b25cd6ba094e7885b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a0a425ba562f7637b25cd6ba094e7885b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a3160dbf536def4f930e0ea0aabdebc11}\label{classlbann_1_1lbann__callback__imcomm_a3160dbf536def4f930e0ea0aabdebc11}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!on\+\_\+epoch\+\_\+end@{on\+\_\+epoch\+\_\+end}}
\index{on\+\_\+epoch\+\_\+end@{on\+\_\+epoch\+\_\+end}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{on\+\_\+epoch\+\_\+end()}{on\_epoch\_end()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::on\+\_\+epoch\+\_\+end (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Clear out remaining error if needed. 

Reimplemented from \hyperlink{classlbann_1_1lbann__callback_a1fc71110e7f754bf73c9e0f344a448a5}{lbann\+::lbann\+\_\+callback}.



Definition at line 124 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
124                                                  \{
125   lbann\_comm *\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm} = m->get\_comm();
126   \textcolor{keywordflow}{if} (comm->get\_num\_models() == 1 ||
127       m->get\_execution\_mode() != \hyperlink{base_8hpp_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214}{execution\_mode::training}) \{
128     \textcolor{keywordflow}{return};  \textcolor{comment}{// No point with only one model.}
129   \}
130   \textcolor{keywordflow}{for} (weights *w : m->get\_weights()) \{
131     imcomm\_params& params = \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w];
132     optimizer *opt = w->get\_optimizer();
133     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705}{ct\_does\_quantization}(params.ct)) \{
134       comm->intermodel\_sum\_matrix(params.error);
135       opt->clear\_gradient();
136       \textcolor{keyword}{auto} gradient = opt->get\_gradient().Copy();
137       \hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} *local\_gradients = \textcolor{keyword}{nullptr};
138       \hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} reshaped;
139       \textcolor{keywordflow}{if} (params.reshape\_height > 0) \{
140         \hyperlink{classlbann_1_1lbann__callback__imcomm_a13fe710b841f72e28daf8de029f6c2f9}{reshape\_mat}(gradient->Matrix(),
141                     reshaped, params.reshape\_height, params.reshape\_width);
142         local\_gradients = &reshaped;
143       \} \textcolor{keywordflow}{else} \{
144         local\_gradients = &(gradient->Matrix());
145       \}
146       *local\_gradients = params.error;
147       opt->add\_to\_gradient(*gradient);
148       \textcolor{keyword}{delete} gradient;
149       \textcolor{comment}{// Apply optimizer update with accumulated gradient error.}
150       opt->step();
151       El::Zero(params.error);
152     \}
153   \}
154 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a3160dbf536def4f930e0ea0aabdebc11_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a3160dbf536def4f930e0ea0aabdebc11_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a332ba4ceca91939c79fae2735fdc8ff3}\label{classlbann_1_1lbann__callback__imcomm_a332ba4ceca91939c79fae2735fdc8ff3}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!on\+\_\+train\+\_\+begin@{on\+\_\+train\+\_\+begin}}
\index{on\+\_\+train\+\_\+begin@{on\+\_\+train\+\_\+begin}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{on\+\_\+train\+\_\+begin()}{on\_train\_begin()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::on\+\_\+train\+\_\+begin (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Make sure all models have the same weights. 

Reimplemented from \hyperlink{classlbann_1_1lbann__callback_a7c8f0d211967ccc5219144e92571ab26}{lbann\+::lbann\+\_\+callback}.



Definition at line 111 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
111                                                    \{
112   lbann\_comm *\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm} = m->get\_comm();
113   \textcolor{keywordflow}{if} (comm->get\_num\_models() == 1) \{
114     \textcolor{keywordflow}{return};  \textcolor{comment}{// No point with only one model.}
115   \}
116   \textcolor{keywordflow}{for} (weights *w : m->get\_weights()) \{
117     \hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{AbsDistMat} *values = w->get\_values().Copy();
118     comm->intermodel\_broadcast\_matrix(*values, 0);
119     w->set\_values(*values);
120     \textcolor{keyword}{delete} values;
121   \}
122 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a332ba4ceca91939c79fae2735fdc8ff3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a332ba4ceca91939c79fae2735fdc8ff3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a01ee7aaa808987e1f7fcca0e85cc1f73}\label{classlbann_1_1lbann__callback__imcomm_a01ee7aaa808987e1f7fcca0e85cc1f73}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1lbann__callback__imcomm}{lbann\+\_\+callback\+\_\+imcomm}\& lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1lbann__callback__imcomm}{lbann\+\_\+callback\+\_\+imcomm} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}

\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a13fe710b841f72e28daf8de029f6c2f9}\label{classlbann_1_1lbann__callback__imcomm_a13fe710b841f72e28daf8de029f6c2f9}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!reshape\+\_\+mat@{reshape\+\_\+mat}}
\index{reshape\+\_\+mat@{reshape\+\_\+mat}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{reshape\+\_\+mat()}{reshape\_mat()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::reshape\+\_\+mat (\begin{DoxyParamCaption}\item[{\hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} \&}]{mat,  }\item[{\hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} \&}]{reshaped,  }\item[{El\+::\+Int}]{height,  }\item[{El\+::\+Int}]{width }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}

Get a matrix that reinterprets mat as being height x width. Assumes that mat.\+Height()$\ast$mat.Width() == height$\ast$width. 

Definition at line 134 of file callback\+\_\+imcomm.\+hpp.


\begin{DoxyCode}
134                                                                        \{
135     reshaped.Attach(height, width, mat.Buffer(), height);
136   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a13fe710b841f72e28daf8de029f6c2f9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a13fe710b841f72e28daf8de029f6c2f9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a5e0f7d9f85da8d2e579dbe4092bc3100}\label{classlbann_1_1lbann__callback__imcomm_a5e0f7d9f85da8d2e579dbe4092bc3100}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!set\+\_\+weights\+\_\+adaptive@{set\+\_\+weights\+\_\+adaptive}}
\index{set\+\_\+weights\+\_\+adaptive@{set\+\_\+weights\+\_\+adaptive}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{set\+\_\+weights\+\_\+adaptive()}{set\_weights\_adaptive()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::set\+\_\+weights\+\_\+adaptive (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1weights}{weights} $\ast$}]{w,  }\item[{int}]{proportion }\end{DoxyParamCaption})}

Set weights to use adaptive quantization with proportion. 

Definition at line 57 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
58                                                                  \{
59   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w] = \{\};
60   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].ct = \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aaeb95973ab89fc579b91554cd783031b7}{ADAPTIVE\_QUANTIZATION};
61   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].proportion = proportion;
62 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{classlbann_1_1lbann__callback__imcomm_a5e0f7d9f85da8d2e579dbe4092bc3100_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a6ad492f30a34de2ac62fe459037e1d12}\label{classlbann_1_1lbann__callback__imcomm_a6ad492f30a34de2ac62fe459037e1d12}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!set\+\_\+weights\+\_\+comm@{set\+\_\+weights\+\_\+comm}}
\index{set\+\_\+weights\+\_\+comm@{set\+\_\+weights\+\_\+comm}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{set\+\_\+weights\+\_\+comm()}{set\_weights\_comm()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::set\+\_\+weights\+\_\+comm (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1weights}{weights} $\ast$}]{w,  }\item[{\hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type}}]{ct }\end{DoxyParamCaption})}

Choose comm type ct for weights. 

Definition at line 51 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
52                                                            \{
53   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w] = \{\};
54   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].ct = ct;
55 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a6ad492f30a34de2ac62fe459037e1d12_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_acf71333f73d26714217ffcd93aa31830}\label{classlbann_1_1lbann__callback__imcomm_acf71333f73d26714217ffcd93aa31830}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!set\+\_\+weights\+\_\+threshold@{set\+\_\+weights\+\_\+threshold}}
\index{set\+\_\+weights\+\_\+threshold@{set\+\_\+weights\+\_\+threshold}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{set\+\_\+weights\+\_\+threshold()}{set\_weights\_threshold()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::set\+\_\+weights\+\_\+threshold (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1weights}{weights} $\ast$}]{w,  }\item[{Data\+Type}]{pos\+\_\+thresh,  }\item[{Data\+Type}]{neg\+\_\+thresh }\end{DoxyParamCaption})}

Set weights to use threshold quantization with given thresholds. 

Definition at line 64 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
66                                                                        \{
67   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w] = \{\};
68   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].ct = \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4}{THRESH\_QUANTIZATION};
69   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].pos\_thresh = pos\_thresh;
70   \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].neg\_thresh = neg\_thresh;
71 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{classlbann_1_1lbann__callback__imcomm_acf71333f73d26714217ffcd93aa31830_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a096555a87ce1bb011ceafb44081c4192}\label{classlbann_1_1lbann__callback__imcomm_a096555a87ce1bb011ceafb44081c4192}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!setup@{setup}}
\index{setup@{setup}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{setup()}{setup()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::setup (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Do initialization for this model. 

Reimplemented from \hyperlink{classlbann_1_1lbann__callback_aab5086e27d9bb0a7c7ee8ffc1bc58671}{lbann\+::lbann\+\_\+callback}.



Definition at line 73 of file callback\+\_\+imcomm.\+cpp.


\begin{DoxyCode}
73                                           \{
74   \textcolor{keywordflow}{for} (weights *w : m->get\_weights()) \{
75 
76     \textcolor{comment}{// Add weights if not already in list}
77     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}.find(w) == \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}.end()) \{
78       \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w] = \{\};
79       \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w].ct = (w->get\_optimizer() != \textcolor{keyword}{nullptr} ?
80                                 \hyperlink{classlbann_1_1lbann__callback__imcomm_ac3df687b12721a7278877c303357bc09}{m\_default\_ct} :
81                                 \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03}{NONE});
82     \}
83 
84     \textcolor{comment}{// Setup imcomm parameters if needed}
85     imcomm\_params& params = \hyperlink{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}{m\_weights\_params}[w];
86     \textcolor{keywordflow}{if} (params.ct != \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03}{NONE}) \{
87       optimizer *opt = w->get\_optimizer();
88       \textcolor{keywordflow}{if} (opt == \textcolor{keyword}{nullptr}) \{
89         std::stringstream err;
90         err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
91             << \textcolor{stringliteral}{"imcomm: trying to do inter-model gradient communication on "}
92             << w->get\_name() << \textcolor{stringliteral}{", which has no optimizer"};
93         \textcolor{keywordflow}{throw}(err.str());
94       \}
95       \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__imcomm_ab7106f5ee53672f5ef5a58371eb39f0b}{ct\_needs\_reshape}(params.ct)) \{
96         \textcolor{comment}{// Currently, no weights need reshaping.}
97       \}
98       \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__imcomm_a8b29853e49c58cf737a741c503737705}{ct\_does\_quantization}(params.ct)) \{
99         \textcolor{keyword}{const} \hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{AbsDistMat}& gradients = opt->get\_gradient();
100         \textcolor{keywordflow}{if} (params.reshape\_height > 0) \{
101           El::Zeros(params.error, params.reshape\_height, params.reshape\_width);
102         \} \textcolor{keywordflow}{else} \{
103           El::Zeros(params.error, gradients.LocalHeight(), gradients.LocalWidth());
104         \}
105       \}
106     \}
107 
108   \}
109 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__imcomm_a096555a87ce1bb011ceafb44081c4192_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{classlbann_1_1lbann__callback__imcomm_a096555a87ce1bb011ceafb44081c4192_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_ac3df687b12721a7278877c303357bc09}\label{classlbann_1_1lbann__callback__imcomm_ac3df687b12721a7278877c303357bc09}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!m\+\_\+default\+\_\+ct@{m\+\_\+default\+\_\+ct}}
\index{m\+\_\+default\+\_\+ct@{m\+\_\+default\+\_\+ct}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{m\+\_\+default\+\_\+ct}{m\_default\_ct}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1lbann__callback__imcomm_acf7e894b3381e7f9b71020dc73594d6a}{comm\+\_\+type} lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::m\+\_\+default\+\_\+ct\hspace{0.3cm}{\ttfamily [private]}}

Default communication type. 

Definition at line 112 of file callback\+\_\+imcomm.\+hpp.

\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a4994863d7f69e801c042c5d460bb3f34}\label{classlbann_1_1lbann__callback__imcomm_a4994863d7f69e801c042c5d460bb3f34}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!m\+\_\+quantizer@{m\+\_\+quantizer}}
\index{m\+\_\+quantizer@{m\+\_\+quantizer}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{m\+\_\+quantizer}{m\_quantizer}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1lbann__quantizer}{lbann\+\_\+quantizer} lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::m\+\_\+quantizer\hspace{0.3cm}{\ttfamily [private]}}

Quantizer for quantization of updates, if needed. 

Definition at line 116 of file callback\+\_\+imcomm.\+hpp.

\mbox{\Hypertarget{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}\label{classlbann_1_1lbann__callback__imcomm_a32a0319c91aff324cb3468de4f31dd50}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}!m\+\_\+weights\+\_\+params@{m\+\_\+weights\+\_\+params}}
\index{m\+\_\+weights\+\_\+params@{m\+\_\+weights\+\_\+params}!lbann\+::lbann\+\_\+callback\+\_\+imcomm@{lbann\+::lbann\+\_\+callback\+\_\+imcomm}}
\subsubsection{\texorpdfstring{m\+\_\+weights\+\_\+params}{m\_weights\_params}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$\hyperlink{classlbann_1_1weights}{weights} $\ast$, \hyperlink{structlbann_1_1lbann__callback__imcomm_1_1imcomm__params}{imcomm\+\_\+params}$>$ lbann\+::lbann\+\_\+callback\+\_\+imcomm\+::m\+\_\+weights\+\_\+params\hspace{0.3cm}{\ttfamily [private]}}

Per-\/weights parameters. 

Definition at line 114 of file callback\+\_\+imcomm.\+hpp.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/callbacks/\hyperlink{callback__imcomm_8hpp}{callback\+\_\+imcomm.\+hpp}\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/src/callbacks/\hyperlink{callback__imcomm_8cpp}{callback\+\_\+imcomm.\+cpp}\end{DoxyCompactItemize}
