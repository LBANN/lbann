\hypertarget{classlbann_1_1weights}{}\section{lbann\+:\+:weights Class Reference}
\label{classlbann_1_1weights}\index{lbann\+::weights@{lbann\+::weights}}


{\ttfamily \#include $<$weights.\+hpp$>$}



Collaboration diagram for lbann\+:\+:weights\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066}{weights} (\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm}, \hyperlink{classlbann_1_1cudnn_1_1cudnn__manager}{cudnn\+::cudnn\+\_\+manager} $\ast$cudnn=nullptr)
\item 
\hyperlink{classlbann_1_1weights_ab7cca67d4459f3ba6a72dae4bb8d5cc6}{weights} (const \hyperlink{classlbann_1_1weights}{weights} \&other)
\item 
\hyperlink{classlbann_1_1weights}{weights} \& \hyperlink{classlbann_1_1weights_ac1021a88dc4efe5f91a40fae223edf4b}{operator=} (const \hyperlink{classlbann_1_1weights}{weights} \&other)
\item 
virtual \hyperlink{classlbann_1_1weights_a82334405491bee7a2e2a1295dcb94134}{$\sim$weights} ()
\item 
void \hyperlink{classlbann_1_1weights_ab886e4d3ff62b62a7ac6c52e391666f2}{set\+\_\+name} (const std\+::string name)
\item 
std\+::string \hyperlink{classlbann_1_1weights_a272f80766f31a5add7a970e5e8fcc352}{get\+\_\+name} () const
\item 
virtual \hyperlink{classlbann_1_1weights}{weights} $\ast$ \hyperlink{classlbann_1_1weights_a1a85fa681dcac2dbead2e5012099f380}{copy} () const
\item 
virtual void \hyperlink{classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5}{setup} (int size)
\item 
virtual void \hyperlink{classlbann_1_1weights_a64037919e22272a8931da328f0b2494a}{setup} (std\+::vector$<$ int $>$ dims)
\item 
virtual void \hyperlink{classlbann_1_1weights_aacf5c30b815e2f1c47a33043e440ed65}{setup} (int matrix\+\_\+height, int matrix\+\_\+width, El\+::\+Distribution col\+\_\+dist, El\+::\+Distribution row\+\_\+dist)
\item 
virtual void \hyperlink{classlbann_1_1weights_a32a8395709a5238ca93d4b4f102cdc12}{setup} (std\+::vector$<$ int $>$ matrix\+\_\+height\+\_\+dims, std\+::vector$<$ int $>$ matrix\+\_\+width\+\_\+dims, El\+::\+Distribution col\+\_\+dist, El\+::\+Distribution row\+\_\+dist)
\item 
std\+::vector$<$ int $>$ \hyperlink{classlbann_1_1weights_ac1f4e6725fc8b265e0ed5dfe140a321a}{get\+\_\+dims} () const
\item 
int \hyperlink{classlbann_1_1weights_a3216926df0aaf7aa440b9e5317d05fa2}{get\+\_\+size} () const
\item 
const std\+::vector$<$ int $>$ \& \hyperlink{classlbann_1_1weights_a2971f04c57d90fbb09631b1de3dad336}{get\+\_\+matrix\+\_\+height\+\_\+dims} () const
\item 
const std\+::vector$<$ int $>$ \& \hyperlink{classlbann_1_1weights_a783ce38ed0b75c0264dd7e28911d5ec0}{get\+\_\+matrix\+\_\+width\+\_\+dims} () const
\item 
int \hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\+\_\+matrix\+\_\+height} () const
\item 
int \hyperlink{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}{get\+\_\+matrix\+\_\+width} () const
\item 
\hyperlink{classlbann_1_1cudnn_1_1cudnn__manager}{cudnn\+::cudnn\+\_\+manager} $\ast$ \hyperlink{classlbann_1_1weights_ab8c007f217040d2c4a99acc1977d9d54}{get\+\_\+cudnn\+\_\+manager} ()
\item 
\hyperlink{classlbann_1_1weights__initializer}{weights\+\_\+initializer} \& \hyperlink{classlbann_1_1weights_a448c8a6fa03048da9f3ae275d29c824d}{get\+\_\+initializer} ()
\item 
const \hyperlink{classlbann_1_1weights__initializer}{weights\+\_\+initializer} \& \hyperlink{classlbann_1_1weights_aeaf4d47037d464922121223d4b0b6c33}{get\+\_\+initializer} () const
\item 
void \hyperlink{classlbann_1_1weights_a71e56d32d8e9c0e3ddf0ec2d0cd3924d}{set\+\_\+initializer} (\hyperlink{classlbann_1_1weights__initializer}{weights\+\_\+initializer} $\ast$initializer)
\item 
\hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$ \hyperlink{classlbann_1_1weights_accdbbd16ada5b5b12890431b92c2e706}{get\+\_\+optimizer} ()
\item 
const \hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$ \hyperlink{classlbann_1_1weights_a5754ec6534e1b47e2363c2848649f8a2}{get\+\_\+optimizer} () const
\item 
void \hyperlink{classlbann_1_1weights_ab641f66c09c8b5d491c0f262e8cb55e6}{set\+\_\+optimizer} (\hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$opt)
\item 
const \hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} \& \hyperlink{classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b}{get\+\_\+values} ()
\item 
void \hyperlink{classlbann_1_1weights_ae10da5d92c9402ced7e55f04fbd05a2e}{set\+\_\+values} (const \hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} \&values)
\item 
void \hyperlink{classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b}{set\+\_\+value} (Data\+Type value, int index)
\item 
void \hyperlink{classlbann_1_1weights_aca05fb7e298c8f9f1f30fa1a8eac9fbf}{set\+\_\+value} (Data\+Type value, std\+::vector$<$ int $>$ pos)
\item 
void \hyperlink{classlbann_1_1weights_a7ac0a9e53b249f16d5e2978e47bd6b7f}{set\+\_\+value} (Data\+Type value, int row, int col)
\item 
void \hyperlink{classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3}{get\+\_\+values\+\_\+view} (\hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} \&values\+\_\+v)
\item 
void \hyperlink{classlbann_1_1weights_ab9fe32e21ae25f6b000497addb46351f}{freeze} ()
\item 
void \hyperlink{classlbann_1_1weights_ab1e71f962a7702d0aa023fedf1c99e98}{unfreeze} ()
\item 
bool \hyperlink{classlbann_1_1weights_a5874876052191837679634186c64c388}{is\+\_\+frozen} () const
\item 
bool \hyperlink{classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4}{save\+\_\+to\+\_\+checkpoint\+\_\+shared} (\hyperlink{classlbann_1_1persist}{persist} \&p)
\item 
bool \hyperlink{classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c}{load\+\_\+from\+\_\+checkpoint\+\_\+shared} (\hyperlink{classlbann_1_1persist}{persist} \&p)
\item 
virtual void \hyperlink{classlbann_1_1weights_a1a2631987f38d32a90fbee61053a04cc}{write\+\_\+proto} (lbann\+\_\+data\+::\+Weights\+Data $\ast$proto) const
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7}{setup\+\_\+gpu} ()
\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static std\+::string \hyperlink{classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752}{get\+\_\+dims\+\_\+string} (const std\+::vector$<$ int $>$ \&height\+\_\+dims, const std\+::vector$<$ int $>$ \&width\+\_\+dims)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::string \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\+\_\+name}
\item 
\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$ \hyperlink{classlbann_1_1weights_a223e8907034888392548ae901222b39c}{m\+\_\+comm}
\item 
\hyperlink{classlbann_1_1cudnn_1_1cudnn__manager}{cudnn\+::cudnn\+\_\+manager} $\ast$ \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\+\_\+cudnn}
\item 
std\+::vector$<$ int $>$ \hyperlink{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}{m\+\_\+matrix\+\_\+height\+\_\+dims}
\item 
std\+::vector$<$ int $>$ \hyperlink{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}{m\+\_\+matrix\+\_\+width\+\_\+dims}
\item 
\hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} $\ast$ \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\+\_\+values} = nullptr
\item 
\hyperlink{classlbann_1_1weights__initializer}{weights\+\_\+initializer} $\ast$ \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\+\_\+initializer} = nullptr
\item 
\hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$ \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\+\_\+optimizer} = nullptr
\item 
bool \hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\+\_\+frozen}
\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classlbann_1_1weights_afe38b5936c7fe885023474dd92c72c67}{optimizer}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Neural network weights. Weights are tensors that act as trainable parameters for a neural network. The values can be initialized with a weights initializer and are optimized with first-\/order methods (e.\+g. stochastic gradient descent).

Internally, the weight values are stored in a 2D distributed matrix. The \char`\"{}matrix height dimensions\char`\"{} are tensor dimensions that correspond to the matrix height. The remaining dimensions, the \char`\"{}matrix width dimensions,\char`\"{} correspond to the matrix width.

Note that L\+B\+A\+NN weights are similar to Tensorflow variables and Caffe parameters. 

Definition at line 58 of file weights.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066}\label{classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066}} 
\index{lbann\+::weights@{lbann\+::weights}!weights@{weights}}
\index{weights@{weights}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{weights()}{weights()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily lbann\+::weights\+::weights (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$}]{comm,  }\item[{\hyperlink{classlbann_1_1cudnn_1_1cudnn__manager}{cudnn\+::cudnn\+\_\+manager} $\ast$}]{cudnn = {\ttfamily nullptr} }\end{DoxyParamCaption})}



Definition at line 35 of file weights.\+cpp.


\begin{DoxyCode}
37   : \hyperlink{classlbann_1_1weights_a223e8907034888392548ae901222b39c}{m\_comm}(\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm}),
38     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}(cudnn),
39     \hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\_frozen}(\textcolor{keyword}{false}) \{
40 
41   \textcolor{comment}{// Initialize weights name}
42   \textcolor{keyword}{static} \textcolor{keywordtype}{int} num\_weights = 0;
43   \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name} = \textcolor{stringliteral}{"weights"} + std::to\_string(num\_weights);
44   num\_weights++;
45 
46   \textcolor{comment}{// Zero initialization is default}
47   \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} = \textcolor{keyword}{new} constant\_initializer(\hyperlink{classlbann_1_1weights_a223e8907034888392548ae901222b39c}{m\_comm}, DataType(0));
48 
49 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ab7cca67d4459f3ba6a72dae4bb8d5cc6}\label{classlbann_1_1weights_ab7cca67d4459f3ba6a72dae4bb8d5cc6}} 
\index{lbann\+::weights@{lbann\+::weights}!weights@{weights}}
\index{weights@{weights}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{weights()}{weights()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily lbann\+::weights\+::weights (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1weights}{weights} \&}]{other }\end{DoxyParamCaption})}



Definition at line 51 of file weights.\+cpp.


\begin{DoxyCode}
52   : \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name}(other.m\_name),
53     \hyperlink{classlbann_1_1weights_a223e8907034888392548ae901222b39c}{m\_comm}(other.m\_comm),
54     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}(other.m\_cudnn),
55     \hyperlink{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}{m\_matrix\_height\_dims}(other.m\_matrix\_height\_dims),
56     \hyperlink{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}{m\_matrix\_width\_dims}(other.m\_matrix\_width\_dims),
57     \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}(other.m\_values),
58     \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}(other.m\_initializer),
59     \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}(other.m\_optimizer),
60     \hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\_frozen}(other.m\_frozen) \{
61 
62   \textcolor{comment}{// Create deep copy of pointers}
63   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} != \textcolor{keyword}{nullptr})      \{ \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} = \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->Copy(); \}
64   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} != \textcolor{keyword}{nullptr}) \{ \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} = 
      \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}->\hyperlink{classlbann_1_1weights__initializer_acc84ce49188b74b23987cef3db18525a}{copy}(); \}
65   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} != \textcolor{keyword}{nullptr}) \{
66     \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} = \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}->\hyperlink{classlbann_1_1optimizer_adf19a1d19d832ebfe70072cc202cdf39}{copy}();
67     \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}->\hyperlink{classlbann_1_1optimizer_afc00daf2acb6af7e29786524126660c2}{set\_weights}(*\textcolor{keyword}{this});
68   \}
69 
70 \textcolor{preprocessor}{  #ifdef LBANN\_HAS\_CUDNN}
71   \textcolor{comment}{// Copy GPU data}
72   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} != \textcolor{keyword}{nullptr}) \{
73     m\_values\_d = \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->copy(other.m\_values\_d,
74                                \hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\_matrix\_height}(),
75                                \hyperlink{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}{get\_matrix\_width}());
76   \}
77 \textcolor{preprocessor}{  #endif // LBANN\_HAS\_CUDNN}
78 
79 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_ab7cca67d4459f3ba6a72dae4bb8d5cc6_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a82334405491bee7a2e2a1295dcb94134}\label{classlbann_1_1weights_a82334405491bee7a2e2a1295dcb94134}} 
\index{lbann\+::weights@{lbann\+::weights}!````~weights@{$\sim$weights}}
\index{````~weights@{$\sim$weights}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{$\sim$weights()}{~weights()}}
{\footnotesize\ttfamily lbann\+::weights\+::$\sim$weights (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Definition at line 114 of file weights.\+cpp.


\begin{DoxyCode}
114                   \{
115   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} != \textcolor{keyword}{nullptr})      \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}; \}
116   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} != \textcolor{keyword}{nullptr}) \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}; \}
117   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} != \textcolor{keyword}{nullptr})   \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}; \}
118 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1weights_a1a85fa681dcac2dbead2e5012099f380}\label{classlbann_1_1weights_a1a85fa681dcac2dbead2e5012099f380}} 
\index{lbann\+::weights@{lbann\+::weights}!copy@{copy}}
\index{copy@{copy}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily virtual \hyperlink{classlbann_1_1weights}{weights}$\ast$ lbann\+::weights\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}

Create a copy of the weights. This function dynamically allocates memory for a weights instance and instantiates a copy. The caller is responsible for deallocating the instance. 

Definition at line 81 of file weights.\+hpp.


\begin{DoxyCode}
81 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{new} \hyperlink{classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066}{weights}(*\textcolor{keyword}{this}); \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a1a85fa681dcac2dbead2e5012099f380_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ab9fe32e21ae25f6b000497addb46351f}\label{classlbann_1_1weights_ab9fe32e21ae25f6b000497addb46351f}} 
\index{lbann\+::weights@{lbann\+::weights}!freeze@{freeze}}
\index{freeze@{freeze}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{freeze()}{freeze()}}
{\footnotesize\ttfamily void lbann\+::weights\+::freeze (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 192 of file weights.\+hpp.


\begin{DoxyCode}
192 \{ \hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\_frozen} = \textcolor{keyword}{true}; \}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1weights_ab8c007f217040d2c4a99acc1977d9d54}\label{classlbann_1_1weights_ab8c007f217040d2c4a99acc1977d9d54}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+cudnn\+\_\+manager@{get\+\_\+cudnn\+\_\+manager}}
\index{get\+\_\+cudnn\+\_\+manager@{get\+\_\+cudnn\+\_\+manager}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+cudnn\+\_\+manager()}{get\_cudnn\_manager()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1cudnn_1_1cudnn__manager}{cudnn\+::cudnn\+\_\+manager}$\ast$ lbann\+::weights\+::get\+\_\+cudnn\+\_\+manager (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Get reference to cu\+D\+NN manager. 

Definition at line 147 of file weights.\+hpp.


\begin{DoxyCode}
147 \{ \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}; \}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1weights_ac1f4e6725fc8b265e0ed5dfe140a321a}\label{classlbann_1_1weights_ac1f4e6725fc8b265e0ed5dfe140a321a}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+dims@{get\+\_\+dims}}
\index{get\+\_\+dims@{get\+\_\+dims}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+dims()}{get\_dims()}}
{\footnotesize\ttfamily std\+::vector$<$ int $>$ lbann\+::weights\+::get\+\_\+dims (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Get weight tensor dimensions. The dimensions are sorted in decreasing order of the data strides. This is a generalization of the \char`\"{}\+N\+C\+H\+W/\+N\+H\+W\+C\char`\"{} notation commonly used to describe image data.

These dimensions are obtained by concatenating the matrix width dimensions with the matrix height dimensions (in that order). If the weight matrix is duplicated on all processes (i.\+e. in S\+T\+AR,S\+T\+AR layout) and the local matrices are fully-\/packed, the tensor data is fully-\/packed. If the matrix is S\+T\+AR,S\+T\+AR and the local matrices are not fully-\/packed, the tensor data is fully-\/packed w.\+r.\+t. the matrix height dimensions. 

Definition at line 238 of file weights.\+cpp.


\begin{DoxyCode}
238                                        \{
239   \textcolor{keyword}{const} \textcolor{keyword}{auto}& width\_dims = \hyperlink{classlbann_1_1weights_a783ce38ed0b75c0264dd7e28911d5ec0}{get\_matrix\_width\_dims}();
240   \textcolor{keyword}{const} \textcolor{keyword}{auto}& height\_dims = \hyperlink{classlbann_1_1weights_a2971f04c57d90fbb09631b1de3dad336}{get\_matrix\_height\_dims}();
241   std::vector<int> dims;
242   dims.reserve(width\_dims.size() + height\_dims.size());
243   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& d : width\_dims)  \{ dims.push\_back(d); \}
244   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& d : height\_dims) \{ dims.push\_back(d); \}
245   \textcolor{keywordflow}{return} dims;
246 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_ac1f4e6725fc8b265e0ed5dfe140a321a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_ac1f4e6725fc8b265e0ed5dfe140a321a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752}\label{classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+dims\+\_\+string@{get\+\_\+dims\+\_\+string}}
\index{get\+\_\+dims\+\_\+string@{get\+\_\+dims\+\_\+string}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+dims\+\_\+string()}{get\_dims\_string()}}
{\footnotesize\ttfamily std\+::string lbann\+::weights\+::get\+\_\+dims\+\_\+string (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ int $>$ \&}]{height\+\_\+dims,  }\item[{const std\+::vector$<$ int $>$ \&}]{width\+\_\+dims }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}

Get string describing weight tensor dimensions. height\+\_\+dims and width\+\_\+dims are the dimensions of the weight matrix. 

Definition at line 442 of file weights.\+cpp.


\begin{DoxyCode}
443                                                                               \{
444   std::stringstream ss;
445   ss << \textcolor{stringliteral}{"("};
446   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < matrix\_height\_dims.size(); ++i) \{
447     ss << (i > 0 ? \textcolor{stringliteral}{"x"} : \textcolor{stringliteral}{""}) << matrix\_height\_dims[i];
448   \}
449   ss << \textcolor{stringliteral}{")x("};
450   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < matrix\_width\_dims.size(); ++i) \{
451     ss << (i > 0 ? \textcolor{stringliteral}{"x"} : \textcolor{stringliteral}{""}) << matrix\_width\_dims[i];
452   \}
453   ss << \textcolor{stringliteral}{")"};
454   \textcolor{keywordflow}{return} ss.str();
455 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a448c8a6fa03048da9f3ae275d29c824d}\label{classlbann_1_1weights_a448c8a6fa03048da9f3ae275d29c824d}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+initializer@{get\+\_\+initializer}}
\index{get\+\_\+initializer@{get\+\_\+initializer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+initializer()}{get\_initializer()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1weights__initializer}{weights\+\_\+initializer}\& lbann\+::weights\+::get\+\_\+initializer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Get weights initializer. 

Definition at line 150 of file weights.\+hpp.


\begin{DoxyCode}
150 \{ \textcolor{keywordflow}{return} *\hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}; \}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1weights_aeaf4d47037d464922121223d4b0b6c33}\label{classlbann_1_1weights_aeaf4d47037d464922121223d4b0b6c33}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+initializer@{get\+\_\+initializer}}
\index{get\+\_\+initializer@{get\+\_\+initializer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+initializer()}{get\_initializer()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily const \hyperlink{classlbann_1_1weights__initializer}{weights\+\_\+initializer}\& lbann\+::weights\+::get\+\_\+initializer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get weights initializer (const). 

Definition at line 152 of file weights.\+hpp.


\begin{DoxyCode}
152 \{ \textcolor{keywordflow}{return} *\hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}; \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{classlbann_1_1weights_aeaf4d47037d464922121223d4b0b6c33_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}\label{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+matrix\+\_\+height@{get\+\_\+matrix\+\_\+height}}
\index{get\+\_\+matrix\+\_\+height@{get\+\_\+matrix\+\_\+height}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+matrix\+\_\+height()}{get\_matrix\_height()}}
{\footnotesize\ttfamily int lbann\+::weights\+::get\+\_\+matrix\+\_\+height (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Get weight matrix height. If there are no matrix height dimensions, the height is one. 

Definition at line 248 of file weights.\+cpp.


\begin{DoxyCode}
248                                      \{
249   \textcolor{keyword}{const} \textcolor{keyword}{auto}& height\_dims = \hyperlink{classlbann_1_1weights_a2971f04c57d90fbb09631b1de3dad336}{get\_matrix\_height\_dims}();
250   \textcolor{keywordflow}{return} std::accumulate(height\_dims.begin(), height\_dims.end(),
251                          1, std::multiplies<int>());
252 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a2971f04c57d90fbb09631b1de3dad336}\label{classlbann_1_1weights_a2971f04c57d90fbb09631b1de3dad336}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+matrix\+\_\+height\+\_\+dims@{get\+\_\+matrix\+\_\+height\+\_\+dims}}
\index{get\+\_\+matrix\+\_\+height\+\_\+dims@{get\+\_\+matrix\+\_\+height\+\_\+dims}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+matrix\+\_\+height\+\_\+dims()}{get\_matrix\_height\_dims()}}
{\footnotesize\ttfamily const std\+::vector$<$int$>$\& lbann\+::weights\+::get\+\_\+matrix\+\_\+height\+\_\+dims (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get tensor dimensions corresponding to weight matrix height. The dimensions are sorted in decreasing order of strides. Matrix rows are fully-\/packed w.\+r.\+t. the matrix height dimensions. 

Definition at line 131 of file weights.\+hpp.


\begin{DoxyCode}
131 \{ \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}{m\_matrix\_height\_dims}; \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a2971f04c57d90fbb09631b1de3dad336_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}\label{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+matrix\+\_\+width@{get\+\_\+matrix\+\_\+width}}
\index{get\+\_\+matrix\+\_\+width@{get\+\_\+matrix\+\_\+width}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+matrix\+\_\+width()}{get\_matrix\_width()}}
{\footnotesize\ttfamily int lbann\+::weights\+::get\+\_\+matrix\+\_\+width (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Get weight matrix width. If there are no matrix width dimensions, the width is one. 

Definition at line 254 of file weights.\+cpp.


\begin{DoxyCode}
254                                     \{
255   \textcolor{keyword}{const} \textcolor{keyword}{auto}& width\_dims = \hyperlink{classlbann_1_1weights_a783ce38ed0b75c0264dd7e28911d5ec0}{get\_matrix\_width\_dims}();
256   \textcolor{keywordflow}{return} std::accumulate(width\_dims.begin(), width\_dims.end(),
257                          1, std::multiplies<int>());
258 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a783ce38ed0b75c0264dd7e28911d5ec0}\label{classlbann_1_1weights_a783ce38ed0b75c0264dd7e28911d5ec0}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+matrix\+\_\+width\+\_\+dims@{get\+\_\+matrix\+\_\+width\+\_\+dims}}
\index{get\+\_\+matrix\+\_\+width\+\_\+dims@{get\+\_\+matrix\+\_\+width\+\_\+dims}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+matrix\+\_\+width\+\_\+dims()}{get\_matrix\_width\_dims()}}
{\footnotesize\ttfamily const std\+::vector$<$int$>$\& lbann\+::weights\+::get\+\_\+matrix\+\_\+width\+\_\+dims (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get tensor dimensions corresponding to weight matrix width. The dimensions are sorted in decreasing order of strides. Matrix columns are fully-\/packed w.\+r.\+t. the matrix width dimensions. 

Definition at line 136 of file weights.\+hpp.


\begin{DoxyCode}
136 \{ \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}{m\_matrix\_width\_dims}; \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a783ce38ed0b75c0264dd7e28911d5ec0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a783ce38ed0b75c0264dd7e28911d5ec0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a272f80766f31a5add7a970e5e8fcc352}\label{classlbann_1_1weights_a272f80766f31a5add7a970e5e8fcc352}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+name@{get\+\_\+name}}
\index{get\+\_\+name@{get\+\_\+name}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+name()}{get\_name()}}
{\footnotesize\ttfamily std\+::string lbann\+::weights\+::get\+\_\+name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get weights name. 

Definition at line 74 of file weights.\+hpp.


\begin{DoxyCode}
74 \{ \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name}; \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a272f80766f31a5add7a970e5e8fcc352_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_accdbbd16ada5b5b12890431b92c2e706}\label{classlbann_1_1weights_accdbbd16ada5b5b12890431b92c2e706}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+optimizer@{get\+\_\+optimizer}}
\index{get\+\_\+optimizer@{get\+\_\+optimizer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+optimizer()}{get\_optimizer()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1optimizer}{optimizer}$\ast$ lbann\+::weights\+::get\+\_\+optimizer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Get weights optimizer. 

Definition at line 160 of file weights.\+hpp.


\begin{DoxyCode}
160 \{ \textcolor{keywordflow}{return} (\hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\_frozen}? \textcolor{keyword}{nullptr} : \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}); \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_accdbbd16ada5b5b12890431b92c2e706_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a5754ec6534e1b47e2363c2848649f8a2}\label{classlbann_1_1weights_a5754ec6534e1b47e2363c2848649f8a2}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+optimizer@{get\+\_\+optimizer}}
\index{get\+\_\+optimizer@{get\+\_\+optimizer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+optimizer()}{get\_optimizer()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily const \hyperlink{classlbann_1_1optimizer}{optimizer}$\ast$ lbann\+::weights\+::get\+\_\+optimizer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get weights optimizer (const). 

Definition at line 162 of file weights.\+hpp.


\begin{DoxyCode}
162 \{ \textcolor{keywordflow}{return} (\hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\_frozen}? \textcolor{keyword}{nullptr} : \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}); \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a5754ec6534e1b47e2363c2848649f8a2_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a3216926df0aaf7aa440b9e5317d05fa2}\label{classlbann_1_1weights_a3216926df0aaf7aa440b9e5317d05fa2}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+size@{get\+\_\+size}}
\index{get\+\_\+size@{get\+\_\+size}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+size()}{get\_size()}}
{\footnotesize\ttfamily int lbann\+::weights\+::get\+\_\+size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get number of weights. 

Definition at line 125 of file weights.\+hpp.


\begin{DoxyCode}
125 \{ \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\_matrix\_height}() * \hyperlink{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}{get\_matrix\_width}(); \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a3216926df0aaf7aa440b9e5317d05fa2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a3216926df0aaf7aa440b9e5317d05fa2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b}\label{classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+values@{get\+\_\+values}}
\index{get\+\_\+values@{get\+\_\+values}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+values()}{get\_values()}}
{\footnotesize\ttfamily const \hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} \& lbann\+::weights\+::get\+\_\+values (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Get the weight matrix. 

Definition at line 270 of file weights.\+cpp.


\begin{DoxyCode}
270                                       \{
271 
272   \textcolor{comment}{// Check if weights matrix has been setup}
273   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} == \textcolor{keyword}{nullptr}) \{
274     std::stringstream err;
275     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
276         << \textcolor{stringliteral}{"attempted to access values of weights before they are setup"};
277     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
278   \}
279 
280 \textcolor{preprocessor}{  #ifdef LBANN\_HAS\_CUDNN}
281   \textcolor{comment}{// Copy weights matrix from GPU if needed}
282   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} != \textcolor{keyword}{nullptr}) \{
283     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->copy\_from\_gpu(0, \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->Matrix(), m\_values\_d[0]);
284     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->synchronize();
285   \}
286 \textcolor{preprocessor}{  #endif // LBANN\_HAS\_CUDNN}
287 
288   \textcolor{keywordflow}{return} *\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values};
289 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3}\label{classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3}} 
\index{lbann\+::weights@{lbann\+::weights}!get\+\_\+values\+\_\+view@{get\+\_\+values\+\_\+view}}
\index{get\+\_\+values\+\_\+view@{get\+\_\+values\+\_\+view}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{get\+\_\+values\+\_\+view()}{get\_values\_view()}}
{\footnotesize\ttfamily void lbann\+::weights\+::get\+\_\+values\+\_\+view (\begin{DoxyParamCaption}\item[{\hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} \&}]{values\+\_\+v }\end{DoxyParamCaption})}

Get a view into the weight matrix. If values\+\_\+v has a different matrix distribution than the weight matrix, the matrix values are copied into values\+\_\+v. 

Definition at line 414 of file weights.\+cpp.


\begin{DoxyCode}
414                                                   \{
415   \textcolor{keyword}{const} \hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{AbsDistMat}& values = \hyperlink{classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b}{get\_values}();
416   \textcolor{keywordflow}{if} (values.DistData() == values\_v.DistData()
417       && \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} == \textcolor{keyword}{nullptr}) \{
418     El::LockedView(values\_v, values);
419   \}
420   \textcolor{keywordflow}{else} \{
421 \textcolor{preprocessor}{    #ifdef LBANN\_HAS\_CUDNN}
422     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} != \textcolor{keyword}{nullptr}) \{
423       \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->copy\_from\_gpu(0, \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->Matrix(), m\_values\_d[0]);
424     \}
425 \textcolor{preprocessor}{    #endif // LBANN\_HAS\_CUDNN}
426     El::Copy(values, values\_v);
427   \}
428 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a5874876052191837679634186c64c388}\label{classlbann_1_1weights_a5874876052191837679634186c64c388}} 
\index{lbann\+::weights@{lbann\+::weights}!is\+\_\+frozen@{is\+\_\+frozen}}
\index{is\+\_\+frozen@{is\+\_\+frozen}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{is\+\_\+frozen()}{is\_frozen()}}
{\footnotesize\ttfamily bool lbann\+::weights\+::is\+\_\+frozen (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 194 of file weights.\+hpp.


\begin{DoxyCode}
194 \{ \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\_frozen}; \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a5874876052191837679634186c64c388_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c}\label{classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c}} 
\index{lbann\+::weights@{lbann\+::weights}!load\+\_\+from\+\_\+checkpoint\+\_\+shared@{load\+\_\+from\+\_\+checkpoint\+\_\+shared}}
\index{load\+\_\+from\+\_\+checkpoint\+\_\+shared@{load\+\_\+from\+\_\+checkpoint\+\_\+shared}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{load\+\_\+from\+\_\+checkpoint\+\_\+shared()}{load\_from\_checkpoint\_shared()}}
{\footnotesize\ttfamily bool lbann\+::weights\+::load\+\_\+from\+\_\+checkpoint\+\_\+shared (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1persist}{lbann\+::persist} \&}]{p }\end{DoxyParamCaption})}



Definition at line 507 of file weights.\+cpp.


\begin{DoxyCode}
508 \{
509   \textcolor{comment}{// define name to store our parameters}
510   \textcolor{keywordtype}{char} l\_name[512], f\_name[512];
511   sprintf(l\_name, \textcolor{stringliteral}{"weights\_%s\_%lldx%lld"}, \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name}.c\_str(), \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->Height(), 
      \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->Width());
512   sprintf(f\_name, \textcolor{stringliteral}{"%s.bin"}, l\_name);
513 
514   \textcolor{comment}{// read our weights from model file}
515   p.\hyperlink{classlbann_1_1persist_aa98be93f33b510e5b506b61de6bd79bd}{read\_distmat}(\hyperlink{namespacelbann_adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c}{persist\_type::model}, f\_name, (
      \hyperlink{base_8hpp_a0fab5387556805cfeac3e7e567bf66c5}{DistMat}*)\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values});
516 
517   \textcolor{comment}{// if loading training state, read in state of optimizer}
518   \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}->\hyperlink{classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9}{load\_from\_checkpoint\_shared}(p, l\_name);
519 
520   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
521 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ac1021a88dc4efe5f91a40fae223edf4b}\label{classlbann_1_1weights_ac1021a88dc4efe5f91a40fae223edf4b}} 
\index{lbann\+::weights@{lbann\+::weights}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1weights}{weights} \& lbann\+::weights\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1weights}{weights} \&}]{other }\end{DoxyParamCaption})}



Definition at line 81 of file weights.\+cpp.


\begin{DoxyCode}
81                                                 \{
82   \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name} = other.m\_name;
83   \hyperlink{classlbann_1_1weights_a223e8907034888392548ae901222b39c}{m\_comm} = other.m\_comm;
84   \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} = other.m\_cudnn;
85   \hyperlink{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}{m\_matrix\_height\_dims} = other.m\_matrix\_height\_dims;
86   \hyperlink{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}{m\_matrix\_width\_dims} = other.m\_matrix\_width\_dims;
87 
88   \textcolor{comment}{// Deep copies}
89   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} != \textcolor{keyword}{nullptr})      \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}; \}
90   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} != \textcolor{keyword}{nullptr}) \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}; \}
91   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} != \textcolor{keyword}{nullptr})   \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}; \}
92   \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} = other.m\_values;
93   \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} = other.m\_initializer;
94   \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} = other.m\_optimizer;
95   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} != \textcolor{keyword}{nullptr})      \{ \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} = \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->Copy(); \}
96   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} != \textcolor{keyword}{nullptr}) \{ \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} = 
      \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}->\hyperlink{classlbann_1_1weights__initializer_acc84ce49188b74b23987cef3db18525a}{copy}(); \}
97   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} != \textcolor{keyword}{nullptr})   \{ \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} = 
      \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}->\hyperlink{classlbann_1_1optimizer_adf19a1d19d832ebfe70072cc202cdf39}{copy}(); \}
98 
99 \textcolor{preprocessor}{  #ifdef LBANN\_HAS\_CUDNN}
100   \textcolor{comment}{// Copy GPU data}
101   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} != \textcolor{keyword}{nullptr}) \{
102     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->deallocate\_on\_gpus(m\_values\_d);
103     m\_values\_d = \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->copy(other.m\_values\_d,
104                                \hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\_matrix\_height}(),
105                                \hyperlink{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}{get\_matrix\_width}());
106   \}
107 \textcolor{preprocessor}{  #endif // LBANN\_HAS\_CUDNN}
108 
109   \hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\_frozen} = other.m\_frozen;
110 
111   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
112 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_ac1021a88dc4efe5f91a40fae223edf4b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4}\label{classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4}} 
\index{lbann\+::weights@{lbann\+::weights}!save\+\_\+to\+\_\+checkpoint\+\_\+shared@{save\+\_\+to\+\_\+checkpoint\+\_\+shared}}
\index{save\+\_\+to\+\_\+checkpoint\+\_\+shared@{save\+\_\+to\+\_\+checkpoint\+\_\+shared}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{save\+\_\+to\+\_\+checkpoint\+\_\+shared()}{save\_to\_checkpoint\_shared()}}
{\footnotesize\ttfamily bool lbann\+::weights\+::save\+\_\+to\+\_\+checkpoint\+\_\+shared (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1persist}{lbann\+::persist} \&}]{p }\end{DoxyParamCaption})}



Definition at line 457 of file weights.\+cpp.


\begin{DoxyCode}
458 \{
459   \textcolor{comment}{// define name to store our parameters}
460   \textcolor{keywordtype}{char} l\_name[512];
461   sprintf(l\_name, \textcolor{stringliteral}{"weights\_%s\_%lldx%lld"}, \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name}.c\_str(), \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->Height(), 
      \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->Width());
462 
463   \textcolor{comment}{// write out our weights to the model file}
464   p.\hyperlink{classlbann_1_1persist_a9170de652405d86d9ba9b3793f8781c6}{write\_distmat}(\hyperlink{namespacelbann_adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c}{persist\_type::model}, l\_name, (
      \hyperlink{base_8hpp_a0fab5387556805cfeac3e7e567bf66c5}{DistMat}*)\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values});
465   \textcolor{comment}{//}
466   \textcolor{comment}{// if saving training state, also write out state of optimizer}
467   \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}->\hyperlink{classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce}{save\_to\_checkpoint\_shared}(p, l\_name);
468 
469   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
470 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a71e56d32d8e9c0e3ddf0ec2d0cd3924d}\label{classlbann_1_1weights_a71e56d32d8e9c0e3ddf0ec2d0cd3924d}} 
\index{lbann\+::weights@{lbann\+::weights}!set\+\_\+initializer@{set\+\_\+initializer}}
\index{set\+\_\+initializer@{set\+\_\+initializer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{set\+\_\+initializer()}{set\_initializer()}}
{\footnotesize\ttfamily void lbann\+::weights\+::set\+\_\+initializer (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1weights__initializer}{weights\+\_\+initializer} $\ast$}]{initializer }\end{DoxyParamCaption})}

Set weights initializer. This takes ownership of the initializer and deallocates it during destruction. 

Definition at line 260 of file weights.\+cpp.


\begin{DoxyCode}
260                                                               \{
261   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} != \textcolor{keyword}{nullptr}) \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}; \}
262   \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer} = initializer;
263 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a71e56d32d8e9c0e3ddf0ec2d0cd3924d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ab886e4d3ff62b62a7ac6c52e391666f2}\label{classlbann_1_1weights_ab886e4d3ff62b62a7ac6c52e391666f2}} 
\index{lbann\+::weights@{lbann\+::weights}!set\+\_\+name@{set\+\_\+name}}
\index{set\+\_\+name@{set\+\_\+name}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{set\+\_\+name()}{set\_name()}}
{\footnotesize\ttfamily void lbann\+::weights\+::set\+\_\+name (\begin{DoxyParamCaption}\item[{const std\+::string}]{name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Set weights name. Each set of weights in a model should have a unique, human-\/readable name. 

Definition at line 72 of file weights.\+hpp.


\begin{DoxyCode}
72 \{ \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name} = name; \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_ab886e4d3ff62b62a7ac6c52e391666f2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ab641f66c09c8b5d491c0f262e8cb55e6}\label{classlbann_1_1weights_ab641f66c09c8b5d491c0f262e8cb55e6}} 
\index{lbann\+::weights@{lbann\+::weights}!set\+\_\+optimizer@{set\+\_\+optimizer}}
\index{set\+\_\+optimizer@{set\+\_\+optimizer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{set\+\_\+optimizer()}{set\_optimizer()}}
{\footnotesize\ttfamily void lbann\+::weights\+::set\+\_\+optimizer (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$}]{opt }\end{DoxyParamCaption})}

Set weights optimizer. This takes ownership of the optimizer and deallocates it during destruction. 

Definition at line 265 of file weights.\+cpp.


\begin{DoxyCode}
265                                           \{
266   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} != \textcolor{keyword}{nullptr}) \{ \textcolor{keyword}{delete} \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}; \}
267   \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} = opt;
268 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_ab641f66c09c8b5d491c0f262e8cb55e6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b}\label{classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b}} 
\index{lbann\+::weights@{lbann\+::weights}!set\+\_\+value@{set\+\_\+value}}
\index{set\+\_\+value@{set\+\_\+value}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{set\+\_\+value()}{set\_value()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void lbann\+::weights\+::set\+\_\+value (\begin{DoxyParamCaption}\item[{Data\+Type}]{value,  }\item[{int}]{index }\end{DoxyParamCaption})}

Set a weight value. 

Definition at line 314 of file weights.\+cpp.


\begin{DoxyCode}
314                                                  \{
315 
316 \textcolor{preprocessor}{#ifdef LBANN\_DEBUG}
317   \textcolor{comment}{// Check that tensor position is valid}
318   \textcolor{keyword}{const} \textcolor{keyword}{auto}& size = \hyperlink{classlbann_1_1weights_a3216926df0aaf7aa440b9e5317d05fa2}{get\_size}();
319   \textcolor{keywordflow}{if} (index < 0 || index >= size) \{
320     std::stringstream err;
321     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
322         << \textcolor{stringliteral}{"attempted to set weight value at index "} << index << \textcolor{stringliteral}{", "}
323         << \textcolor{stringliteral}{"but there are "} << size << \textcolor{stringliteral}{" values"};
324     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
325   \}
326 \textcolor{preprocessor}{#endif // LBANN\_DEBUG}
327 
328   \textcolor{comment}{// Set matrix entry}
329   \textcolor{keyword}{const} \textcolor{keyword}{auto}& height = \hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\_matrix\_height}();
330   \hyperlink{classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b}{set\_value}(value, index % height, index / height);
331 
332 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_aca05fb7e298c8f9f1f30fa1a8eac9fbf}\label{classlbann_1_1weights_aca05fb7e298c8f9f1f30fa1a8eac9fbf}} 
\index{lbann\+::weights@{lbann\+::weights}!set\+\_\+value@{set\+\_\+value}}
\index{set\+\_\+value@{set\+\_\+value}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{set\+\_\+value()}{set\_value()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void lbann\+::weights\+::set\+\_\+value (\begin{DoxyParamCaption}\item[{Data\+Type}]{value,  }\item[{std\+::vector$<$ int $>$}]{pos }\end{DoxyParamCaption})}

Set an entry in the weight tensor. 

Definition at line 334 of file weights.\+cpp.


\begin{DoxyCode}
334                                                           \{
335 
336   \textcolor{comment}{// Get tensor dimensions}
337   \textcolor{keyword}{const} \textcolor{keyword}{auto}& dims = \hyperlink{classlbann_1_1weights_ac1f4e6725fc8b265e0ed5dfe140a321a}{get\_dims}();
338 
339 \textcolor{preprocessor}{#ifdef LBANN\_DEBUG}
340   \textcolor{comment}{// Check that tensor position is valid}
341   \textcolor{keywordtype}{bool} pos\_is\_valid = \textcolor{keyword}{true};
342   \textcolor{keywordflow}{if} (dims.size() != pos.size()) \{
343     pos\_is\_valid = \textcolor{keyword}{false};
344   \} \textcolor{keywordflow}{else} \{
345     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0 ; i < dims.size(); ++i) \{
346       \textcolor{keywordflow}{if} (pos[i] < 0 || pos[i] >= dims[i]) \{ pos\_is\_valid = \textcolor{keyword}{false};\}
347     \}
348   \}
349   \textcolor{keywordflow}{if} (!pos\_is\_valid) \{
350     std::stringstream err;
351     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
352         << \textcolor{stringliteral}{"attempted to set weight value at position ("};
353     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0 ; i < pos.size(); ++i) \{
354       err << (i > 0 ? \textcolor{stringliteral}{"x"} : \textcolor{stringliteral}{""}) << pos[i];
355     \}
356     err << \textcolor{stringliteral}{") in a tensor with dimensions "};
357     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0 ; i < dims.size(); ++i) \{
358       err << (i > 0 ? \textcolor{stringliteral}{"x"} : \textcolor{stringliteral}{""}) << dims[i];
359     \}
360     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
361   \}
362 \textcolor{preprocessor}{#endif // LBANN\_DEBUG}
363 
364   \textcolor{comment}{// Get index of weight value and set}
365   \textcolor{keywordtype}{int} index = 0;
366   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < dims.size(); ++i) \{
367     index = index * dims[i] + pos[i];
368   \}
369   \hyperlink{classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b}{set\_value}(value, index);
370 
371 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_aca05fb7e298c8f9f1f30fa1a8eac9fbf_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a7ac0a9e53b249f16d5e2978e47bd6b7f}\label{classlbann_1_1weights_a7ac0a9e53b249f16d5e2978e47bd6b7f}} 
\index{lbann\+::weights@{lbann\+::weights}!set\+\_\+value@{set\+\_\+value}}
\index{set\+\_\+value@{set\+\_\+value}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{set\+\_\+value()}{set\_value()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void lbann\+::weights\+::set\+\_\+value (\begin{DoxyParamCaption}\item[{Data\+Type}]{value,  }\item[{int}]{row,  }\item[{int}]{col }\end{DoxyParamCaption})}

Set an entry in the weight matrix. 

Definition at line 373 of file weights.\+cpp.


\begin{DoxyCode}
373                                                         \{
374 
375 \textcolor{preprocessor}{#ifdef LBANN\_DEBUG}
376   \{
377     \textcolor{comment}{// Check that matrix entry is valid}
378     \textcolor{keyword}{const} \textcolor{keyword}{auto}& height = \hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\_matrix\_height}();
379     \textcolor{keyword}{const} \textcolor{keyword}{auto}& width = \hyperlink{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}{get\_matrix\_width}();
380     \textcolor{keywordflow}{if} (row < 0 || row >= height || col < 0 || col > width ) \{
381       std::stringstream err;
382       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
383           << \textcolor{stringliteral}{"attempted to set weights value at entry "}
384           << \textcolor{stringliteral}{"("} << row << \textcolor{stringliteral}{","} << col << \textcolor{stringliteral}{") "}
385           << \textcolor{stringliteral}{"in a "} << height << \textcolor{stringliteral}{"x"} << width << \textcolor{stringliteral}{" matrix"};
386       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
387     \}
388   \}
389 \textcolor{preprocessor}{#endif // LBANN\_DEBUG}
390 
391   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} == \textcolor{keyword}{nullptr}) \{
392     \textcolor{comment}{// Set value if it is local}
393     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->IsLocal(row, col)) \{
394       \textcolor{keyword}{const} El::Int local\_row = \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->LocalRow(row);
395       \textcolor{keyword}{const} El::Int local\_col = \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->LocalCol(col);
396       \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->SetLocal(local\_row, local\_col, value);
397     \}
398   \} \textcolor{keywordflow}{else} \{
399     \textcolor{comment}{// Set value on GPU}
400 \textcolor{preprocessor}{    #ifdef LBANN\_HAS\_CUDNN}
401     \hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} cpu\_value(1, 1);
402     cpu\_value(0, 0) = value;
403     std::vector<DataType*> gpu\_value = m\_values\_d;
404     \textcolor{keyword}{const} \textcolor{keywordtype}{int} height = \hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\_matrix\_height}();
405     \textcolor{keywordflow}{for} (DataType*& pointer : gpu\_value) \{
406       pointer += row + col * height;
407     \}
408     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->broadcast\_to\_gpus(gpu\_value, cpu\_value);
409 \textcolor{preprocessor}{    #endif // LBANN\_HAS\_CUDNN}
410   \}
411 
412 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a7ac0a9e53b249f16d5e2978e47bd6b7f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ae10da5d92c9402ced7e55f04fbd05a2e}\label{classlbann_1_1weights_ae10da5d92c9402ced7e55f04fbd05a2e}} 
\index{lbann\+::weights@{lbann\+::weights}!set\+\_\+values@{set\+\_\+values}}
\index{set\+\_\+values@{set\+\_\+values}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{set\+\_\+values()}{set\_values()}}
{\footnotesize\ttfamily void lbann\+::weights\+::set\+\_\+values (\begin{DoxyParamCaption}\item[{const \hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat} \&}]{values }\end{DoxyParamCaption})}

Set the weight matrix. 

Definition at line 291 of file weights.\+cpp.


\begin{DoxyCode}
291                                                  \{
292 
293   \textcolor{comment}{// Check if weights matrix has been setup}
294   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} == \textcolor{keyword}{nullptr}) \{
295     std::stringstream err;
296     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
297         << \textcolor{stringliteral}{"attempted to set values of weights before they are setup"};
298     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
299   \}
300 
301   \textcolor{comment}{// Copy input to weights matrix}
302   El::Copy(values, *\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values});
303 
304 \textcolor{preprocessor}{  #ifdef LBANN\_HAS\_CUDNN}
305   \textcolor{comment}{// Copy weights matrix to GPU if needed}
306   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} != \textcolor{keyword}{nullptr}) \{
307     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->broadcast\_to\_gpus(m\_values\_d, \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->LockedMatrix());
308     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->synchronize();
309   \}
310 \textcolor{preprocessor}{  #endif // LBANN\_HAS\_CUDNN}
311 
312 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{classlbann_1_1weights_ae10da5d92c9402ced7e55f04fbd05a2e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5}\label{classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5}} 
\index{lbann\+::weights@{lbann\+::weights}!setup@{setup}}
\index{setup@{setup}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{setup()}{setup()}\hspace{0.1cm}{\footnotesize\ttfamily [1/4]}}
{\footnotesize\ttfamily void lbann\+::weights\+::setup (\begin{DoxyParamCaption}\item[{int}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Setup weights as a vector. The weight matrix is setup as a (size x 1) matrix in S\+T\+AR,S\+T\+AR format. 

Definition at line 120 of file weights.\+cpp.


\begin{DoxyCode}
120                             \{
121   \hyperlink{classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5}{setup}(std::vector<int>(1, size), std::vector<int>(), El::STAR, El::STAR);
122 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a64037919e22272a8931da328f0b2494a}\label{classlbann_1_1weights_a64037919e22272a8931da328f0b2494a}} 
\index{lbann\+::weights@{lbann\+::weights}!setup@{setup}}
\index{setup@{setup}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{setup()}{setup()}\hspace{0.1cm}{\footnotesize\ttfamily [2/4]}}
{\footnotesize\ttfamily void lbann\+::weights\+::setup (\begin{DoxyParamCaption}\item[{std\+::vector$<$ int $>$}]{dims }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Setup weights as a tensor. The weight matrix is setup as a (prod(dims) x 1) matrix in S\+T\+AR,S\+T\+AR format. 

Definition at line 124 of file weights.\+cpp.


\begin{DoxyCode}
124                                               \{
125   \hyperlink{classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5}{setup}(tensor\_dims, std::vector<int>(), El::STAR, El::STAR);
126 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{classlbann_1_1weights_a64037919e22272a8931da328f0b2494a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_aacf5c30b815e2f1c47a33043e440ed65}\label{classlbann_1_1weights_aacf5c30b815e2f1c47a33043e440ed65}} 
\index{lbann\+::weights@{lbann\+::weights}!setup@{setup}}
\index{setup@{setup}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{setup()}{setup()}\hspace{0.1cm}{\footnotesize\ttfamily [3/4]}}
{\footnotesize\ttfamily void lbann\+::weights\+::setup (\begin{DoxyParamCaption}\item[{int}]{matrix\+\_\+height,  }\item[{int}]{matrix\+\_\+width,  }\item[{El\+::\+Distribution}]{col\+\_\+dist,  }\item[{El\+::\+Distribution}]{row\+\_\+dist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Setup weights as a matrix. The weight matrix is setup as a (matrix\+\_\+height x matrix\+\_\+width) matrix in col\+\_\+dist,row\+\_\+dist format. 

Definition at line 128 of file weights.\+cpp.


\begin{DoxyCode}
131                                              \{
132   \hyperlink{classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5}{setup}(std::vector<int>(1, matrix\_height),
133         std::vector<int>(1, matrix\_width),
134         col\_dist, row\_dist);
135 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{classlbann_1_1weights_aacf5c30b815e2f1c47a33043e440ed65_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a32a8395709a5238ca93d4b4f102cdc12}\label{classlbann_1_1weights_a32a8395709a5238ca93d4b4f102cdc12}} 
\index{lbann\+::weights@{lbann\+::weights}!setup@{setup}}
\index{setup@{setup}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{setup()}{setup()}\hspace{0.1cm}{\footnotesize\ttfamily [4/4]}}
{\footnotesize\ttfamily void lbann\+::weights\+::setup (\begin{DoxyParamCaption}\item[{std\+::vector$<$ int $>$}]{matrix\+\_\+height\+\_\+dims,  }\item[{std\+::vector$<$ int $>$}]{matrix\+\_\+width\+\_\+dims,  }\item[{El\+::\+Distribution}]{col\+\_\+dist,  }\item[{El\+::\+Distribution}]{row\+\_\+dist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Setup weights as a matrix with tensor dimensions. The weight matrix is setup as a (prod(matrix\+\_\+height\+\_\+dims) x prod(matrix\+\_\+width\+\_\+dims)) matrix in col\+\_\+dist,row\+\_\+dist format. 

Definition at line 137 of file weights.\+cpp.


\begin{DoxyCode}
140                                              \{
141 
142   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} != \textcolor{keyword}{nullptr}) \{
143     \textcolor{comment}{// Check that dimensions are unchanged if weights are already}
144     \textcolor{comment}{// initialized}
145     \textcolor{keyword}{const} El::DistData dist\_data(*\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values});
146     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}{m\_matrix\_height\_dims} == matrix\_height\_dims
147         && \hyperlink{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}{m\_matrix\_width\_dims} == matrix\_width\_dims
148         && dist\_data.colDist == col\_dist
149         && dist\_data.rowDist == row\_dist) \{
150       \textcolor{keywordflow}{return};
151     \} \textcolor{keywordflow}{else} \{
152       std::stringstream err;
153       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
154           << \textcolor{stringliteral}{"attempted to setup "} << \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name} << \textcolor{stringliteral}{" as a "}
155           << \hyperlink{classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752}{get\_dims\_string}(matrix\_height\_dims, matrix\_width\_dims) << \textcolor{stringliteral}{" "}
156           << \textcolor{stringliteral}{"weights matrix with "}
157           << \textcolor{stringliteral}{"col\_dist="} << col\_dist << \textcolor{stringliteral}{", "}
158           << \textcolor{stringliteral}{"row\_dist="} << row\_dist << \textcolor{stringliteral}{", "}
159           << \textcolor{stringliteral}{"but it is already setup as a "}
160           << \hyperlink{classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752}{get\_dims\_string}(\hyperlink{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}{m\_matrix\_height\_dims}, 
      \hyperlink{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}{m\_matrix\_width\_dims}) << \textcolor{stringliteral}{" "}
161           << \textcolor{stringliteral}{"matrix with "}
162           << \textcolor{stringliteral}{"col\_dist="} << dist\_data.colDist << \textcolor{stringliteral}{", "}
163           << \textcolor{stringliteral}{"row\_dist="} << dist\_data.rowDist;
164       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
165     \}
166   \} \textcolor{keywordflow}{else} \{
167     \textcolor{comment}{// Check that tensor dimensions are valid}
168     \textcolor{keywordtype}{bool} dims\_are\_valid = \textcolor{keyword}{true};
169     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& d : matrix\_height\_dims) \{
170       \textcolor{keywordflow}{if} (d <= 0) \{ dims\_are\_valid = \textcolor{keyword}{false}; \}
171     \}
172     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& d : matrix\_width\_dims) \{
173       \textcolor{keywordflow}{if} (d <= 0) \{ dims\_are\_valid = \textcolor{keyword}{false}; \}
174     \}
175     \textcolor{keywordflow}{if} (!dims\_are\_valid) \{
176       std::stringstream err;
177       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
178           << \textcolor{stringliteral}{"attempted to setup "} << \hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name} << \textcolor{stringliteral}{" as a "}
179           << \hyperlink{classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752}{get\_dims\_string}(matrix\_height\_dims, matrix\_width\_dims) << \textcolor{stringliteral}{" "}
180           << \textcolor{stringliteral}{"weights matrix"};
181       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
182     \}
183   \}
184 
185   \textcolor{comment}{// Initialize weights matrix}
186   \hyperlink{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}{m\_matrix\_height\_dims} = matrix\_height\_dims;
187   \hyperlink{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}{m\_matrix\_width\_dims} = matrix\_width\_dims;
188   \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} = \hyperlink{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}{m\_initializer}->\hyperlink{classlbann_1_1weights__initializer_a693fd517e4162029eafdfdee537c7066}{construct\_matrix}(
      \hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\_matrix\_height}(),
189                                              \hyperlink{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}{get\_matrix\_width}(),
190                                              col\_dist,
191                                              row\_dist);
192 
193   \textcolor{comment}{// Setup GPU objects}
194   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} != \textcolor{keyword}{nullptr}) \{
195     \hyperlink{classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7}{setup\_gpu}();
196   \}
197 
198   \textcolor{comment}{// Setup optimizer}
199   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer} != \textcolor{keyword}{nullptr}) \{
200     \hyperlink{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}{m\_optimizer}->\hyperlink{classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b}{setup}(*\textcolor{keyword}{this});
201   \}
202 
203 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a32a8395709a5238ca93d4b4f102cdc12_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7}\label{classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7}} 
\index{lbann\+::weights@{lbann\+::weights}!setup\+\_\+gpu@{setup\+\_\+gpu}}
\index{setup\+\_\+gpu@{setup\+\_\+gpu}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{setup\+\_\+gpu()}{setup\_gpu()}}
{\footnotesize\ttfamily void lbann\+::weights\+::setup\+\_\+gpu (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}

Setup G\+PU objects for weights. 

Definition at line 205 of file weights.\+cpp.


\begin{DoxyCode}
205                         \{
206 \textcolor{preprocessor}{  #ifndef LBANN\_HAS\_CUDNN}
207   std::stringstream err;
208   err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "} << \textcolor{stringliteral}{"cuDNN not detected"};
209   \textcolor{keywordflow}{throw} lbann\_exception(err.str());
210 \textcolor{preprocessor}{  #else}
211 
212   \textcolor{comment}{// Check that weights matrix is valid}
213   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values} == \textcolor{keyword}{nullptr}) \{
214     std::stringstream err;
215     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
216         << \textcolor{stringliteral}{"attempted to setup GPU weights matrix "}
217         << \textcolor{stringliteral}{"before initializing CPU weights matrix"};
218     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
219   \}
220 
221   \textcolor{comment}{// Disable GPU if weights matrix is not STAR,STAR}
223 \textcolor{comment}{}  \textcolor{keyword}{const} El::DistData dist\_data(*\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values});
224   \textcolor{keywordflow}{if} (dist\_data.colDist != El::STAR || dist\_data.rowDist != El::STAR) \{
225     \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn} = \textcolor{keyword}{nullptr};
226     \textcolor{keywordflow}{return};
227   \}
228 
229   \textcolor{comment}{// Copy weights matrix to GPU}
230   \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->allocate\_on\_gpus(m\_values\_d,
231                             \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->LocalHeight(),
232                             \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->LocalWidth());
233   \hyperlink{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}{m\_cudnn}->broadcast\_to\_gpus(m\_values\_d, \hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}->LockedMatrix());
234 
235 \textcolor{preprocessor}{  #endif // LBANN\_HAS\_CUDNN}
236 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1weights_ab1e71f962a7702d0aa023fedf1c99e98}\label{classlbann_1_1weights_ab1e71f962a7702d0aa023fedf1c99e98}} 
\index{lbann\+::weights@{lbann\+::weights}!unfreeze@{unfreeze}}
\index{unfreeze@{unfreeze}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{unfreeze()}{unfreeze()}}
{\footnotesize\ttfamily void lbann\+::weights\+::unfreeze (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 193 of file weights.\+hpp.


\begin{DoxyCode}
193 \{ \hyperlink{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}{m\_frozen} = \textcolor{keyword}{false}; \}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1weights_a1a2631987f38d32a90fbee61053a04cc}\label{classlbann_1_1weights_a1a2631987f38d32a90fbee61053a04cc}} 
\index{lbann\+::weights@{lbann\+::weights}!write\+\_\+proto@{write\+\_\+proto}}
\index{write\+\_\+proto@{write\+\_\+proto}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{write\+\_\+proto()}{write\_proto()}}
{\footnotesize\ttfamily void lbann\+::weights\+::write\+\_\+proto (\begin{DoxyParamCaption}\item[{lbann\+\_\+data\+::\+Weights\+Data $\ast$}]{proto }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}

Write weights to proto file \begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000011}{Todo}]What if weights are on G\+PU? \end{DoxyRefDesc}


\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000012}{Todo}]What if world master is not process 0? \end{DoxyRefDesc}


\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000013}{Todo}]Open\+MP parallelization \end{DoxyRefDesc}


\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000014}{Todo}]Our matrices are column-\/major while Numpy expects row-\/major matrices. This row-\/wise iteration is fine for matrices and column vectors, but it can mess up the order of the weights if a high-\/dimensional tensor is represented as a matrix. This is what we need for quantization on convolution kernel weights. \end{DoxyRefDesc}


Definition at line 472 of file weights.\+cpp.


\begin{DoxyCode}
472                                                             \{
473 
474   \textcolor{comment}{// Set proto properties}
475   proto->Clear();
476   proto->set\_name(\hyperlink{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}{m\_name});
477   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& d : \hyperlink{classlbann_1_1weights_ac1f4e6725fc8b265e0ed5dfe140a321a}{get\_dims}()) \{
478     proto->mutable\_shape()->add\_dim(d);
479   \}
480   proto->set\_height(\hyperlink{classlbann_1_1weights_ad36676b9b43bced1cc7e332e3745411f}{get\_matrix\_height}());
481   proto->set\_width(\hyperlink{classlbann_1_1weights_abc3cf3a5b992302b1eaaea1fdf3b377d}{get\_matrix\_width}());
482 
483   \textcolor{comment}{// Write weight values to prototext on world master process}
484   \hyperlink{base_8hpp_a48abd140bc807a8ac1381efd1bfeb375}{CircMat} values = *\hyperlink{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}{m\_values}; 
485   values.SetRoot(0); 
486   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1weights_a223e8907034888392548ae901222b39c}{m\_comm}->\hyperlink{classlbann_1_1lbann__comm_a1ef526486183a29feadca9bef096a534}{am\_world\_master}()) \{
487     \textcolor{keyword}{const} \textcolor{keyword}{auto}& local\_values = values.LockedMatrix();
488     \textcolor{keyword}{const} El::Int height = local\_values.Height();
489     \textcolor{keyword}{const} El::Int width = local\_values.Width();
491 
498     \textcolor{keywordflow}{for} (El::Int i = 0; i < height; ++i) \{
499       \textcolor{keywordflow}{for} (El::Int j = 0; j < width; ++j) \{
500         proto->add\_data(local\_values(i,j));
501       \}
502     \}
503   \}
504 
505 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1weights_a1a2631987f38d32a90fbee61053a04cc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{classlbann_1_1weights_a1a2631987f38d32a90fbee61053a04cc_icgraph}
\end{center}
\end{figure}


\subsection{Friends And Related Function Documentation}
\mbox{\Hypertarget{classlbann_1_1weights_afe38b5936c7fe885023474dd92c72c67}\label{classlbann_1_1weights_afe38b5936c7fe885023474dd92c72c67}} 
\index{lbann\+::weights@{lbann\+::weights}!optimizer@{optimizer}}
\index{optimizer@{optimizer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{optimizer}{optimizer}}
{\footnotesize\ttfamily friend class \hyperlink{classlbann_1_1optimizer}{optimizer}\hspace{0.3cm}{\ttfamily [friend]}}



Definition at line 59 of file weights.\+hpp.



\subsection{Member Data Documentation}
\mbox{\Hypertarget{classlbann_1_1weights_a223e8907034888392548ae901222b39c}\label{classlbann_1_1weights_a223e8907034888392548ae901222b39c}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+comm@{m\+\_\+comm}}
\index{m\+\_\+comm@{m\+\_\+comm}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+comm}{m\_comm}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm}$\ast$ lbann\+::weights\+::m\+\_\+comm\hspace{0.3cm}{\ttfamily [private]}}

Reference to L\+B\+A\+NN communicator. 

Definition at line 209 of file weights.\+hpp.

\mbox{\Hypertarget{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}\label{classlbann_1_1weights_a873e8c14998915e442d03b8dd7d2fdf7}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+cudnn@{m\+\_\+cudnn}}
\index{m\+\_\+cudnn@{m\+\_\+cudnn}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+cudnn}{m\_cudnn}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1cudnn_1_1cudnn__manager}{cudnn\+::cudnn\+\_\+manager}$\ast$ lbann\+::weights\+::m\+\_\+cudnn\hspace{0.3cm}{\ttfamily [private]}}

Reference to cu\+D\+NN manager. 

Definition at line 211 of file weights.\+hpp.

\mbox{\Hypertarget{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}\label{classlbann_1_1weights_a3962305112ba98ef2eb89c6f7035f6dd}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+frozen@{m\+\_\+frozen}}
\index{m\+\_\+frozen@{m\+\_\+frozen}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+frozen}{m\_frozen}}
{\footnotesize\ttfamily bool lbann\+::weights\+::m\+\_\+frozen\hspace{0.3cm}{\ttfamily [private]}}

Avoid weight update if frozen 

Definition at line 240 of file weights.\+hpp.

\mbox{\Hypertarget{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}\label{classlbann_1_1weights_a3ddbcce8d543e975efeebdb43e82444c}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+initializer@{m\+\_\+initializer}}
\index{m\+\_\+initializer@{m\+\_\+initializer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+initializer}{m\_initializer}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1weights__initializer}{weights\+\_\+initializer}$\ast$ lbann\+::weights\+::m\+\_\+initializer = nullptr\hspace{0.3cm}{\ttfamily [private]}}

Weights initializer. Default is zero initialization. 

Definition at line 228 of file weights.\+hpp.

\mbox{\Hypertarget{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}\label{classlbann_1_1weights_a9287dfbd8a7e4a9f5e0d6371d43ee92f}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+matrix\+\_\+height\+\_\+dims@{m\+\_\+matrix\+\_\+height\+\_\+dims}}
\index{m\+\_\+matrix\+\_\+height\+\_\+dims@{m\+\_\+matrix\+\_\+height\+\_\+dims}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+matrix\+\_\+height\+\_\+dims}{m\_matrix\_height\_dims}}
{\footnotesize\ttfamily std\+::vector$<$int$>$ lbann\+::weights\+::m\+\_\+matrix\+\_\+height\+\_\+dims\hspace{0.3cm}{\ttfamily [private]}}

Tensor dimensions corresponding to matrix height. See get\+\_\+matrix\+\_\+height\+\_\+dims function. 

Definition at line 216 of file weights.\+hpp.

\mbox{\Hypertarget{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}\label{classlbann_1_1weights_a8317a198bc5b4cd6bee2c806eefd1f12}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+matrix\+\_\+width\+\_\+dims@{m\+\_\+matrix\+\_\+width\+\_\+dims}}
\index{m\+\_\+matrix\+\_\+width\+\_\+dims@{m\+\_\+matrix\+\_\+width\+\_\+dims}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+matrix\+\_\+width\+\_\+dims}{m\_matrix\_width\_dims}}
{\footnotesize\ttfamily std\+::vector$<$int$>$ lbann\+::weights\+::m\+\_\+matrix\+\_\+width\+\_\+dims\hspace{0.3cm}{\ttfamily [private]}}

Tensor dimensions corresponding to matrix width. See get\+\_\+matrix\+\_\+width\+\_\+dims function. 

Definition at line 220 of file weights.\+hpp.

\mbox{\Hypertarget{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}\label{classlbann_1_1weights_a08abf0bb29aa47be21bfc7473b4b9b99}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+name@{m\+\_\+name}}
\index{m\+\_\+name@{m\+\_\+name}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+name}{m\_name}}
{\footnotesize\ttfamily std\+::string lbann\+::weights\+::m\+\_\+name\hspace{0.3cm}{\ttfamily [private]}}

Weights name. See get\+\_\+name function. 

Definition at line 206 of file weights.\+hpp.

\mbox{\Hypertarget{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}\label{classlbann_1_1weights_a5f3b4d4a3ad390c2a9bdbe6c4971de65}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+optimizer@{m\+\_\+optimizer}}
\index{m\+\_\+optimizer@{m\+\_\+optimizer}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+optimizer}{m\_optimizer}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1optimizer}{optimizer}$\ast$ lbann\+::weights\+::m\+\_\+optimizer = nullptr\hspace{0.3cm}{\ttfamily [private]}}

Weights optimizer. Default is nullptr, which corresponds to no optimizer. 

Definition at line 232 of file weights.\+hpp.

\mbox{\Hypertarget{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}\label{classlbann_1_1weights_a6b2df671b6d4c4dd595477971eea0543}} 
\index{lbann\+::weights@{lbann\+::weights}!m\+\_\+values@{m\+\_\+values}}
\index{m\+\_\+values@{m\+\_\+values}!lbann\+::weights@{lbann\+::weights}}
\subsubsection{\texorpdfstring{m\+\_\+values}{m\_values}}
{\footnotesize\ttfamily \hyperlink{base_8hpp_a9a697a504ae84010e7439ffec862b470}{Abs\+Dist\+Mat}$\ast$ lbann\+::weights\+::m\+\_\+values = nullptr\hspace{0.3cm}{\ttfamily [private]}}

Weights matrix. 

Definition at line 223 of file weights.\+hpp.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/weights/\hyperlink{weights_8hpp}{weights.\+hpp}\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/src/weights/\hyperlink{weights_8cpp}{weights.\+cpp}\end{DoxyCompactItemize}
