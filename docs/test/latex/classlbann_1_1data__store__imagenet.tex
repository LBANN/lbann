\hypertarget{classlbann_1_1data__store__imagenet}{}\section{lbann\+:\+:data\+\_\+store\+\_\+imagenet Class Reference}
\label{classlbann_1_1data__store__imagenet}\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}


{\ttfamily \#include $<$data\+\_\+store\+\_\+imagenet.\+hpp$>$}



Inheritance diagram for lbann\+:\+:data\+\_\+store\+\_\+imagenet\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for lbann\+:\+:data\+\_\+store\+\_\+imagenet\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1data__store__imagenet_a3040285850664ccecb4795df3c85fb8d}{data\+\_\+store\+\_\+imagenet} (\hyperlink{classlbann_1_1generic__data__reader}{generic\+\_\+data\+\_\+reader} $\ast$reader, \hyperlink{classlbann_1_1model}{model} $\ast$m)
\begin{DoxyCompactList}\small\item\em ctor \end{DoxyCompactList}\item 
\hyperlink{classlbann_1_1data__store__imagenet_abca3c81df8f4cd1c53f9b5b474da0481}{data\+\_\+store\+\_\+imagenet} (const \hyperlink{classlbann_1_1data__store__imagenet}{data\+\_\+store\+\_\+imagenet} \&)=default
\begin{DoxyCompactList}\small\item\em copy ctor \end{DoxyCompactList}\item 
\hyperlink{classlbann_1_1data__store__imagenet}{data\+\_\+store\+\_\+imagenet} \& \hyperlink{classlbann_1_1data__store__imagenet_a71b04726b0e651bc9b73cd6f5ca3c12b}{operator=} (const \hyperlink{classlbann_1_1data__store__imagenet}{data\+\_\+store\+\_\+imagenet} \&)=default
\begin{DoxyCompactList}\small\item\em operator= \end{DoxyCompactList}\item 
\hyperlink{classlbann_1_1data__store__imagenet}{data\+\_\+store\+\_\+imagenet} $\ast$ \hyperlink{classlbann_1_1data__store__imagenet_ae3b0d31ac020c36f41766999288e2d25}{copy} () const override
\item 
\hyperlink{classlbann_1_1data__store__imagenet_aa6f4479472b06cd7a8da399dd23b7487}{$\sim$data\+\_\+store\+\_\+imagenet} () override
\begin{DoxyCompactList}\small\item\em dtor \end{DoxyCompactList}\item 
void \hyperlink{classlbann_1_1data__store__imagenet_a611aa1734a491c443396a077b49fe4fe}{setup} () override
\begin{DoxyCompactList}\small\item\em called by \hyperlink{classlbann_1_1generic__data__reader_a8b2a09d38512fc11f1b9d572c89100a7}{generic\+\_\+data\+\_\+reader\+::setup\+\_\+data\+\_\+store} \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classlbann_1_1data__store__imagenet_ae8f5d8741ddd762ffd3a477504bca619}{get\+\_\+file\+\_\+sizes} () override
\begin{DoxyCompactList}\small\item\em fills in m\+\_\+file\+\_\+sizes \end{DoxyCompactList}\item 
virtual void \hyperlink{classlbann_1_1data__store__imagenet_a1ed5548a409afec61489102f7f080467}{test\+\_\+data} ()
\begin{DoxyCompactList}\small\item\em for use during development and testing \end{DoxyCompactList}\item 
void \hyperlink{classlbann_1_1data__store__imagenet_a1c928ccfb4e75ffe4cefd62f37c072f8}{test\+\_\+file\+\_\+sizes} ()
\begin{DoxyCompactList}\small\item\em for use during development and testing \end{DoxyCompactList}\item 
void \hyperlink{classlbann_1_1data__store__imagenet_a70cfd8f529aad8d66993000da7350ec5}{read\+\_\+files} () override
\begin{DoxyCompactList}\small\item\em reads all files assigned to this processor into memory (m\+\_\+data) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
todo 

Definition at line 39 of file data\+\_\+store\+\_\+imagenet.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_a3040285850664ccecb4795df3c85fb8d}\label{classlbann_1_1data__store__imagenet_a3040285850664ccecb4795df3c85fb8d}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!data\+\_\+store\+\_\+imagenet@{data\+\_\+store\+\_\+imagenet}}
\index{data\+\_\+store\+\_\+imagenet@{data\+\_\+store\+\_\+imagenet}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{data\+\_\+store\+\_\+imagenet()}{data\_store\_imagenet()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily lbann\+::data\+\_\+store\+\_\+imagenet\+::data\+\_\+store\+\_\+imagenet (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1generic__data__reader}{generic\+\_\+data\+\_\+reader} $\ast$}]{reader,  }\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



ctor 



Definition at line 43 of file data\+\_\+store\+\_\+imagenet.\+hpp.


\begin{DoxyCode}
43                                                              :
44     \hyperlink{classlbann_1_1data__store__image_a8fd8c5546f405a964511823aed8ac986}{data\_store\_image}(reader, m) \{\}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a3040285850664ccecb4795df3c85fb8d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a3040285850664ccecb4795df3c85fb8d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_abca3c81df8f4cd1c53f9b5b474da0481}\label{classlbann_1_1data__store__imagenet_abca3c81df8f4cd1c53f9b5b474da0481}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!data\+\_\+store\+\_\+imagenet@{data\+\_\+store\+\_\+imagenet}}
\index{data\+\_\+store\+\_\+imagenet@{data\+\_\+store\+\_\+imagenet}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{data\+\_\+store\+\_\+imagenet()}{data\_store\_imagenet()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily lbann\+::data\+\_\+store\+\_\+imagenet\+::data\+\_\+store\+\_\+imagenet (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1data__store__imagenet}{data\+\_\+store\+\_\+imagenet} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



copy ctor 

\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_aa6f4479472b06cd7a8da399dd23b7487}\label{classlbann_1_1data__store__imagenet_aa6f4479472b06cd7a8da399dd23b7487}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!````~data\+\_\+store\+\_\+imagenet@{$\sim$data\+\_\+store\+\_\+imagenet}}
\index{````~data\+\_\+store\+\_\+imagenet@{$\sim$data\+\_\+store\+\_\+imagenet}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{$\sim$data\+\_\+store\+\_\+imagenet()}{~data\_store\_imagenet()}}
{\footnotesize\ttfamily lbann\+::data\+\_\+store\+\_\+imagenet\+::$\sim$data\+\_\+store\+\_\+imagenet (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}}



dtor 



Definition at line 55 of file data\+\_\+store\+\_\+imagenet.\+hpp.


\begin{DoxyCode}
55 \{\};
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_aa6f4479472b06cd7a8da399dd23b7487_cgraph}
\end{center}
\end{figure}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_ae3b0d31ac020c36f41766999288e2d25}\label{classlbann_1_1data__store__imagenet_ae3b0d31ac020c36f41766999288e2d25}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!copy@{copy}}
\index{copy@{copy}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1data__store__imagenet}{data\+\_\+store\+\_\+imagenet}$\ast$ lbann\+::data\+\_\+store\+\_\+imagenet\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \hyperlink{classlbann_1_1data__store__image_ab62efcb2dbe3118bf2815fa5d51fee61}{lbann\+::data\+\_\+store\+\_\+image}.



Reimplemented in \hyperlink{classlbann_1_1data__store__multi__images_a1046efda9448bab9b42e9fcdf71e03f1}{lbann\+::data\+\_\+store\+\_\+multi\+\_\+images}, \hyperlink{classlbann_1_1data__store__triplet_a446ee3b1fa3097e51bd0e198de960cd4}{lbann\+::data\+\_\+store\+\_\+triplet}, and \hyperlink{classlbann_1_1data__store__imagenet__patches_a5067e8299f5cf073497a5005ee9db759}{lbann\+::data\+\_\+store\+\_\+imagenet\+\_\+patches}.



Definition at line 52 of file data\+\_\+store\+\_\+imagenet.\+hpp.


\begin{DoxyCode}
52 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{new} \hyperlink{classlbann_1_1data__store__imagenet_a3040285850664ccecb4795df3c85fb8d}{data\_store\_imagenet}(*\textcolor{keyword}{this}); \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_ae3b0d31ac020c36f41766999288e2d25_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_ae8f5d8741ddd762ffd3a477504bca619}\label{classlbann_1_1data__store__imagenet_ae8f5d8741ddd762ffd3a477504bca619}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!get\+\_\+file\+\_\+sizes@{get\+\_\+file\+\_\+sizes}}
\index{get\+\_\+file\+\_\+sizes@{get\+\_\+file\+\_\+sizes}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{get\+\_\+file\+\_\+sizes()}{get\_file\_sizes()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+imagenet\+::get\+\_\+file\+\_\+sizes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



fills in m\+\_\+file\+\_\+sizes 



Implements \hyperlink{classlbann_1_1data__store__image_a8694bc9157c5fdc80bb5c251e68e18cb}{lbann\+::data\+\_\+store\+\_\+image}.



Reimplemented in \hyperlink{classlbann_1_1data__store__multi__images_a25963dfa7d6de983e7b250f8ef7e2a0e}{lbann\+::data\+\_\+store\+\_\+multi\+\_\+images}.



Definition at line 177 of file data\+\_\+store\+\_\+imagenet.\+cpp.


\begin{DoxyCode}
177                                          \{
178   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) std::cerr << \textcolor{stringliteral}{"starting data\_store\_imagenet::get\_file\_sizes\(\backslash\)n"};
179   image\_data\_reader *reader = \textcolor{keyword}{dynamic\_cast<}image\_data\_reader*\textcolor{keyword}{>}(\hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader});
180   \textcolor{keyword}{const} std::vector<std::pair<std::string, int> > & image\_list = reader->get\_image\_list();
181   \textcolor{comment}{//construct a vector of Triples }
182   std::vector<Triple> my\_file\_sizes(\hyperlink{classlbann_1_1generic__data__store_abd38f8d8aab0648959e09d011abfe20a}{m\_my\_datastore\_indices}.size());
183   \textcolor{keywordtype}{size\_t} cur\_offset = 0;
184   \textcolor{keywordtype}{size\_t} j = 0;
185   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} index : \hyperlink{classlbann_1_1generic__data__store_abd38f8d8aab0648959e09d011abfe20a}{m\_my\_datastore\_indices}) \{
186     my\_file\_sizes[j].global\_index = index;
187     my\_file\_sizes[j].num\_bytes = \hyperlink{classlbann_1_1generic__data__store_a7641d15eba63426acf5071acb8026442}{get\_file\_size}(\hyperlink{classlbann_1_1generic__data__store_ab479c127f00ce550c7433b90e40a5a3d}{m\_dir}, image\_list[index].first);
188     my\_file\_sizes[j].offset = cur\_offset;
189     my\_file\_sizes[j].rank = \hyperlink{classlbann_1_1generic__data__store_a87695bfd2d1ed0dbe01d99108e3f68b7}{m\_rank};
190     cur\_offset += my\_file\_sizes[j].num\_bytes;
191     \textcolor{keywordflow}{if} (my\_file\_sizes[j].num\_bytes == 0) \{
192       std::stringstream err;
193       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "} << \textcolor{stringliteral}{" j: "} << j 
194         << \textcolor{stringliteral}{" file size is 0 ("} << \hyperlink{classlbann_1_1generic__data__store_ab479c127f00ce550c7433b90e40a5a3d}{m\_dir} << \textcolor{stringliteral}{"/"} + image\_list[index].first;
195       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
196     \}
197     ++j;
198   \}
199 
200   \hyperlink{classlbann_1_1data__store__image_a477529f2ba3f86598bbd409d3c2b6901}{exchange\_file\_sizes}(my\_file\_sizes, \hyperlink{classlbann_1_1generic__data__store_a0dfa2ffa01845b84ca477fb3e14a36c6}{m\_num\_global\_indices});
201 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_ae8f5d8741ddd762ffd3a477504bca619_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_ae8f5d8741ddd762ffd3a477504bca619_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_a71b04726b0e651bc9b73cd6f5ca3c12b}\label{classlbann_1_1data__store__imagenet_a71b04726b0e651bc9b73cd6f5ca3c12b}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1data__store__imagenet}{data\+\_\+store\+\_\+imagenet}\& lbann\+::data\+\_\+store\+\_\+imagenet\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1data__store__imagenet}{data\+\_\+store\+\_\+imagenet} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



operator= 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a71b04726b0e651bc9b73cd6f5ca3c12b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_a70cfd8f529aad8d66993000da7350ec5}\label{classlbann_1_1data__store__imagenet_a70cfd8f529aad8d66993000da7350ec5}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!read\+\_\+files@{read\+\_\+files}}
\index{read\+\_\+files@{read\+\_\+files}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{read\+\_\+files()}{read\_files()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+imagenet\+::read\+\_\+files (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



reads all files assigned to this processor into memory (m\+\_\+data) 



Implements \hyperlink{classlbann_1_1data__store__image_a146874a68c24213f5509efb9727cb6e5}{lbann\+::data\+\_\+store\+\_\+image}.



Reimplemented in \hyperlink{classlbann_1_1data__store__multi__images_a8ce8ccf3c7b0d19adfb838108bec075b}{lbann\+::data\+\_\+store\+\_\+multi\+\_\+images}.



Definition at line 144 of file data\+\_\+store\+\_\+imagenet.\+cpp.


\begin{DoxyCode}
144                                      \{
145   image\_data\_reader *reader = \textcolor{keyword}{dynamic\_cast<}image\_data\_reader*\textcolor{keyword}{>}(\hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader});
146   \textcolor{keyword}{const} std::vector<std::pair<std::string, int> > & image\_list = reader->get\_image\_list();
147   \textcolor{keywordtype}{size\_t} j = 0;
148   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} index : \hyperlink{classlbann_1_1generic__data__store_abd38f8d8aab0648959e09d011abfe20a}{m\_my\_datastore\_indices}) \{
149     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}{m\_offsets}.find(index) == \hyperlink{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}{m\_offsets}.end()) \{
150       std::stringstream err;
151       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "} 
152           << \textcolor{stringliteral}{" m\_offsets.find(index) failed for index: "} << index;
153       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
154     \}
155     \textcolor{keywordtype}{size\_t} offset = \hyperlink{classlbann_1_1data__store__image_ae5a9ba5fb1bf4d3147743012b8099038}{m\_offsets}[index];
156     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}.find(index) == \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}.end()) \{
157       std::stringstream err;
158       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "} 
159           << \textcolor{stringliteral}{" m\_file\_sizes.find(index) failed for index: "} << index;
160       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
161     \}
162     \textcolor{keywordtype}{size\_t} file\_len = \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}[index];
163     \textcolor{keywordflow}{if} (offset + file\_len > \hyperlink{classlbann_1_1data__store__image_a10e9aa0c240785bc0a961f24e87a1c16}{m\_data}.size()) \{
164       std::stringstream err;
165       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "} << \textcolor{stringliteral}{" j: "} << j 
166         << \textcolor{stringliteral}{" of "} << \hyperlink{classlbann_1_1generic__data__store_a41f7fec1f1f3d6568a5765be7a6784eb}{m\_my\_minibatch\_indices\_v}.size() << \textcolor{stringliteral}{" offset: "} << offset
167         << \textcolor{stringliteral}{" file\_len: "} << file\_len << \textcolor{stringliteral}{" offset+file\_len: "}
168         << offset+file\_len << \textcolor{stringliteral}{" m\_data.size(): "} << \hyperlink{classlbann_1_1data__store__image_a10e9aa0c240785bc0a961f24e87a1c16}{m\_data}.size()
169         << \textcolor{stringliteral}{"\(\backslash\)noffset+file\_len must be <= m\_data.size()"};
170       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
171     \}
172     \hyperlink{classlbann_1_1data__store__image_a8a53bab58d75554821f90c38d14078aa}{load\_file}(\hyperlink{classlbann_1_1generic__data__store_ab479c127f00ce550c7433b90e40a5a3d}{m\_dir}, image\_list[index].first, &\hyperlink{classlbann_1_1data__store__image_a10e9aa0c240785bc0a961f24e87a1c16}{m\_data}[offset], file\_len);
173     ++j;
174   \}
175 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a70cfd8f529aad8d66993000da7350ec5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a70cfd8f529aad8d66993000da7350ec5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_a611aa1734a491c443396a077b49fe4fe}\label{classlbann_1_1data__store__imagenet_a611aa1734a491c443396a077b49fe4fe}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!setup@{setup}}
\index{setup@{setup}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{setup()}{setup()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+imagenet\+::setup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



called by \hyperlink{classlbann_1_1generic__data__reader_a8b2a09d38512fc11f1b9d572c89100a7}{generic\+\_\+data\+\_\+reader\+::setup\+\_\+data\+\_\+store} 



Reimplemented from \hyperlink{classlbann_1_1data__store__image_a79280b3aa9a207dfacad2bcc9824ec73}{lbann\+::data\+\_\+store\+\_\+image}.



Reimplemented in \hyperlink{classlbann_1_1data__store__multi__images_a7b5e9ec7b7132872299a204d5d24ee62}{lbann\+::data\+\_\+store\+\_\+multi\+\_\+images}, \hyperlink{classlbann_1_1data__store__triplet_aca66b9cf71d7ba2b9870e76c5b92b5e8}{lbann\+::data\+\_\+store\+\_\+triplet}, and \hyperlink{classlbann_1_1data__store__imagenet__patches_aa8cfaf12c87f3dbbbb4fc808f6ca26ad}{lbann\+::data\+\_\+store\+\_\+imagenet\+\_\+patches}.



Definition at line 36 of file data\+\_\+store\+\_\+imagenet.\+cpp.


\begin{DoxyCode}
36                                 \{
37   \textcolor{keywordtype}{double} tm1 = \hyperlink{namespacelbann_a478d36031ff0659893c4322cd856157f}{get\_time}();
38   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a87695bfd2d1ed0dbe01d99108e3f68b7}{m\_rank} == 0) \{
39     std::cerr << \textcolor{stringliteral}{"starting data\_store\_imagenet::setup() for data reader with role: "} << 
      \hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader}->\hyperlink{classlbann_1_1generic__data__reader_a92982e1b399f37e2ead5aa440883cba5}{get\_role}() << std::endl;
40   \}
41 
42   \hyperlink{classlbann_1_1generic__data__store_a853741295a07b5687921fc56d0d7d5b2}{set\_name}(\textcolor{stringliteral}{"data\_store\_imagenet"});
43 
44   \textcolor{comment}{//sanity check}
45   image\_data\_reader *reader = \textcolor{keyword}{dynamic\_cast<}image\_data\_reader*\textcolor{keyword}{>}(\hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader});
46   \textcolor{keywordflow}{if} (reader == \textcolor{keyword}{nullptr}) \{
47     std::stringstream err;
48     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
49         << \textcolor{stringliteral}{"dynamic\_cast<image\_data\_reader*>(m\_reader) failed"};
50     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
51   \}
52 
53 
54   \textcolor{comment}{//optionally run some tests at the end of setup()}
55   \textcolor{keywordtype}{bool} run\_tests = \textcolor{keyword}{false};
56   \textcolor{keywordflow}{if} (\hyperlink{classoptions_a9ecfe9c365269df68a41b961c31ae3f5}{options::get}()->\hyperlink{classoptions_aafb1d2a7ccde0b1bf786230ba4080ecd}{has\_bool}(\textcolor{stringliteral}{"test\_data\_store"}) && 
      \hyperlink{classoptions_a9ecfe9c365269df68a41b961c31ae3f5}{options::get}()->\hyperlink{classoptions_a99aa190102de33e2aed39723929f9fad}{get\_bool}(\textcolor{stringliteral}{"test\_data\_store"})) \{
57     run\_tests = \textcolor{keyword}{true};
58     \hyperlink{classoptions_a9ecfe9c365269df68a41b961c31ae3f5}{options::get}()->\hyperlink{classoptions_a3c23831e4218f9a88cddc81337518046}{set\_option}(\textcolor{stringliteral}{"exit\_after\_setup"}, \textcolor{keyword}{true});
59   \}
60 
61   \textcolor{comment}{//@todo needs to be designed and implemented!}
62   \textcolor{keywordflow}{if} (! \hyperlink{classlbann_1_1generic__data__store_a1a9cc7b097cd7dd6ae0d12d52bb43ea1}{m\_in\_memory}) \{
63     std::stringstream err;
64     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
65         << \textcolor{stringliteral}{"not yet implemented"};
66     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
67   \} 
68   
69   \textcolor{keywordflow}{else} \{
70     \hyperlink{classlbann_1_1data__store__image_a79280b3aa9a207dfacad2bcc9824ec73}{data\_store\_image::setup}();
71 
72     \textcolor{keywordflow}{if} (run\_tests) \{
73       \hyperlink{classlbann_1_1data__store__imagenet_a1c928ccfb4e75ffe4cefd62f37c072f8}{test\_file\_sizes}();
74       \hyperlink{classlbann_1_1data__store__imagenet_a1ed5548a409afec61489102f7f080467}{test\_data}();
75     \}  
76 
77     \textcolor{keywordtype}{double} tm2 = \hyperlink{namespacelbann_a478d36031ff0659893c4322cd856157f}{get\_time}();
78     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a87695bfd2d1ed0dbe01d99108e3f68b7}{m\_rank} == 0) \{
79       std::cerr << \textcolor{stringliteral}{"data\_store\_imagenet setup time: "} << tm2 - tm1 << std::endl;
80     \}
81   \}
82 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a611aa1734a491c443396a077b49fe4fe_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a611aa1734a491c443396a077b49fe4fe_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_a1ed5548a409afec61489102f7f080467}\label{classlbann_1_1data__store__imagenet_a1ed5548a409afec61489102f7f080467}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!test\+\_\+data@{test\+\_\+data}}
\index{test\+\_\+data@{test\+\_\+data}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{test\+\_\+data()}{test\_data()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+imagenet\+::test\+\_\+data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



for use during development and testing 



Definition at line 85 of file data\+\_\+store\+\_\+imagenet.\+cpp.


\begin{DoxyCode}
85                                     \{
86   image\_data\_reader *reader = \textcolor{keyword}{dynamic\_cast<}image\_data\_reader*\textcolor{keyword}{>}(\hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader});
87   \textcolor{keyword}{const} std::vector<std::pair<std::string, int> > & image\_list = reader->get\_image\_list();
88   std::vector<unsigned char> b;
89   std::vector<unsigned char> *datastore\_buf;
90   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} t : \hyperlink{classlbann_1_1generic__data__store_a41f7fec1f1f3d6568a5765be7a6784eb}{m\_my\_minibatch\_indices\_v}) \{
91     \textcolor{keywordtype}{int} idx = (*m\_shuffled\_indices)[t];
92 
93     \textcolor{comment}{//read directly from file}
94     std::string imagepath = \hyperlink{classlbann_1_1generic__data__store_ab479c127f00ce550c7433b90e40a5a3d}{m\_dir} + image\_list[idx].first;
95     std::ifstream in(imagepath.c\_str(), std::ios::in | std::ios::binary);
96     \textcolor{keywordflow}{if} (! in.good()) \{
97       std::stringstream err;
98       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
99           << \textcolor{stringliteral}{"failed to open "} << imagepath << \textcolor{stringliteral}{" for reading"};
100       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
101     \}
102 
103     in.seekg(0, std::ios::end);
104     \textcolor{keywordtype}{size\_t} sz = in.tellg();
105     in.seekg(0, std::ios::beg);
106     b.resize(sz);
107     in.read((\textcolor{keywordtype}{char}*)&b[0], sz);
108     in.close();
109 
110     \textcolor{comment}{//get from datastore}
111     \hyperlink{classlbann_1_1data__store__image_aa9e47fb3cad58dda4eaddcccc9bfa523}{get\_data\_buf}(idx, datastore\_buf, 0);
112     \textcolor{keywordflow}{if} (b != *datastore\_buf) \{
113       std::stringstream err;
114       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
115           << \textcolor{stringliteral}{" :: data\_store\_imagenet::test\_data, b != v; b.size: "} 
116           << b.size() << \textcolor{stringliteral}{"  datstore\_buf->size: "} << datastore\_buf->size();
117       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
118     \} 
119   \}
120 
121   std::cerr << \textcolor{stringliteral}{"rank: "} << \hyperlink{classlbann_1_1generic__data__store_a87695bfd2d1ed0dbe01d99108e3f68b7}{m\_rank} << \textcolor{stringliteral}{" role: "} << \hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader}->
      \hyperlink{classlbann_1_1generic__data__reader_a92982e1b399f37e2ead5aa440883cba5}{get\_role}() << \textcolor{stringliteral}{" :: data\_store\_imagenet::test\_data: PASSES!\(\backslash\)n"};
122 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a1ed5548a409afec61489102f7f080467_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a1ed5548a409afec61489102f7f080467_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1data__store__imagenet_a1c928ccfb4e75ffe4cefd62f37c072f8}\label{classlbann_1_1data__store__imagenet_a1c928ccfb4e75ffe4cefd62f37c072f8}} 
\index{lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}!test\+\_\+file\+\_\+sizes@{test\+\_\+file\+\_\+sizes}}
\index{test\+\_\+file\+\_\+sizes@{test\+\_\+file\+\_\+sizes}!lbann\+::data\+\_\+store\+\_\+imagenet@{lbann\+::data\+\_\+store\+\_\+imagenet}}
\subsubsection{\texorpdfstring{test\+\_\+file\+\_\+sizes()}{test\_file\_sizes()}}
{\footnotesize\ttfamily void lbann\+::data\+\_\+store\+\_\+imagenet\+::test\+\_\+file\+\_\+sizes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



for use during development and testing 



Definition at line 124 of file data\+\_\+store\+\_\+imagenet.\+cpp.


\begin{DoxyCode}
124                                           \{
125   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__store_a143fd33ef3a53180bc62745e369c16f8}{m\_master}) \{
126     std::cerr << \hyperlink{classlbann_1_1generic__data__store_a87695bfd2d1ed0dbe01d99108e3f68b7}{m\_rank} << \textcolor{stringliteral}{" :: STARTING data\_store\_imagenet::test\_file\_sizes()\(\backslash\)n"};
127   \}
128   image\_data\_reader *reader = \textcolor{keyword}{dynamic\_cast<}image\_data\_reader*\textcolor{keyword}{>}(\hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader});
129   \textcolor{keyword}{const} std::vector<std::pair<std::string, int> > & image\_list = reader->get\_image\_list();
130   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} t : \hyperlink{classlbann_1_1data__store__image_a1903176a4b305fd42617ea1cb6d997ae}{m\_file\_sizes}) \{
131     \textcolor{keywordtype}{size\_t} len = \hyperlink{classlbann_1_1generic__data__store_a7641d15eba63426acf5071acb8026442}{get\_file\_size}(\hyperlink{classlbann_1_1generic__data__store_ab479c127f00ce550c7433b90e40a5a3d}{m\_dir}, image\_list[t.first].first);
132     \textcolor{keywordflow}{if} (t.second != len || len == 0) \{
133       std::stringstream err;
134       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
135           << \textcolor{stringliteral}{"m\_file\_sizes["} << t.first << \textcolor{stringliteral}{"] = "} << t.second
136           << \textcolor{stringliteral}{" but actual size appears to be "} << len;
137       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
138     \}
139   \}
140   std::cerr << \textcolor{stringliteral}{"rank:  "} << \hyperlink{classlbann_1_1generic__data__store_a87695bfd2d1ed0dbe01d99108e3f68b7}{m\_rank} << \textcolor{stringliteral}{" role: "} << \hyperlink{classlbann_1_1generic__data__store_afa49ced0ab64c632371ea52532a91ec2}{m\_reader}->
      \hyperlink{classlbann_1_1generic__data__reader_a92982e1b399f37e2ead5aa440883cba5}{get\_role}() << \textcolor{stringliteral}{" :: data\_store\_imagenet::test\_file\_sizes: PASSES!\(\backslash\)n"};
141 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a1c928ccfb4e75ffe4cefd62f37c072f8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1data__store__imagenet_a1c928ccfb4e75ffe4cefd62f37c072f8_icgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/data\+\_\+store/\hyperlink{data__store__imagenet_8hpp}{data\+\_\+store\+\_\+imagenet.\+hpp}\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/src/data\+\_\+store/\hyperlink{data__store__imagenet_8cpp}{data\+\_\+store\+\_\+imagenet.\+cpp}\end{DoxyCompactItemize}
