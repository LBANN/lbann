\hypertarget{classlbann_1_1greedy__layerwise__autoencoder}{}\section{lbann\+:\+:greedy\+\_\+layerwise\+\_\+autoencoder Class Reference}
\label{classlbann_1_1greedy__layerwise__autoencoder}\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}


{\ttfamily \#include $<$greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp$>$}



Inheritance diagram for lbann\+:\+:greedy\+\_\+layerwise\+\_\+autoencoder\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{classlbann_1_1greedy__layerwise__autoencoder__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for lbann\+:\+:greedy\+\_\+layerwise\+\_\+autoencoder\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a36dff325c3c756623b28cb056f91e058}{greedy\+\_\+layerwise\+\_\+autoencoder} (\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm}, int mini\+\_\+batch\+\_\+size, \hyperlink{classlbann_1_1objective__function}{objective\+\_\+function} $\ast$obj\+\_\+fn, \hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$default\+\_\+optimizer)
\item 
\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_adf8750be08e34891701a24678f703acd}{greedy\+\_\+layerwise\+\_\+autoencoder} (const \hyperlink{classlbann_1_1greedy__layerwise__autoencoder}{greedy\+\_\+layerwise\+\_\+autoencoder} \&)
\item 
\hyperlink{classlbann_1_1greedy__layerwise__autoencoder}{greedy\+\_\+layerwise\+\_\+autoencoder} \& \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_ac5e2de693353966b7816ca10282068f5}{operator=} (const \hyperlink{classlbann_1_1greedy__layerwise__autoencoder}{greedy\+\_\+layerwise\+\_\+autoencoder} \&)
\item 
\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a74aa0b263d78b6a7a8ac32cde6e05c4c}{$\sim$greedy\+\_\+layerwise\+\_\+autoencoder} () override
\item 
\hyperlink{classlbann_1_1greedy__layerwise__autoencoder}{greedy\+\_\+layerwise\+\_\+autoencoder} $\ast$ \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a435fa0830662ebde904b9e70902f7e16}{copy} () const override
\item 
std\+::string \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a975ea739b9a97e76fac46ce8191dea84}{name} () const override
\item 
void \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a085f0b2debb82d9c4927a1c8b11dd353}{train} (int num\+\_\+epochs) override
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a115607e435ae4685531a81852ce01fe7}{setup\+\_\+layer\+\_\+topology} () override
\item 
void \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a5f237f1f6285475c5493a7d15dc32096}{set\+\_\+phase} (int phase)
\item 
void \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a82b8ced756904a2423a65cd0e329b4e2}{restore\+\_\+sequential\+\_\+model} ()
\item 
void \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_af16aa7d2336a3f64e27970241cb2cd3e}{forward\+\_\+prop} (\hyperlink{base_8hpp_a2781a159088df64ed7d47cc91c4dc0a8}{execution\+\_\+mode} mode) override
\item 
void \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a6d39fda041fe570a668cb72594508062}{backward\+\_\+prop} () override
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\+\_\+phase}
\item 
int \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}{m\+\_\+num\+\_\+phases}
\item 
std\+::vector$<$ int $>$ \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\+\_\+sections}
\item 
\hyperlink{classlbann_1_1Layer}{Layer} $\ast$ \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\+\_\+reconstruction}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Greedy layerwise autoencoder. 

Definition at line 36 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a36dff325c3c756623b28cb056f91e058}\label{classlbann_1_1greedy__layerwise__autoencoder_a36dff325c3c756623b28cb056f91e058}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!greedy\+\_\+layerwise\+\_\+autoencoder@{greedy\+\_\+layerwise\+\_\+autoencoder}}
\index{greedy\+\_\+layerwise\+\_\+autoencoder@{greedy\+\_\+layerwise\+\_\+autoencoder}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{greedy\+\_\+layerwise\+\_\+autoencoder()}{greedy\_layerwise\_autoencoder()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::greedy\+\_\+layerwise\+\_\+autoencoder (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$}]{comm,  }\item[{int}]{mini\+\_\+batch\+\_\+size,  }\item[{\hyperlink{classlbann_1_1objective__function}{objective\+\_\+function} $\ast$}]{obj\+\_\+fn,  }\item[{\hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$}]{default\+\_\+optimizer }\end{DoxyParamCaption})}

Constructor. 

Definition at line 35 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
39   : \hyperlink{classlbann_1_1sequential__model_a269f246d881186f8e8608dc4758cc6a6}{sequential\_model}(\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm}, mini\_batch\_size, obj\_fn, default\_optimizer),
40     \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}(-1), \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}{m\_num\_phases}(0), \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction}(\textcolor{keyword}{nullptr}) \{\}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a36dff325c3c756623b28cb056f91e058_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_adf8750be08e34891701a24678f703acd}\label{classlbann_1_1greedy__layerwise__autoencoder_adf8750be08e34891701a24678f703acd}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!greedy\+\_\+layerwise\+\_\+autoencoder@{greedy\+\_\+layerwise\+\_\+autoencoder}}
\index{greedy\+\_\+layerwise\+\_\+autoencoder@{greedy\+\_\+layerwise\+\_\+autoencoder}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{greedy\+\_\+layerwise\+\_\+autoencoder()}{greedy\_layerwise\_autoencoder()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::greedy\+\_\+layerwise\+\_\+autoencoder (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1greedy__layerwise__autoencoder}{greedy\+\_\+layerwise\+\_\+autoencoder} \&}]{other }\end{DoxyParamCaption})}

Copy constructor. 

Definition at line 42 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
44   : \hyperlink{classlbann_1_1sequential__model_a269f246d881186f8e8608dc4758cc6a6}{sequential\_model}(other),
45     \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}(0),
46     \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}{m\_num\_phases}(other.m\_num\_phases),
47     \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}(other.m\_sections),
48     \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction}(\textcolor{keyword}{nullptr}) \{
49   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a5f237f1f6285475c5493a7d15dc32096}{set\_phase}(other.m\_phase);
50 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_adf8750be08e34891701a24678f703acd_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a74aa0b263d78b6a7a8ac32cde6e05c4c}\label{classlbann_1_1greedy__layerwise__autoencoder_a74aa0b263d78b6a7a8ac32cde6e05c4c}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!````~greedy\+\_\+layerwise\+\_\+autoencoder@{$\sim$greedy\+\_\+layerwise\+\_\+autoencoder}}
\index{````~greedy\+\_\+layerwise\+\_\+autoencoder@{$\sim$greedy\+\_\+layerwise\+\_\+autoencoder}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{$\sim$greedy\+\_\+layerwise\+\_\+autoencoder()}{~greedy\_layerwise\_autoencoder()}}
{\footnotesize\ttfamily lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::$\sim$greedy\+\_\+layerwise\+\_\+autoencoder (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}}

Destructor. 

Definition at line 62 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
62                                                             \{
63   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction} != \textcolor{keyword}{nullptr}) \textcolor{keyword}{delete} \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction};
64 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a6d39fda041fe570a668cb72594508062}\label{classlbann_1_1greedy__layerwise__autoencoder_a6d39fda041fe570a668cb72594508062}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!backward\+\_\+prop@{backward\+\_\+prop}}
\index{backward\+\_\+prop@{backward\+\_\+prop}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{backward\+\_\+prop()}{backward\_prop()}}
{\footnotesize\ttfamily void lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::backward\+\_\+prop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Backward prop step. 

Reimplemented from \hyperlink{classlbann_1_1model_a2ce4444efaab4dd1236c837d6847e438}{lbann\+::model}.



Definition at line 294 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
294                                                  \{
295 
296   \textcolor{comment}{// Use base implementation if model is sequential}
297   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase} < 0) \{
298     \hyperlink{classlbann_1_1model_a2ce4444efaab4dd1236c837d6847e438}{sequential\_model::backward\_prop}();
299     \textcolor{keywordflow}{return};
300   \}
301   \hyperlink{classlbann_1_1model_a8a60eee343381e657b2c042637e56751}{do\_model\_backward\_prop\_begin\_cbs}();
302 
303   \textcolor{comment}{// Determine encoder and decoder to train}
304   \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_sections = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}.size() - 1;
305   \textcolor{keyword}{const} \textcolor{keywordtype}{int} encoder\_start = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}];
306   \textcolor{keyword}{const} \textcolor{keywordtype}{int} encoder\_end = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}+1];
307   \textcolor{keyword}{const} \textcolor{keywordtype}{int} decoder\_start = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[num\_sections-\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}-1];
308   \textcolor{keyword}{const} \textcolor{keywordtype}{int} decoder\_end = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[num\_sections-\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}];
309 
310   \textcolor{comment}{// Backward prop on reconstruction layer}
311   \hyperlink{classlbann_1_1model_a51dc59ea8dd4bc689854732269aaf001}{do\_layer\_backward\_prop\_begin\_cbs}(
      \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction});
312   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction}->\hyperlink{classlbann_1_1Layer_a0a502d9218d7dbbfd10ebebb6f917033}{back\_prop}();
313   \hyperlink{classlbann_1_1model_ab0939d2668cca7efc2cc52355d34df3b}{do\_layer\_backward\_prop\_end\_cbs}(\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction});
314 
315   \textcolor{comment}{// Backward prop on decoder being trained}
316   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = decoder\_end; i < decoder\_start; --i) \{
317     Layer* layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i];
318     \hyperlink{classlbann_1_1model_a51dc59ea8dd4bc689854732269aaf001}{do\_layer\_backward\_prop\_begin\_cbs}(layer);
319     layer->back\_prop();
320     \hyperlink{classlbann_1_1model_ab0939d2668cca7efc2cc52355d34df3b}{do\_layer\_backward\_prop\_end\_cbs}(layer);
321   \}
322 
323   \textcolor{comment}{// Backward prop on encoder being trained}
324   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = encoder\_end; i >= encoder\_start; --i) \{
325     Layer* layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i];
326     \hyperlink{classlbann_1_1model_a51dc59ea8dd4bc689854732269aaf001}{do\_layer\_backward\_prop\_begin\_cbs}(layer);
327     layer->back\_prop();
328     \hyperlink{classlbann_1_1model_ab0939d2668cca7efc2cc52355d34df3b}{do\_layer\_backward\_prop\_end\_cbs}(layer);
329   \}
330 
331   \hyperlink{classlbann_1_1model_a737a0129eadf52be476034888b3eedc2}{do\_model\_backward\_prop\_end\_cbs}();
332 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a6d39fda041fe570a668cb72594508062_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a435fa0830662ebde904b9e70902f7e16}\label{classlbann_1_1greedy__layerwise__autoencoder_a435fa0830662ebde904b9e70902f7e16}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!copy@{copy}}
\index{copy@{copy}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1greedy__layerwise__autoencoder}{greedy\+\_\+layerwise\+\_\+autoencoder}$\ast$ lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Create copy. 

Implements \hyperlink{classlbann_1_1model_aacd024c11f0897b33a7e7838b9433ba2}{lbann\+::model}.



Definition at line 52 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp.


\begin{DoxyCode}
52                                                       \{
53     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a36dff325c3c756623b28cb056f91e058}{greedy\_layerwise\_autoencoder}(*\textcolor{keyword}{this});
54   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a435fa0830662ebde904b9e70902f7e16_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_af16aa7d2336a3f64e27970241cb2cd3e}\label{classlbann_1_1greedy__layerwise__autoencoder_af16aa7d2336a3f64e27970241cb2cd3e}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!forward\+\_\+prop@{forward\+\_\+prop}}
\index{forward\+\_\+prop@{forward\+\_\+prop}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{forward\+\_\+prop()}{forward\_prop()}}
{\footnotesize\ttfamily void lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::forward\+\_\+prop (\begin{DoxyParamCaption}\item[{\hyperlink{base_8hpp_a2781a159088df64ed7d47cc91c4dc0a8}{execution\+\_\+mode}}]{mode }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Forward prop step. 

Reimplemented from \hyperlink{classlbann_1_1model_adc4f845c8e292afe2d8686f459729484}{lbann\+::model}.



Definition at line 246 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
246                                                                    \{
247 
248   \textcolor{comment}{// Use base implementation if model is sequential}
249   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase} < 0) \{
250     \hyperlink{classlbann_1_1model_adc4f845c8e292afe2d8686f459729484}{sequential\_model::forward\_prop}(mode);
251     \textcolor{keywordflow}{return};
252   \}
253   \hyperlink{classlbann_1_1model_af3c45642bbacf1bd07e8504d7e689ec0}{do\_model\_forward\_prop\_begin\_cbs}(mode);
254 
255   \textcolor{comment}{// Determine encoder and decoder to train}
256   \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_sections = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}.size() - 1;
257   \textcolor{keyword}{const} \textcolor{keywordtype}{int} encoder\_start = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}];
258   \textcolor{keyword}{const} \textcolor{keywordtype}{int} encoder\_end = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}+1];
259   \textcolor{keyword}{const} \textcolor{keywordtype}{int} decoder\_start = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[num\_sections-\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}-1];
260   \textcolor{keyword}{const} \textcolor{keywordtype}{int} decoder\_end = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[num\_sections-\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase}];
261 
262   \textcolor{comment}{// Forward prop on layers that are already trained}
263   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < encoder\_start; ++i) \{
264     Layer* layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i];
265     \hyperlink{classlbann_1_1model_ac19ce0dd060f9caddd6e14974a6e7713}{do\_layer\_forward\_prop\_begin\_cbs}(mode, layer);
266     layer->forward\_prop();
267     \hyperlink{classlbann_1_1model_a7d6b891f58a7df9726e4f2c48d1f957a}{do\_layer\_forward\_prop\_end\_cbs}(mode, layer);
268   \}
269 
270   \textcolor{comment}{// Forward prop on encoder being trained}
271   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = encoder\_start; i < encoder\_end; ++i) \{
272     Layer* layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i];
273     \hyperlink{classlbann_1_1model_ac19ce0dd060f9caddd6e14974a6e7713}{do\_layer\_forward\_prop\_begin\_cbs}(mode, layer);
274     layer->forward\_prop();
275     \hyperlink{classlbann_1_1model_a7d6b891f58a7df9726e4f2c48d1f957a}{do\_layer\_forward\_prop\_end\_cbs}(mode, layer);
276   \}
277 
278   \textcolor{comment}{// Forward prop on decoder being trained}
279   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = decoder\_start; i < decoder\_end; ++i) \{
280     Layer* layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i];
281     \hyperlink{classlbann_1_1model_ac19ce0dd060f9caddd6e14974a6e7713}{do\_layer\_forward\_prop\_begin\_cbs}(mode, layer);
282     layer->forward\_prop();
283     \hyperlink{classlbann_1_1model_a7d6b891f58a7df9726e4f2c48d1f957a}{do\_layer\_forward\_prop\_end\_cbs}(mode, layer);
284   \}
285 
286   \textcolor{comment}{// Forward prop on reconstruction layer}
287   \hyperlink{classlbann_1_1model_ac19ce0dd060f9caddd6e14974a6e7713}{do\_layer\_forward\_prop\_begin\_cbs}(mode, 
      \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction});
288   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction}->\hyperlink{classlbann_1_1Layer_a2483ccd8a4406a6891f6176f1001b4e5}{forward\_prop}();
289   \hyperlink{classlbann_1_1model_a7d6b891f58a7df9726e4f2c48d1f957a}{do\_layer\_forward\_prop\_end\_cbs}(mode, 
      \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction});
290 
291   \hyperlink{classlbann_1_1model_a9d67f4f3a027327d2db8767759f9c2bf}{do\_model\_forward\_prop\_end\_cbs}(mode);
292 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_af16aa7d2336a3f64e27970241cb2cd3e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a975ea739b9a97e76fac46ce8191dea84}\label{classlbann_1_1greedy__layerwise__autoencoder_a975ea739b9a97e76fac46ce8191dea84}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!name@{name}}
\index{name@{name}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{name()}{name()}}
{\footnotesize\ttfamily std\+::string lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Get model name. 

Implements \hyperlink{classlbann_1_1model_a7e471599eded909c4ce7178689dd13b6}{lbann\+::model}.



Definition at line 57 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp.


\begin{DoxyCode}
57 \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"greedy layerwise autoencoder"}; \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a975ea739b9a97e76fac46ce8191dea84_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_ac5e2de693353966b7816ca10282068f5}\label{classlbann_1_1greedy__layerwise__autoencoder_ac5e2de693353966b7816ca10282068f5}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1greedy__layerwise__autoencoder}{greedy\+\_\+layerwise\+\_\+autoencoder} \& lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1greedy__layerwise__autoencoder}{greedy\+\_\+layerwise\+\_\+autoencoder} \&}]{other }\end{DoxyParamCaption})}

Copy assignment operator. 

Definition at line 52 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
53                                              \{
54   \hyperlink{classlbann_1_1sequential__model_a9714c99522b90488c486b390c5a7b6f3}{sequential\_model::operator=}(other);
55   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}{m\_num\_phases} = other.m\_num\_phases;
56   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections} = other.m\_sections;
57   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase} = 0;
58   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a5f237f1f6285475c5493a7d15dc32096}{set\_phase}(other.m\_phase);
59   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
60 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_ac5e2de693353966b7816ca10282068f5_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a82b8ced756904a2423a65cd0e329b4e2}\label{classlbann_1_1greedy__layerwise__autoencoder_a82b8ced756904a2423a65cd0e329b4e2}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!restore\+\_\+sequential\+\_\+model@{restore\+\_\+sequential\+\_\+model}}
\index{restore\+\_\+sequential\+\_\+model@{restore\+\_\+sequential\+\_\+model}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{restore\+\_\+sequential\+\_\+model()}{restore\_sequential\_model()}}
{\footnotesize\ttfamily void lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::restore\+\_\+sequential\+\_\+model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Set the greedy layerwise autoencover to a sequential model. 

Definition at line 214 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
214                                                             \{
215 
216   \textcolor{comment}{// Return if model is already sequential}
217   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase} < 0) \{
218     \textcolor{keywordflow}{return};
219   \}
220   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase} = -1;
221 
222   \textcolor{comment}{// Restore sequential layer order}
223   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} m\_section : \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}) \{
224     Layer* prev\_layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[m\_section-1];
225     Layer* next\_layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[m\_section];
226     \textcolor{keyword}{auto}& prev\_layer\_children = prev\_layer->get\_child\_layers();
227     \textcolor{keyword}{auto}& next\_layer\_parents = next\_layer->get\_parent\_layers();
228     prev\_layer\_children[0] = next\_layer;
229     next\_layer\_parents[0] = prev\_layer;
230   \}
231 
232   \textcolor{comment}{// Delete reconstruction layer}
233   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction} != \textcolor{keyword}{nullptr}) \textcolor{keyword}{delete} \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction};
234   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction} = \textcolor{keyword}{nullptr};
235 
236   \textcolor{comment}{// Restore objective function to target layer}
237   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} term : \hyperlink{classlbann_1_1model_a24c50e7108dd7698671aed7df5b22e8b}{m\_objective\_function}->\hyperlink{classlbann_1_1objective__function_a510544e9e511be54a50efd39226de345}{get\_terms}()) \{
238     \textcolor{keyword}{auto}* loss = \textcolor{keyword}{dynamic\_cast<}loss\_function*\textcolor{keyword}{>}(term);
239     \textcolor{keywordflow}{if} (loss != \textcolor{keyword}{nullptr}) \{
240       loss->set\_target\_layer((generic\_target\_layer*) \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.back());
241     \}
242   \}
243 
244 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a82b8ced756904a2423a65cd0e329b4e2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a82b8ced756904a2423a65cd0e329b4e2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a5f237f1f6285475c5493a7d15dc32096}\label{classlbann_1_1greedy__layerwise__autoencoder_a5f237f1f6285475c5493a7d15dc32096}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!set\+\_\+phase@{set\+\_\+phase}}
\index{set\+\_\+phase@{set\+\_\+phase}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{set\+\_\+phase()}{set\_phase()}}
{\footnotesize\ttfamily void lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::set\+\_\+phase (\begin{DoxyParamCaption}\item[{int}]{phase }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Set the greedy layerwise autoencoder to a training phase. During a phase, an encoder and decoder section of the model are trained while the rest of the model is frozen. 

Definition at line 160 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
160                                                       \{
161 
162   \textcolor{comment}{// Restore sequential model first}
163   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a82b8ced756904a2423a65cd0e329b4e2}{restore\_sequential\_model}();
164   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}{m\_phase} = phase;
165   \textcolor{keywordflow}{if} (phase < 0) \{
166     \textcolor{keywordflow}{return};
167   \}
168 
169   \textcolor{comment}{// Determine encoder and decoder being trained}
170   \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_sections = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}.size() - 1;
171   \textcolor{keyword}{const} \textcolor{keywordtype}{int} encoder\_start = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[phase];
172   \textcolor{keyword}{const} \textcolor{keywordtype}{int} encoder\_end = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[phase+1];
173   \textcolor{keyword}{const} \textcolor{keywordtype}{int} decoder\_start = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[num\_sections-phase-1];
174   \textcolor{keyword}{const} \textcolor{keywordtype}{int} decoder\_end = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[num\_sections-phase];
175   \textcolor{keyword}{auto}& encoder\_parents = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[encoder\_start]->get\_parent\_layers();
176   \textcolor{keyword}{auto}& encoder\_children = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[encoder\_end-1]->get\_child\_layers();
177   \textcolor{keyword}{auto}& decoder\_parents = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[decoder\_start]->get\_parent\_layers();
178   \textcolor{keyword}{auto}& decoder\_children = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[decoder\_end-1]->get\_child\_layers();
179 
180   \textcolor{comment}{// Initialize reconstruction layer}
181   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction} != \textcolor{keyword}{nullptr}) \textcolor{keyword}{delete} \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction};
182   Layer* original\_layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[encoder\_start-1];
183   \textcolor{keywordflow}{switch} (encoder\_parents[0]->get\_data\_layout()) \{
184   \textcolor{keywordflow}{case} \hyperlink{base_8hpp_a786677cbfb3f5677b4d84f3056eb08dbac94d7b0e44ab8bdcdad694a673cdeae0}{data\_layout::MODEL\_PARALLEL}:
185     \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction} = \textcolor{keyword}{new} reconstruction\_layer<data\_layout::MODEL\_PARALLEL>(
      \hyperlink{classlbann_1_1model_a0eabaf2b2f829fd5db3dfd26df420df0}{m\_comm}, original\_layer);
186     \textcolor{keywordflow}{break};
187   \textcolor{keywordflow}{case} \hyperlink{base_8hpp_a786677cbfb3f5677b4d84f3056eb08dba37d2a3465f7cbf4ab60f4e79944d0638}{data\_layout::DATA\_PARALLEL}:
188     \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction} = \textcolor{keyword}{new} reconstruction\_layer<data\_layout::DATA\_PARALLEL>(
      \hyperlink{classlbann_1_1model_a0eabaf2b2f829fd5db3dfd26df420df0}{m\_comm}, original\_layer);
189     \textcolor{keywordflow}{break};
190   \textcolor{keywordflow}{default}:
191     std::stringstream err;
192     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
193         << \textcolor{stringliteral}{"invalid data layout for reconstruction layer"};
194     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
195   \}
196   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction}->\hyperlink{classlbann_1_1Layer_a82d8a038861b0af0d54fbf44ce715839}{set\_name}(\textcolor{stringliteral}{"reconstruction\_phase"} + std::to\_string(phase));
197 
198   \textcolor{comment}{// Setup layer pointers to train encoder and decoder}
199   encoder\_children[0] = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[decoder\_start];
200   decoder\_parents[0] = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[encoder\_end-1];
201   decoder\_children[0] = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction};
202   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction}->\hyperlink{classlbann_1_1Layer_a326668ce624a9bcc719a463820b2e3a4}{add\_parent\_layer}(\hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[decoder\_end-1]);
203 
204   \textcolor{comment}{// Set objective function to reconstruction layer}
205   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} term : \hyperlink{classlbann_1_1model_a24c50e7108dd7698671aed7df5b22e8b}{m\_objective\_function}->\hyperlink{classlbann_1_1objective__function_a510544e9e511be54a50efd39226de345}{get\_terms}()) \{
206     \textcolor{keyword}{auto}* loss = \textcolor{keyword}{dynamic\_cast<}loss\_function*\textcolor{keyword}{>}(term);
207     \textcolor{keywordflow}{if} (loss != \textcolor{keyword}{nullptr}) \{
208       loss->set\_target\_layer((generic\_target\_layer*) \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}{m\_reconstruction});
209     \}
210   \}
211 
212 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a5f237f1f6285475c5493a7d15dc32096_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a5f237f1f6285475c5493a7d15dc32096_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a115607e435ae4685531a81852ce01fe7}\label{classlbann_1_1greedy__layerwise__autoencoder_a115607e435ae4685531a81852ce01fe7}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!setup\+\_\+layer\+\_\+topology@{setup\+\_\+layer\+\_\+topology}}
\index{setup\+\_\+layer\+\_\+topology@{setup\+\_\+layer\+\_\+topology}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{setup\+\_\+layer\+\_\+topology()}{setup\_layer\_topology()}}
{\footnotesize\ttfamily void lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::setup\+\_\+layer\+\_\+topology (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Set up topology of layer graph. Called in setup function. Determine model sections. 

Reimplemented from \hyperlink{classlbann_1_1sequential__model_a3801a58530388fb6a8cb3e1c018e827d}{lbann\+::sequential\+\_\+model}.



Definition at line 66 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
66                                                         \{
67   \hyperlink{classlbann_1_1sequential__model_a3801a58530388fb6a8cb3e1c018e827d}{sequential\_model::setup\_layer\_topology}();
68 
69   \textcolor{comment}{// Divide model into sections}
70   \textcolor{comment}{// Note: first half are encoder sections and second half are decoder}
71   \textcolor{comment}{// sections}
72   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 1; i < \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.size() - 1; ++i) \{
73     \textcolor{keywordflow}{if} (dynamic\_cast<learning\_layer*>(\hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i]) != \textcolor{keyword}{nullptr}) \{
74       \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}.push\_back(i);
75     \}
76   \}
77   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}.push\_back(\hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.size() - 1);
78   \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_sections = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}.size() - 1;
79   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}{m\_num\_phases} = (num\_sections + 1) / 2;
80 
81   \textcolor{comment}{// Check that section input and output dimensions are valid}
82   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}{m\_num\_phases}; ++i) \{
83 
84     \textcolor{comment}{// Beginning and end of encoder and decoder}
85     \textcolor{keyword}{const} \textcolor{keywordtype}{int} encoder\_start = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[i];
86     \textcolor{keyword}{const} \textcolor{keywordtype}{int} encoder\_end = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[i+1];
87     \textcolor{keyword}{const} \textcolor{keywordtype}{int} decoder\_start = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[num\_sections-i-1];
88     \textcolor{keyword}{const} \textcolor{keywordtype}{int} decoder\_end = \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}{m\_sections}[num\_sections-i];
89 
90     \textcolor{comment}{// Encoder input and decoder output should match}
91     std::vector<int> input\_dims, output\_dims;
92     input\_dims = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[encoder\_start]->get\_prev\_neuron\_dims();
93     output\_dims = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[decoder\_end-1]->get\_neuron\_dims();
94     \textcolor{keywordflow}{if} (input\_dims != output\_dims) \{
95       std::stringstream err;
96       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
97           << \textcolor{stringliteral}{"input dimensions of layer "} << \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[encoder\_start]->get\_name()
98           << \textcolor{stringliteral}{" ("} << input\_dims[0];
99       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 1; j < input\_dims.size(); ++i) \{
100         err << \textcolor{stringliteral}{"x"} << input\_dims[j];
101       \}
102       err << \textcolor{stringliteral}{") does not match "}
103           << \textcolor{stringliteral}{"output dimensions of layer "} << \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[decoder\_end-1]->get\_name()
104           << \textcolor{stringliteral}{" ("} << output\_dims[0];
105       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 1; j < output\_dims.size(); ++i) \{
106         err << \textcolor{stringliteral}{"x"} << output\_dims[j];
107       \}
108       err << \textcolor{stringliteral}{")"};
109       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
110     \}
111 
112     \textcolor{comment}{// Encoder output and decoder input should match}
113     output\_dims = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[encoder\_end-1]->get\_neuron\_dims();
114     input\_dims = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[decoder\_start]->get\_prev\_neuron\_dims();
115     \textcolor{keywordflow}{if} (input\_dims != output\_dims) \{
116       std::stringstream err;
117       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
118           << \textcolor{stringliteral}{"output dimensions of layer "} << \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[encoder\_end-1]->get\_name()
119           << \textcolor{stringliteral}{" ("} << output\_dims[0];
120       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 1; j < output\_dims.size(); ++i) \{
121         err << \textcolor{stringliteral}{"x"} << output\_dims[j];
122       \}
123       err << \textcolor{stringliteral}{") does not match "}
124           << \textcolor{stringliteral}{"input dimensions of layer "} << \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[decoder\_start]->get\_name()
125           << \textcolor{stringliteral}{" ("} << input\_dims[0];
126       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 1; j < input\_dims.size(); ++i) \{
127         err << \textcolor{stringliteral}{"x"} << input\_dims[j];
128       \}
129       err << \textcolor{stringliteral}{")"};
130       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
131     \}
132 
133   \}
134 
135 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a115607e435ae4685531a81852ce01fe7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a085f0b2debb82d9c4927a1c8b11dd353}\label{classlbann_1_1greedy__layerwise__autoencoder_a085f0b2debb82d9c4927a1c8b11dd353}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!train@{train}}
\index{train@{train}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{train()}{train()}}
{\footnotesize\ttfamily void lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::train (\begin{DoxyParamCaption}\item[{int}]{num\+\_\+epochs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Train greedy layerwise autoencoder. 

Reimplemented from \hyperlink{classlbann_1_1model_a11c79dc3783d11b799bdc40ff9c92ddc}{lbann\+::model}.



Definition at line 137 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp.


\begin{DoxyCode}
137                                                        \{
138   \hyperlink{classlbann_1_1model_a780395fa740102adda5537aa5d257698}{do\_train\_begin\_cbs}();
139 
140   \textcolor{comment}{// Train each autoencoder phase on several epochs}
141   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} phase = 0; phase < \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}{m\_num\_phases}; ++phase) \{
142     \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a5f237f1f6285475c5493a7d15dc32096}{set\_phase}(phase);
143     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} epoch = 0; epoch < num\_epochs / \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}{m\_num\_phases}; ++epoch) \{
144       \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1model_a90363b6a20269cf7197701e49f1f52a3}{get\_terminate\_training}()) \{ \textcolor{keywordflow}{goto} train\_end; \}
145       \hyperlink{classlbann_1_1model_a5d188d75f53e0a4c6161500181b27c03}{reset\_mode\_and\_model}(\hyperlink{base_8hpp_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214}{execution\_mode::training});
146       \hyperlink{classlbann_1_1model_a6f975af3ff4921d78a9eb1aca12eaf5e}{do\_epoch\_begin\_cbs}();
147       \textcolor{keywordflow}{while} (!\hyperlink{classlbann_1_1model_a462105993a63277a1ead39c30ebae1bb}{train\_mini\_batch}()) \{\}
148       \hyperlink{classlbann_1_1model_a4191097fdbcd1686525e9cd150f958ef}{evaluate}(\hyperlink{base_8hpp_a2781a159088df64ed7d47cc91c4dc0a8aa617908b172c473cb8e8cda059e55bf0}{execution\_mode::validation});
149       \hyperlink{classlbann_1_1model_a305fac94b9063e59198c7f936923221a}{m\_current\_epoch}++;
150       \hyperlink{classlbann_1_1model_a93e43a6c5aaf8ad890ef50ff97dfa176}{do\_epoch\_end\_cbs}();
151       \hyperlink{classlbann_1_1model_a9c6e9c199ca0ae06b8cf7266971ab9c3}{reset\_epoch\_statistics}(\hyperlink{base_8hpp_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214}{execution\_mode::training});
152     \}
153   \}
154 
155  train\_end:
156   \hyperlink{classlbann_1_1greedy__layerwise__autoencoder_a82b8ced756904a2423a65cd0e329b4e2}{restore\_sequential\_model}();
157   \hyperlink{classlbann_1_1model_a13bb6edae42c719b78454a8af9549122}{do\_train\_end\_cbs}();
158 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a085f0b2debb82d9c4927a1c8b11dd353_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1greedy__layerwise__autoencoder_a085f0b2debb82d9c4927a1c8b11dd353_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}\label{classlbann_1_1greedy__layerwise__autoencoder_a792010a00136ee1e024b6e5d38c77386}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!m\+\_\+num\+\_\+phases@{m\+\_\+num\+\_\+phases}}
\index{m\+\_\+num\+\_\+phases@{m\+\_\+num\+\_\+phases}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{m\+\_\+num\+\_\+phases}{m\_num\_phases}}
{\footnotesize\ttfamily int lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::m\+\_\+num\+\_\+phases\hspace{0.3cm}{\ttfamily [protected]}}

Number of training phases. 

Definition at line 69 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp.

\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}\label{classlbann_1_1greedy__layerwise__autoencoder_a1baf1b5e7fdb5d006f443edbb0bb2973}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!m\+\_\+phase@{m\+\_\+phase}}
\index{m\+\_\+phase@{m\+\_\+phase}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{m\+\_\+phase}{m\_phase}}
{\footnotesize\ttfamily int lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::m\+\_\+phase\hspace{0.3cm}{\ttfamily [protected]}}

Current training phase. If negative, the model is sequential. 

Definition at line 67 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp.

\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}\label{classlbann_1_1greedy__layerwise__autoencoder_a8238d2e3e723543c8b6f7f5c61a9ca06}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!m\+\_\+reconstruction@{m\+\_\+reconstruction}}
\index{m\+\_\+reconstruction@{m\+\_\+reconstruction}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{m\+\_\+reconstruction}{m\_reconstruction}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1Layer}{Layer}$\ast$ lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::m\+\_\+reconstruction\hspace{0.3cm}{\ttfamily [protected]}}

Reconstruction layer for training phases. 

Definition at line 78 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp.

\mbox{\Hypertarget{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}\label{classlbann_1_1greedy__layerwise__autoencoder_aacb3dbf01c38f46a32927722420c5d41}} 
\index{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}!m\+\_\+sections@{m\+\_\+sections}}
\index{m\+\_\+sections@{m\+\_\+sections}!lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder@{lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder}}
\subsubsection{\texorpdfstring{m\+\_\+sections}{m\_sections}}
{\footnotesize\ttfamily std\+::vector$<$int$>$ lbann\+::greedy\+\_\+layerwise\+\_\+autoencoder\+::m\+\_\+sections\hspace{0.3cm}{\ttfamily [protected]}}

\hyperlink{classlbann_1_1Layer}{Layer} indices for the boundaries of model sections. The first half sections are considered as encoders and the second half as decoders. Each training phase consists of training an encoder and decoder while keeping the rest of the model frozen. 

Definition at line 76 of file greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/models/\hyperlink{greedy__layerwise__autoencoder_8hpp}{greedy\+\_\+layerwise\+\_\+autoencoder.\+hpp}\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/src/models/\hyperlink{greedy__layerwise__autoencoder_8cpp}{greedy\+\_\+layerwise\+\_\+autoencoder.\+cpp}\end{DoxyCompactItemize}
