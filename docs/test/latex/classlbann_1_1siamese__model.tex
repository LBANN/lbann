\hypertarget{classlbann_1_1siamese__model}{}\section{lbann\+:\+:siamese\+\_\+model Class Reference}
\label{classlbann_1_1siamese__model}\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}


{\ttfamily \#include $<$siamese.\+hpp$>$}



Inheritance diagram for lbann\+:\+:siamese\+\_\+model\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{classlbann_1_1siamese__model__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for lbann\+:\+:siamese\+\_\+model\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1siamese__model__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1siamese__model_af8ca6d6da679f39489f0c50b62ad0069}{siamese\+\_\+model} (\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm}, int mini\+\_\+batch\+\_\+size, \hyperlink{classlbann_1_1objective__function}{objective\+\_\+function} $\ast$obj\+\_\+fn, \hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$default\+\_\+optimizer, int num\+\_\+heads)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\hyperlink{classlbann_1_1siamese__model_a7222db907cdbb05a77f8af9cdf3fd2bc}{siamese\+\_\+model} (const \hyperlink{classlbann_1_1siamese__model}{siamese\+\_\+model} \&other)=default
\item 
\hyperlink{classlbann_1_1siamese__model}{siamese\+\_\+model} \& \hyperlink{classlbann_1_1siamese__model_a7651735d313d7625da89b290cb8e59ee}{operator=} (const \hyperlink{classlbann_1_1siamese__model}{siamese\+\_\+model} \&other)=default
\item 
\hyperlink{classlbann_1_1siamese__model_acf88f0dca9386f33311947fe0569c547}{$\sim$siamese\+\_\+model} () override=default
\item 
\hyperlink{classlbann_1_1siamese__model}{siamese\+\_\+model} $\ast$ \hyperlink{classlbann_1_1siamese__model_a26bbedec5306e47e214124cca2cb381b}{copy} () const override
\item 
std\+::string \hyperlink{classlbann_1_1siamese__model_ad745961977aa395e11543d263103126e}{name} () const override
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classlbann_1_1siamese__model_a3960a32fd45059516f3acb41549e1e92}{freeze\+\_\+layers\+\_\+under\+\_\+frozen\+\_\+surface} () override
\item 
void \hyperlink{classlbann_1_1siamese__model_a7ff41cffb060500605124959f1a2a6cf}{setup\+\_\+layer\+\_\+topology} () override
\item 
void \hyperlink{classlbann_1_1siamese__model_afefdbaf473d40e571b2b58539001c9c0}{setup\+\_\+layers} () override
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classlbann_1_1siamese__model_ad0d7ba3cf40120b4f8e32675c5e9b3db}{m\+\_\+num\+\_\+heads}
\item 
std\+::unordered\+\_\+map$<$ \hyperlink{classlbann_1_1Layer}{Layer} $\ast$, \hyperlink{classlbann_1_1Layer}{Layer} $\ast$ $>$ \hyperlink{classlbann_1_1siamese__model_aae7af40b4a2db59082cd4c9149a1affd}{m\+\_\+follower\+\_\+to\+\_\+master\+\_\+layer}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 36 of file siamese.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1siamese__model_af8ca6d6da679f39489f0c50b62ad0069}\label{classlbann_1_1siamese__model_af8ca6d6da679f39489f0c50b62ad0069}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!siamese\+\_\+model@{siamese\+\_\+model}}
\index{siamese\+\_\+model@{siamese\+\_\+model}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{siamese\+\_\+model()}{siamese\_model()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily lbann\+::siamese\+\_\+model\+::siamese\+\_\+model (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1lbann__comm}{lbann\+\_\+comm} $\ast$}]{comm,  }\item[{int}]{mini\+\_\+batch\+\_\+size,  }\item[{\hyperlink{classlbann_1_1objective__function}{objective\+\_\+function} $\ast$}]{obj\+\_\+fn,  }\item[{\hyperlink{classlbann_1_1optimizer}{optimizer} $\ast$}]{default\+\_\+optimizer,  }\item[{int}]{num\+\_\+heads }\end{DoxyParamCaption})}



Constructor. 



Definition at line 34 of file siamese.\+cpp.


\begin{DoxyCode}
39   : \hyperlink{classlbann_1_1directed__acyclic__graph__model_a2b5f8058b341073a0a95d4882fb4ff52}{directed\_acyclic\_graph\_model}(\hyperlink{file__io_8cpp_ab048c6f9fcbcfaa57ce68b00263dbebe}{comm}, mini\_batch\_size, obj\_fn, 
      default\_optimizer),
40     \hyperlink{classlbann_1_1siamese__model_ad0d7ba3cf40120b4f8e32675c5e9b3db}{m\_num\_heads}(num\_heads) \{\}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=348pt]{classlbann_1_1siamese__model_af8ca6d6da679f39489f0c50b62ad0069_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1siamese__model_a7222db907cdbb05a77f8af9cdf3fd2bc}\label{classlbann_1_1siamese__model_a7222db907cdbb05a77f8af9cdf3fd2bc}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!siamese\+\_\+model@{siamese\+\_\+model}}
\index{siamese\+\_\+model@{siamese\+\_\+model}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{siamese\+\_\+model()}{siamese\_model()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily lbann\+::siamese\+\_\+model\+::siamese\+\_\+model (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1siamese__model}{siamese\+\_\+model} \&}]{other }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}

Copy constructor. \mbox{\Hypertarget{classlbann_1_1siamese__model_acf88f0dca9386f33311947fe0569c547}\label{classlbann_1_1siamese__model_acf88f0dca9386f33311947fe0569c547}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!````~siamese\+\_\+model@{$\sim$siamese\+\_\+model}}
\index{````~siamese\+\_\+model@{$\sim$siamese\+\_\+model}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{$\sim$siamese\+\_\+model()}{~siamese\_model()}}
{\footnotesize\ttfamily lbann\+::siamese\+\_\+model\+::$\sim$siamese\+\_\+model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [default]}}

Destructor. 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1siamese__model_a26bbedec5306e47e214124cca2cb381b}\label{classlbann_1_1siamese__model_a26bbedec5306e47e214124cca2cb381b}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!copy@{copy}}
\index{copy@{copy}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1siamese__model}{siamese\+\_\+model}$\ast$ lbann\+::siamese\+\_\+model\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Create copy. 

Reimplemented from \hyperlink{classlbann_1_1directed__acyclic__graph__model_a6a21050a732686e9e6c9f384ff9fda51}{lbann\+::directed\+\_\+acyclic\+\_\+graph\+\_\+model}.



Definition at line 54 of file siamese.\+hpp.


\begin{DoxyCode}
54 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{new} \hyperlink{classlbann_1_1siamese__model_af8ca6d6da679f39489f0c50b62ad0069}{siamese\_model}(*\textcolor{keyword}{this}); \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=348pt]{classlbann_1_1siamese__model_a26bbedec5306e47e214124cca2cb381b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1siamese__model_a3960a32fd45059516f3acb41549e1e92}\label{classlbann_1_1siamese__model_a3960a32fd45059516f3acb41549e1e92}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!freeze\+\_\+layers\+\_\+under\+\_\+frozen\+\_\+surface@{freeze\+\_\+layers\+\_\+under\+\_\+frozen\+\_\+surface}}
\index{freeze\+\_\+layers\+\_\+under\+\_\+frozen\+\_\+surface@{freeze\+\_\+layers\+\_\+under\+\_\+frozen\+\_\+surface}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{freeze\+\_\+layers\+\_\+under\+\_\+frozen\+\_\+surface()}{freeze\_layers\_under\_frozen\_surface()}}
{\footnotesize\ttfamily void lbann\+::siamese\+\_\+model\+::freeze\+\_\+layers\+\_\+under\+\_\+frozen\+\_\+surface (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

For Siamese models, users specify only the last layer to freeze in the model description prototext. Then, the layers that precedes it will automatically be frozen as well. 

Reimplemented from \hyperlink{classlbann_1_1directed__acyclic__graph__model_a9f2a6e9472235ec91c5a50356471b3cb}{lbann\+::directed\+\_\+acyclic\+\_\+graph\+\_\+model}.



Definition at line 42 of file siamese.\+cpp.


\begin{DoxyCode}
42                                                        \{
43   \textcolor{comment}{// Assuming m\_layers is topologically sorted}
44   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.size(); i-- > 0u; ) \{
45     \textcolor{keyword}{const} \textcolor{keyword}{auto} layer = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i];
46     \textcolor{keywordflow}{if} (layer->is\_frozen()) \{
47       \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& parent : layer->get\_parent\_layers()) \{
48         \textcolor{keywordflow}{if} (dynamic\_cast<const io\_layer*>(parent) == \textcolor{keyword}{nullptr}) \{
49           \textcolor{keyword}{const\_cast<}Layer *\textcolor{keyword}{>}(parent)->freeze();
50         \}
51       \}
52     \}
53   \}
54 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1siamese__model_a3960a32fd45059516f3acb41549e1e92_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1siamese__model_ad745961977aa395e11543d263103126e}\label{classlbann_1_1siamese__model_ad745961977aa395e11543d263103126e}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!name@{name}}
\index{name@{name}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{name()}{name()}}
{\footnotesize\ttfamily std\+::string lbann\+::siamese\+\_\+model\+::name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Get model name. 

Reimplemented from \hyperlink{classlbann_1_1directed__acyclic__graph__model_ad2b97ab2670e76538a754e28e19b5c94}{lbann\+::directed\+\_\+acyclic\+\_\+graph\+\_\+model}.



Definition at line 57 of file siamese.\+hpp.


\begin{DoxyCode}
57 \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"siamese\_model"}; \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1siamese__model_ad745961977aa395e11543d263103126e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1siamese__model_a7651735d313d7625da89b290cb8e59ee}\label{classlbann_1_1siamese__model_a7651735d313d7625da89b290cb8e59ee}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1siamese__model}{siamese\+\_\+model}\& lbann\+::siamese\+\_\+model\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1siamese__model}{siamese\+\_\+model} \&}]{other }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}

Copy assignment operator. \mbox{\Hypertarget{classlbann_1_1siamese__model_a7ff41cffb060500605124959f1a2a6cf}\label{classlbann_1_1siamese__model_a7ff41cffb060500605124959f1a2a6cf}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!setup\+\_\+layer\+\_\+topology@{setup\+\_\+layer\+\_\+topology}}
\index{setup\+\_\+layer\+\_\+topology@{setup\+\_\+layer\+\_\+topology}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{setup\+\_\+layer\+\_\+topology()}{setup\_layer\_topology()}}
{\footnotesize\ttfamily void lbann\+::siamese\+\_\+model\+::setup\+\_\+layer\+\_\+topology (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Set up topology of Siamese network. Called in setup function. Determines the network\textquotesingle{}s master head and duplicates it. \begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000003}{Todo}]Handle case where heads have already been initialized. \end{DoxyRefDesc}


Reimplemented from \hyperlink{classlbann_1_1model_a7b3e2a643c658dcaa7478d2568f29784}{lbann\+::model}.



Definition at line 56 of file siamese.\+cpp.


\begin{DoxyCode}
56                                          \{
57 
59   \hyperlink{classlbann_1_1siamese__model_aae7af40b4a2db59082cd4c9149a1affd}{m\_follower\_to\_master\_layer}.clear();
60 
61   \textcolor{comment}{// Initialize network with master head}
62   \hyperlink{classlbann_1_1model_a7b3e2a643c658dcaa7478d2568f29784}{directed\_acyclic\_graph\_model::setup\_layer\_topology}();
63   \hyperlink{classlbann_1_1directed__acyclic__graph__model_a2a70d5719832c481db9fa962f6e5f2bd}{setup\_layer\_execution\_order}();
64 
65   \textcolor{comment}{// Determine layers in master head}
66   \textcolor{keywordtype}{int} heads\_start = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.size();
67   \textcolor{keywordtype}{int} heads\_end = -1;
68   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.size(); ++i) \{
69     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i]->get\_expected\_num\_child\_layers() < 0) \{
70       heads\_start = i + 1;
71       \textcolor{keywordflow}{break};
72     \}
73   \}
74   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.size() - 1; i >= 0; --i) \{
75     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}[i]->get\_expected\_num\_parent\_layers() < 0) \{
76       heads\_end = i;
77       \textcolor{keywordflow}{break};
78     \}
79   \}
80   \textcolor{keywordflow}{if} (heads\_start > heads\_end) \{
81     std::stringstream err;
82     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "}
83         << \textcolor{stringliteral}{"siamese models must have a fan-out layer before a fan-in layer "}
84         << \textcolor{stringliteral}{"(found fan-out layer at position "} << heads\_start - 1
85         << \textcolor{stringliteral}{" and fan-in layer at position "} << heads\_end << \textcolor{stringliteral}{")"};
86     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
87   \}
88   std::vector<Layer*> master\_head(\hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.begin() + heads\_start,
89                                   \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}.begin() + heads\_end);
90 
91   \textcolor{comment}{// Construct map from follower layers to master layers}
92   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& layer : \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}) \{
93     \hyperlink{classlbann_1_1siamese__model_aae7af40b4a2db59082cd4c9149a1affd}{m\_follower\_to\_master\_layer}[layer] = layer;
94   \}
95 
96   \textcolor{comment}{// Duplicate master head}
97   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < \hyperlink{classlbann_1_1siamese__model_ad0d7ba3cf40120b4f8e32675c5e9b3db}{m\_num\_heads}; ++i) \{
98     std::string name\_suffix = \textcolor{stringliteral}{"\_head"} + std::to\_string(i);
99 
100     \textcolor{comment}{// Construct map from master layers to follower layers}
101     std::unordered\_map<Layer*,Layer*> master\_to\_follower\_layer;
102     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& master\_layer : m\_layers) \{
103       master\_to\_follower\_layer[master\_layer] = master\_layer;
104     \}
105 
106     \textcolor{comment}{// Construct follower head by copying layers in master head}
107     std::vector<Layer*> follower\_head;
108     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& master\_layer : master\_head) \{
109       Layer* follower\_layer = master\_layer->copy();
110       follower\_layer->set\_name(follower\_layer->get\_name() + name\_suffix);
111       follower\_head.push\_back(follower\_layer);
112       master\_to\_follower\_layer[master\_layer] = follower\_layer;
113       \hyperlink{classlbann_1_1siamese__model_aae7af40b4a2db59082cd4c9149a1affd}{m\_follower\_to\_master\_layer}[follower\_layer] = master\_layer;
114     \}
115 
116     \textcolor{comment}{// Fix pointers in follower head}
117     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& follower\_layer : follower\_head) \{
118       \textcolor{keyword}{auto} layer\_pointers = follower\_layer->get\_layer\_pointers();
119       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}& layer\_pointer : layer\_pointers) \{
120         layer\_pointer = master\_to\_follower\_layer[layer\_pointer];
121       \}
122       follower\_layer->set\_layer\_pointers(layer\_pointers);
123     \}
124 
125     \textcolor{comment}{// Fix pointers at start and end of head}
126     m\_layers[heads\_start-1]->add\_child\_layer(follower\_head.front());
127     m\_layers[heads\_end]->add\_parent\_layer(follower\_head.back());
128 
129     \textcolor{comment}{// Add follower head to model}
130     m\_layers.insert(m\_layers.begin() + heads\_end,
131                     follower\_head.begin(),
132                     follower\_head.end());
133     heads\_end += follower\_head.size();
134 
135   \}
136 
137   \textcolor{comment}{// Rename layers in master head}
138   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& layer : master\_head) \{
139     layer->set\_name(layer->get\_name() + \textcolor{stringliteral}{"\_head0"});
140   \}
141 
142   \textcolor{comment}{// Make sure all parent/child relationships are reciprocated}
143   \hyperlink{classlbann_1_1model_a7b3e2a643c658dcaa7478d2568f29784}{directed\_acyclic\_graph\_model::setup\_layer\_topology}();
144 
145   \hyperlink{classlbann_1_1siamese__model_a3960a32fd45059516f3acb41549e1e92}{freeze\_layers\_under\_frozen\_surface}();
146 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1siamese__model_a7ff41cffb060500605124959f1a2a6cf_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{classlbann_1_1siamese__model_a7ff41cffb060500605124959f1a2a6cf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1siamese__model_afefdbaf473d40e571b2b58539001c9c0}\label{classlbann_1_1siamese__model_afefdbaf473d40e571b2b58539001c9c0}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!setup\+\_\+layers@{setup\+\_\+layers}}
\index{setup\+\_\+layers@{setup\+\_\+layers}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{setup\+\_\+layers()}{setup\_layers()}}
{\footnotesize\ttfamily void lbann\+::siamese\+\_\+model\+::setup\+\_\+layers (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Set up layers. Called in setup function. Layers in follower heads share weights with corresponding layers in master head. 

Reimplemented from \hyperlink{classlbann_1_1model_a989ab581e359f65c9238d627cce5b589}{lbann\+::model}.



Definition at line 148 of file siamese.\+cpp.


\begin{DoxyCode}
148                                  \{
149   \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}& layer : \hyperlink{classlbann_1_1model_a0229fc226ec163d1411548446104569d}{m\_layers}) \{
150     layer->set\_weights(\hyperlink{classlbann_1_1siamese__model_aae7af40b4a2db59082cd4c9149a1affd}{m\_follower\_to\_master\_layer}[layer]->
      \hyperlink{classlbann_1_1model_ac0a89794f1f51e7c502fff2745c973e6}{get\_weights}());
151     layer->set\_model(\textcolor{keyword}{this});
152     layer->setup();
153     layer->check\_setup();
154     \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1model_a0eabaf2b2f829fd5db3dfd26df420df0}{m\_comm}->\hyperlink{classlbann_1_1lbann__comm_a1ef526486183a29feadca9bef096a534}{am\_world\_master}()) \{
155       std::cout << \hyperlink{classlbann_1_1model_ab173fd93a80a2980059ff292c308cbf5}{print\_layer\_description}(layer) << std::endl;
156     \}
157   \}
158 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1siamese__model_afefdbaf473d40e571b2b58539001c9c0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=348pt]{classlbann_1_1siamese__model_afefdbaf473d40e571b2b58539001c9c0_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classlbann_1_1siamese__model_aae7af40b4a2db59082cd4c9149a1affd}\label{classlbann_1_1siamese__model_aae7af40b4a2db59082cd4c9149a1affd}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!m\+\_\+follower\+\_\+to\+\_\+master\+\_\+layer@{m\+\_\+follower\+\_\+to\+\_\+master\+\_\+layer}}
\index{m\+\_\+follower\+\_\+to\+\_\+master\+\_\+layer@{m\+\_\+follower\+\_\+to\+\_\+master\+\_\+layer}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{m\+\_\+follower\+\_\+to\+\_\+master\+\_\+layer}{m\_follower\_to\_master\_layer}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$\hyperlink{classlbann_1_1Layer}{Layer} $\ast$, \hyperlink{classlbann_1_1Layer}{Layer} $\ast$$>$ lbann\+::siamese\+\_\+model\+::m\+\_\+follower\+\_\+to\+\_\+master\+\_\+layer\hspace{0.3cm}{\ttfamily [private]}}

Map from follower to master layers. Layers in follower heads map to corresponding layers in master head. All other layers map to themselves. 

Definition at line 87 of file siamese.\+hpp.

\mbox{\Hypertarget{classlbann_1_1siamese__model_ad0d7ba3cf40120b4f8e32675c5e9b3db}\label{classlbann_1_1siamese__model_ad0d7ba3cf40120b4f8e32675c5e9b3db}} 
\index{lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}!m\+\_\+num\+\_\+heads@{m\+\_\+num\+\_\+heads}}
\index{m\+\_\+num\+\_\+heads@{m\+\_\+num\+\_\+heads}!lbann\+::siamese\+\_\+model@{lbann\+::siamese\+\_\+model}}
\subsubsection{\texorpdfstring{m\+\_\+num\+\_\+heads}{m\_num\_heads}}
{\footnotesize\ttfamily int lbann\+::siamese\+\_\+model\+::m\+\_\+num\+\_\+heads\hspace{0.3cm}{\ttfamily [private]}}

The number of heads in Siamese model. 

Definition at line 81 of file siamese.\+hpp.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/models/\hyperlink{siamese_8hpp}{siamese.\+hpp}\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/src/models/\hyperlink{siamese_8cpp}{siamese.\+cpp}\end{DoxyCompactItemize}
