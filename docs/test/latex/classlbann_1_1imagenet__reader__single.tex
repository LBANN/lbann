\hypertarget{classlbann_1_1imagenet__reader__single}{}\section{lbann\+:\+:imagenet\+\_\+reader\+\_\+single Class Reference}
\label{classlbann_1_1imagenet__reader__single}\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}


{\ttfamily \#include $<$data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp$>$}



Inheritance diagram for lbann\+:\+:imagenet\+\_\+reader\+\_\+single\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=213pt]{classlbann_1_1imagenet__reader__single__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for lbann\+:\+:imagenet\+\_\+reader\+\_\+single\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1imagenet__reader__single_ac42ce78ac5d191d571443dfea1f9d2ec}{imagenet\+\_\+reader\+\_\+single} (const std\+::shared\+\_\+ptr$<$ cv\+\_\+process $>$ \&pp, bool shuffle=true)
\item 
\hyperlink{classlbann_1_1imagenet__reader__single_abf3174dec9942137107faf6ef4d24e37}{imagenet\+\_\+reader\+\_\+single} (const \hyperlink{classlbann_1_1imagenet__reader__single}{imagenet\+\_\+reader\+\_\+single} \&source)
\item 
\hyperlink{classlbann_1_1imagenet__reader__single}{imagenet\+\_\+reader\+\_\+single} \& \hyperlink{classlbann_1_1imagenet__reader__single_af38327f44f1de2dd191cd2d1dc193900}{operator=} (const \hyperlink{classlbann_1_1imagenet__reader__single}{imagenet\+\_\+reader\+\_\+single} \&source)
\item 
\hyperlink{classlbann_1_1imagenet__reader__single_a6849f7af5ad0197f077f60c86a3c6c26}{$\sim$imagenet\+\_\+reader\+\_\+single} () override
\item 
\hyperlink{classlbann_1_1imagenet__reader__single}{imagenet\+\_\+reader\+\_\+single} $\ast$ \hyperlink{classlbann_1_1imagenet__reader__single_ac19ea9ae8887d86ef616099c2d93d699}{copy} () const override
\item 
std\+::string \hyperlink{classlbann_1_1imagenet__reader__single_aecd9cec6777e4a7485daa5b0396afee0}{get\+\_\+type} () const override
\item 
void \hyperlink{classlbann_1_1imagenet__reader__single_a7ea768d9784b7a9532551d7402ee4f8e}{load} () override
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classlbann_1_1imagenet__reader__single_a77c576d6085d4a8674322275dd9bd133}{fetch\+\_\+datum} (\hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} \&X, int data\+\_\+id, int mb\+\_\+idx, int tid) override
\item 
bool \hyperlink{classlbann_1_1imagenet__reader__single_a17b2e9f767fe36097acbc4600ce4e480}{fetch\+\_\+label} (\hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} \&Y, int data\+\_\+id, int mb\+\_\+idx, int tid) override
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classlbann_1_1imagenet__reader__single_a8db14d15bfc2de92ffb3c20f1a38dd00}{open\+\_\+data\+\_\+stream} ()
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::vector$<$ std\+::ifstream $\ast$ $>$ \hyperlink{classlbann_1_1imagenet__reader__single_af617e1b0b019049682db6de6e01b05ca}{m\+\_\+data\+\_\+filestream}
\item 
size\+\_\+t \hyperlink{classlbann_1_1imagenet__reader__single_aa1a20a782f97e697d9d70371a5e33384}{m\+\_\+file\+\_\+size}
\item 
std\+::vector$<$ std\+::vector$<$ unsigned char $>$ $>$ \hyperlink{classlbann_1_1imagenet__reader__single_a499b197f1d985b592801de9adfe2d2f5}{m\+\_\+work\+\_\+buffer}
\item 
std\+::vector$<$ std\+::pair$<$ size\+\_\+t, int $>$ $>$ \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\+\_\+offsets}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 37 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_ac42ce78ac5d191d571443dfea1f9d2ec}\label{classlbann_1_1imagenet__reader__single_ac42ce78ac5d191d571443dfea1f9d2ec}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!imagenet\+\_\+reader\+\_\+single@{imagenet\+\_\+reader\+\_\+single}}
\index{imagenet\+\_\+reader\+\_\+single@{imagenet\+\_\+reader\+\_\+single}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{imagenet\+\_\+reader\+\_\+single()}{imagenet\_reader\_single()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily lbann\+::imagenet\+\_\+reader\+\_\+single\+::imagenet\+\_\+reader\+\_\+single (\begin{DoxyParamCaption}\item[{const std\+::shared\+\_\+ptr$<$ cv\+\_\+process $>$ \&}]{pp,  }\item[{bool}]{shuffle = {\ttfamily true} }\end{DoxyParamCaption})}



Definition at line 37 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp.


\begin{DoxyCode}
38   : \hyperlink{classlbann_1_1imagenet__reader_a642331b94cdc3caad8335d65d096141c}{imagenet\_reader}(pp, shuffle) \{
39 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_ac42ce78ac5d191d571443dfea1f9d2ec_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_abf3174dec9942137107faf6ef4d24e37}\label{classlbann_1_1imagenet__reader__single_abf3174dec9942137107faf6ef4d24e37}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!imagenet\+\_\+reader\+\_\+single@{imagenet\+\_\+reader\+\_\+single}}
\index{imagenet\+\_\+reader\+\_\+single@{imagenet\+\_\+reader\+\_\+single}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{imagenet\+\_\+reader\+\_\+single()}{imagenet\_reader\_single()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily lbann\+::imagenet\+\_\+reader\+\_\+single\+::imagenet\+\_\+reader\+\_\+single (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1imagenet__reader__single}{imagenet\+\_\+reader\+\_\+single} \&}]{source }\end{DoxyParamCaption})}



Definition at line 41 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp.


\begin{DoxyCode}
42   : \hyperlink{classlbann_1_1imagenet__reader_a642331b94cdc3caad8335d65d096141c}{imagenet\_reader}(source) \{
43   \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets} = source.m\_offsets;
44   \hyperlink{classlbann_1_1imagenet__reader__single_a8db14d15bfc2de92ffb3c20f1a38dd00}{open\_data\_stream}();
45 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_abf3174dec9942137107faf6ef4d24e37_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_a6849f7af5ad0197f077f60c86a3c6c26}\label{classlbann_1_1imagenet__reader__single_a6849f7af5ad0197f077f60c86a3c6c26}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!````~imagenet\+\_\+reader\+\_\+single@{$\sim$imagenet\+\_\+reader\+\_\+single}}
\index{````~imagenet\+\_\+reader\+\_\+single@{$\sim$imagenet\+\_\+reader\+\_\+single}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{$\sim$imagenet\+\_\+reader\+\_\+single()}{~imagenet\_reader\_single()}}
{\footnotesize\ttfamily lbann\+::imagenet\+\_\+reader\+\_\+single\+::$\sim$imagenet\+\_\+reader\+\_\+single (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}}



Definition at line 63 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp.


\begin{DoxyCode}
63                                                 \{
64   \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} & i : \hyperlink{classlbann_1_1imagenet__reader__single_af617e1b0b019049682db6de6e01b05ca}{m\_data\_filestream}) \{
65     \textcolor{keywordflow}{if} (i) \textcolor{keyword}{delete} i;
66   \}
67 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_ac19ea9ae8887d86ef616099c2d93d699}\label{classlbann_1_1imagenet__reader__single_ac19ea9ae8887d86ef616099c2d93d699}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!copy@{copy}}
\index{copy@{copy}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1imagenet__reader__single}{imagenet\+\_\+reader\+\_\+single}$\ast$ lbann\+::imagenet\+\_\+reader\+\_\+single\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Reimplemented from \hyperlink{classlbann_1_1imagenet__reader_a71be5220be24de5caf00d2e422b750f2}{lbann\+::imagenet\+\_\+reader}.



Definition at line 44 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp.


\begin{DoxyCode}
44 \{ \textcolor{keywordflow}{return} \textcolor{keyword}{new} \hyperlink{classlbann_1_1imagenet__reader__single_ac42ce78ac5d191d571443dfea1f9d2ec}{imagenet\_reader\_single}(*\textcolor{keyword}{this}); \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_ac19ea9ae8887d86ef616099c2d93d699_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_a77c576d6085d4a8674322275dd9bd133}\label{classlbann_1_1imagenet__reader__single_a77c576d6085d4a8674322275dd9bd133}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!fetch\+\_\+datum@{fetch\+\_\+datum}}
\index{fetch\+\_\+datum@{fetch\+\_\+datum}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{fetch\+\_\+datum()}{fetch\_datum()}}
{\footnotesize\ttfamily bool lbann\+::imagenet\+\_\+reader\+\_\+single\+::fetch\+\_\+datum (\begin{DoxyParamCaption}\item[{\hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} \&}]{X,  }\item[{int}]{data\+\_\+id,  }\item[{int}]{mb\+\_\+idx,  }\item[{int}]{tid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Fetch a single sample into a matrix. 
\begin{DoxyParams}{Parameters}
{\em X} & The matrix to load data into. \\
\hline
{\em data\+\_\+id} & The index of the datum to fetch. \\
\hline
{\em mb\+\_\+idx} & The index within the mini-\/batch. \\
\hline
\end{DoxyParams}


Reimplemented from \hyperlink{classlbann_1_1imagenet__reader_a6659e90c0243da40f214a877f65eb8ac}{lbann\+::imagenet\+\_\+reader}.



Definition at line 125 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp.


\begin{DoxyCode}
125                                                                                  \{
126   std::stringstream err;
127 
128   \textcolor{keywordflow}{if} (static\_cast<size\_t>(data\_id+1) >= \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.size()) \{
129     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: data\_id= "} << data\_id << \textcolor{stringliteral}{" is larger than m\_offsets.size()= 
      "} << \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.size() << \textcolor{stringliteral}{" -2"};
130     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
131   \}
132   \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} start = \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}[data\_id].first;
133   \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} end = \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}[data\_id+1].first;
134 
135   \textcolor{keywordflow}{if} (end > \hyperlink{classlbann_1_1imagenet__reader__single_aa1a20a782f97e697d9d70371a5e33384}{m\_file\_size}) \{
136     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: end= "} << end << \textcolor{stringliteral}{" is larger than m\_file\_size= "} << 
      \hyperlink{classlbann_1_1imagenet__reader__single_aa1a20a782f97e697d9d70371a5e33384}{m\_file\_size} << \textcolor{stringliteral}{" for P\_"} << \hyperlink{classlbann_1_1generic__data__reader_ab5321bd7c6e83845785753366e6d9e64}{get\_rank}() << \textcolor{stringliteral}{" with role: "} << 
      \hyperlink{classlbann_1_1generic__data__reader_a92982e1b399f37e2ead5aa440883cba5}{get\_role}() << \textcolor{stringliteral}{" m\_offsets.size(): "} << \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.size() << \textcolor{stringliteral}{" mb\_idx: "} << mb\_idx << \textcolor{stringliteral}{"
       data\_id: "} << data\_id;
137     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
138   \}
139 
140   \textcolor{keyword}{const} \textcolor{keywordtype}{int} ssz = end - start;
141 
142   \textcolor{keywordflow}{if} (ssz <= 0) \{
143     err << \textcolor{stringliteral}{"P\_"} << \hyperlink{classlbann_1_1generic__data__reader_ab5321bd7c6e83845785753366e6d9e64}{get\_rank}() << \textcolor{stringliteral}{" start: "} << start << \textcolor{stringliteral}{" end: "} << end << \textcolor{stringliteral}{" ssz= "} << ssz << \textcolor{stringliteral}{" is
       <= 0"};
144     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
145   \}
146 
147   \hyperlink{classlbann_1_1imagenet__reader__single_a499b197f1d985b592801de9adfe2d2f5}{m\_work\_buffer}[tid].resize(ssz);
148   \hyperlink{classlbann_1_1imagenet__reader__single_af617e1b0b019049682db6de6e01b05ca}{m\_data\_filestream}[tid]->seekg(start);
149   \hyperlink{classlbann_1_1imagenet__reader__single_af617e1b0b019049682db6de6e01b05ca}{m\_data\_filestream}[tid]->read((\textcolor{keywordtype}{char} *)&\hyperlink{classlbann_1_1imagenet__reader__single_a499b197f1d985b592801de9adfe2d2f5}{m\_work\_buffer}[tid][0], ssz);
150 
151   \textcolor{keywordtype}{int} width=0, height=0, img\_type=0;
152   \hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{::Mat} X\_v = \hyperlink{classlbann_1_1imagenet__reader_a5c0662ebaa378f7f5b4448f4d207e872}{create\_datum\_view}(X, mb\_idx);
153 
154   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} ret = \hyperlink{classlbann_1_1image__utils_a720f0987ec8eff333bf697ed18aafc93}{image\_utils::import\_image}(
      \hyperlink{classlbann_1_1imagenet__reader__single_a499b197f1d985b592801de9adfe2d2f5}{m\_work\_buffer}[tid], width, height, img\_type, *(\hyperlink{classlbann_1_1imagenet__reader_a1e0d0ed4ac529de3e9f735512f5e3dd8}{m\_pps}[tid]), X\_v);
155 
156   \textcolor{keywordflow}{if}(!ret) \{
157     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "} << \hyperlink{classlbann_1_1imagenet__reader__single_aecd9cec6777e4a7485daa5b0396afee0}{get\_type}() << \textcolor{stringliteral}{": image\_utils::import\_image
       failed to load index: "} << data\_id;
158     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
159   \}
160   \textcolor{keywordflow}{if} ((width * height * CV\_MAT\_CN(img\_type)) != \hyperlink{classlbann_1_1image__data__reader_af512f1f866c0f654309b7f28886dca9a}{m\_image\_linearized\_size}) \{
161     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_ << \textcolor{stringliteral}{" :: "} << \hyperlink{classlbann_1_1imagenet__reader__single_aecd9cec6777e4a7485daa5b0396afee0}{get\_type}() << \textcolor{stringliteral}{": mismatch data size -- either
       width, height or channel"};
162     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
163   \}
164 
165   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
166 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_a77c576d6085d4a8674322275dd9bd133_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_a77c576d6085d4a8674322275dd9bd133_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_a17b2e9f767fe36097acbc4600ce4e480}\label{classlbann_1_1imagenet__reader__single_a17b2e9f767fe36097acbc4600ce4e480}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!fetch\+\_\+label@{fetch\+\_\+label}}
\index{fetch\+\_\+label@{fetch\+\_\+label}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{fetch\+\_\+label()}{fetch\_label()}}
{\footnotesize\ttfamily bool lbann\+::imagenet\+\_\+reader\+\_\+single\+::fetch\+\_\+label (\begin{DoxyParamCaption}\item[{\hyperlink{base_8hpp_a68f11fdc31b62516cb310831bbe54d73}{Mat} \&}]{Y,  }\item[{int}]{data\+\_\+id,  }\item[{int}]{mb\+\_\+idx,  }\item[{int}]{tid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Fetch a single label into a matrix. 
\begin{DoxyParams}{Parameters}
{\em Y} & The matrix to load data into. \\
\hline
{\em data\+\_\+id} & The index of the datum to fetch. \\
\hline
{\em mb\+\_\+idx} & The index within the mini-\/batch. \\
\hline
\end{DoxyParams}


Reimplemented from \hyperlink{classlbann_1_1image__data__reader_a1f0dbd67390a65fef106515ea7060e29}{lbann\+::image\+\_\+data\+\_\+reader}.



Definition at line 168 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp.


\begin{DoxyCode}
168                                                                                  \{
169   \textcolor{keyword}{const} \textcolor{keywordtype}{int} label = \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}[data\_id+1].second;
170   Y.Set(label, mb\_idx, 1);
171   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
172 \}
\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_a17b2e9f767fe36097acbc4600ce4e480_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_aecd9cec6777e4a7485daa5b0396afee0}\label{classlbann_1_1imagenet__reader__single_aecd9cec6777e4a7485daa5b0396afee0}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!get\+\_\+type@{get\+\_\+type}}
\index{get\+\_\+type@{get\+\_\+type}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{get\+\_\+type()}{get\_type()}}
{\footnotesize\ttfamily std\+::string lbann\+::imagenet\+\_\+reader\+\_\+single\+::get\+\_\+type (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Return this data\+\_\+reader\textquotesingle{}s type 

Reimplemented from \hyperlink{classlbann_1_1imagenet__reader_a0afea0db8b4286b56211842f8f1d7678}{lbann\+::imagenet\+\_\+reader}.



Definition at line 46 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp.


\begin{DoxyCode}
46                                       \{
47     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"imagenet\_reader\_single"};
48   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_aecd9cec6777e4a7485daa5b0396afee0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_aecd9cec6777e4a7485daa5b0396afee0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_a7ea768d9784b7a9532551d7402ee4f8e}\label{classlbann_1_1imagenet__reader__single_a7ea768d9784b7a9532551d7402ee4f8e}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!load@{load}}
\index{load@{load}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily void lbann\+::imagenet\+\_\+reader\+\_\+single\+::load (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Load the dataset. Each data reader implementation should implement this to initialize its internal data structures, determine the number of samples and their dimensionality (if needed), and set up and shuffle samples. 

Reimplemented from \hyperlink{classlbann_1_1image__data__reader_a99cb80242d7d20bc1e8baeaff25ff790}{lbann\+::image\+\_\+data\+\_\+reader}.



Definition at line 69 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp.


\begin{DoxyCode}
69                                   \{
70   \textcolor{keyword}{const} std::string image\_dir = \hyperlink{classlbann_1_1generic__data__reader_ab4c6c2d4ba40ece809ce896828c8ff03}{get\_file\_dir}();
71   \textcolor{keyword}{const} std::string base\_filename = \hyperlink{classlbann_1_1generic__data__reader_a56664e1b43f3fe923cf6d652f14b40a9}{get\_data\_filename}();
72 
73   \textcolor{comment}{//open offsets file, with error checking}
74   std::stringstream b;
75   b << image\_dir << \textcolor{stringliteral}{"/"} << base\_filename << \textcolor{stringliteral}{"\_offsets.txt"};
76   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__reader_ae82c40eebc05e2f0c1198afcc7a7f009}{is\_master}()) \{
77     std::cout << \textcolor{stringliteral}{"opening: "} << b.str() << \textcolor{stringliteral}{" "} << std::endl;
78   \}
79   std::ifstream in(b.str().c\_str());
80   \textcolor{keywordflow}{if} (not in.is\_open() and in.good()) \{
81     std::stringstream err;
82     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_
83         << \textcolor{stringliteral}{" ::  failed to open "} << b.str() << \textcolor{stringliteral}{" for reading"};
84     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
85   \}
86 
87   \textcolor{comment}{//read the offsets file}
88   \textcolor{keywordtype}{size\_t} num\_images = 0u;
89   in >> num\_images;
90 
91   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__reader_ae82c40eebc05e2f0c1198afcc7a7f009}{is\_master}()) \{
92     std::cout << \textcolor{stringliteral}{"num images: "} << num\_images << std::endl;
93   \}
94 
95   \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.reserve(num\_images+1);
96   \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.emplace\_back(0,0);
97   \textcolor{keywordtype}{size\_t} last\_offset = 0u;
98   \textcolor{keywordtype}{size\_t} offset = 0u;
99   \textcolor{keywordtype}{int} label = 0;
100 
101   \textcolor{keywordflow}{while} (in >> offset >> label) \{
102     \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.emplace\_back(offset + last\_offset, label);
103     last\_offset = \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.back().first;
104   \}
105 
106   \textcolor{keywordflow}{if} (num\_images+1 != \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.size()) \{
107     std::stringstream err;
108     err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_
109         << \textcolor{stringliteral}{" ::  we read "} << \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets}.size() << \textcolor{stringliteral}{" offsets, but should have read "} << num\_images;
110     \textcolor{keywordflow}{throw} lbann\_exception(err.str());
111   \}
112   in.close();
113 
114   \hyperlink{classlbann_1_1imagenet__reader__single_a8db14d15bfc2de92ffb3c20f1a38dd00}{open\_data\_stream}();
115 
116   \hyperlink{classlbann_1_1generic__data__reader_aaab6aeff67ffff1c689336851fec2c57}{m\_shuffled\_indices}.resize(num\_images);
117   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} n = 0; n < num\_images; n++) \{
118     \hyperlink{classlbann_1_1generic__data__reader_aaab6aeff67ffff1c689336851fec2c57}{m\_shuffled\_indices}[n] = n;
119   \}
120 
121   \hyperlink{classlbann_1_1generic__data__reader_aa28fdeeb6af492540f507e49adff5d6c}{select\_subset\_of\_data}();
122 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_a7ea768d9784b7a9532551d7402ee4f8e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_a7ea768d9784b7a9532551d7402ee4f8e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_a8db14d15bfc2de92ffb3c20f1a38dd00}\label{classlbann_1_1imagenet__reader__single_a8db14d15bfc2de92ffb3c20f1a38dd00}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!open\+\_\+data\+\_\+stream@{open\+\_\+data\+\_\+stream}}
\index{open\+\_\+data\+\_\+stream@{open\+\_\+data\+\_\+stream}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{open\+\_\+data\+\_\+stream()}{open\_data\_stream()}}
{\footnotesize\ttfamily void lbann\+::imagenet\+\_\+reader\+\_\+single\+::open\+\_\+data\+\_\+stream (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 174 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp.


\begin{DoxyCode}
174                                               \{
175   \textcolor{keyword}{const} std::string image\_dir = \hyperlink{classlbann_1_1generic__data__reader_ab4c6c2d4ba40ece809ce896828c8ff03}{get\_file\_dir}();
176   \textcolor{keyword}{const} std::string base\_filename = \hyperlink{classlbann_1_1generic__data__reader_a56664e1b43f3fe923cf6d652f14b40a9}{get\_data\_filename}();
177 
178   std::stringstream b;
179   b << image\_dir << \textcolor{stringliteral}{"/"} << base\_filename << \textcolor{stringliteral}{"\_data.bin"};
180   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1generic__data__reader_ae82c40eebc05e2f0c1198afcc7a7f009}{is\_master}()) \{
181     std::cout << \textcolor{stringliteral}{"opening: "} << b.str() << \textcolor{stringliteral}{" "} << std::endl;
182   \}
183 
184   \textcolor{keyword}{const} \textcolor{keywordtype}{int} nthreads = omp\_get\_max\_threads();
185   \hyperlink{classlbann_1_1imagenet__reader__single_a499b197f1d985b592801de9adfe2d2f5}{m\_work\_buffer}.resize(nthreads);
186 
187   \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} & i : \hyperlink{classlbann_1_1imagenet__reader__single_af617e1b0b019049682db6de6e01b05ca}{m\_data\_filestream}) \{
188     \textcolor{keywordflow}{if} (i) \textcolor{keyword}{delete} i;
189   \}
190   m\_data\_filestream.clear();
191   m\_data\_filestream.resize(nthreads);
192 
193 \textcolor{preprocessor}{  #pragma omp parallel for schedule(static, 1)}
194   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i < nthreads; ++i) \{
195     m\_data\_filestream[i] = \textcolor{keyword}{new} std::ifstream(b.str().c\_str(), std::ios::in | std::ios::binary);
196     \textcolor{keywordflow}{if} (m\_data\_filestream[i] && (not m\_data\_filestream[i]->is\_open() or not m\_data\_filestream[i]->good())) 
      \{
197       std::stringstream err;
198       err << \_\_FILE\_\_ << \textcolor{stringliteral}{" "} << \_\_LINE\_\_
199           << \textcolor{stringliteral}{" ::  failed to open "} << b.str() << \textcolor{stringliteral}{" for reading"};
200       \textcolor{keywordflow}{throw} lbann\_exception(err.str());
201     \}
202     m\_data\_filestream[i]->unsetf(std::ios::skipws);
203     \textcolor{keywordflow}{if} (i==0) \{
204       m\_data\_filestream[i]->seekg(0, m\_data\_filestream[i]->end);
205       \hyperlink{classlbann_1_1imagenet__reader__single_aa1a20a782f97e697d9d70371a5e33384}{m\_file\_size} = m\_data\_filestream[i]->tellg();
206     \}
207     m\_data\_filestream[i]->seekg(0, m\_data\_filestream[i]->beg);
208   \}
209 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_a8db14d15bfc2de92ffb3c20f1a38dd00_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_a8db14d15bfc2de92ffb3c20f1a38dd00_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_af38327f44f1de2dd191cd2d1dc193900}\label{classlbann_1_1imagenet__reader__single_af38327f44f1de2dd191cd2d1dc193900}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1imagenet__reader__single}{imagenet\+\_\+reader\+\_\+single} \& lbann\+::imagenet\+\_\+reader\+\_\+single\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1imagenet__reader__single}{imagenet\+\_\+reader\+\_\+single} \&}]{source }\end{DoxyParamCaption})}



Definition at line 48 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp.


\begin{DoxyCode}
48                                                                                               \{
49   \textcolor{comment}{// check for self-assignment}
50   \textcolor{keywordflow}{if} (\textcolor{keyword}{this} == &source) \{
51     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
52   \}
53 
54   \textcolor{comment}{// Call the parent operator= function}
55   \hyperlink{classlbann_1_1imagenet__reader_a5ea15cc16aa679a2cb549b44eb77f323}{imagenet\_reader::operator=}(source);
56 
57   \hyperlink{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}{m\_offsets} = source.m\_offsets;
58   \hyperlink{classlbann_1_1imagenet__reader__single_a8db14d15bfc2de92ffb3c20f1a38dd00}{open\_data\_stream}();
59 
60   \textcolor{keywordflow}{return} (*\textcolor{keyword}{this});
61 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1imagenet__reader__single_af38327f44f1de2dd191cd2d1dc193900_cgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_af617e1b0b019049682db6de6e01b05ca}\label{classlbann_1_1imagenet__reader__single_af617e1b0b019049682db6de6e01b05ca}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!m\+\_\+data\+\_\+filestream@{m\+\_\+data\+\_\+filestream}}
\index{m\+\_\+data\+\_\+filestream@{m\+\_\+data\+\_\+filestream}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{m\+\_\+data\+\_\+filestream}{m\_data\_filestream}}
{\footnotesize\ttfamily std\+::vector$<$std\+::ifstream$\ast$$>$ lbann\+::imagenet\+\_\+reader\+\_\+single\+::m\+\_\+data\+\_\+filestream\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 58 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp.

\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_aa1a20a782f97e697d9d70371a5e33384}\label{classlbann_1_1imagenet__reader__single_aa1a20a782f97e697d9d70371a5e33384}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!m\+\_\+file\+\_\+size@{m\+\_\+file\+\_\+size}}
\index{m\+\_\+file\+\_\+size@{m\+\_\+file\+\_\+size}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{m\+\_\+file\+\_\+size}{m\_file\_size}}
{\footnotesize\ttfamily size\+\_\+t lbann\+::imagenet\+\_\+reader\+\_\+single\+::m\+\_\+file\+\_\+size\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 59 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp.

\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}\label{classlbann_1_1imagenet__reader__single_a605ba53f4e3fa02a4fced38d41465a10}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!m\+\_\+offsets@{m\+\_\+offsets}}
\index{m\+\_\+offsets@{m\+\_\+offsets}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{m\+\_\+offsets}{m\_offsets}}
{\footnotesize\ttfamily std\+::vector$<$std\+::pair$<$size\+\_\+t, int$>$ $>$ lbann\+::imagenet\+\_\+reader\+\_\+single\+::m\+\_\+offsets\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 61 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp.

\mbox{\Hypertarget{classlbann_1_1imagenet__reader__single_a499b197f1d985b592801de9adfe2d2f5}\label{classlbann_1_1imagenet__reader__single_a499b197f1d985b592801de9adfe2d2f5}} 
\index{lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}!m\+\_\+work\+\_\+buffer@{m\+\_\+work\+\_\+buffer}}
\index{m\+\_\+work\+\_\+buffer@{m\+\_\+work\+\_\+buffer}!lbann\+::imagenet\+\_\+reader\+\_\+single@{lbann\+::imagenet\+\_\+reader\+\_\+single}}
\subsubsection{\texorpdfstring{m\+\_\+work\+\_\+buffer}{m\_work\_buffer}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$unsigned char$>$ $>$ lbann\+::imagenet\+\_\+reader\+\_\+single\+::m\+\_\+work\+\_\+buffer\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 60 of file data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/data\+\_\+readers/\hyperlink{data__reader__imagenet__single_8hpp}{data\+\_\+reader\+\_\+imagenet\+\_\+single.\+hpp}\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/src/data\+\_\+readers/\hyperlink{data__reader__imagenet__single_8cpp}{data\+\_\+reader\+\_\+imagenet\+\_\+single.\+cpp}\end{DoxyCompactItemize}
