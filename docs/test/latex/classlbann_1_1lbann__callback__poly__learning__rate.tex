\hypertarget{classlbann_1_1lbann__callback__poly__learning__rate}{}\section{lbann\+:\+:lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate Class Reference}
\label{classlbann_1_1lbann__callback__poly__learning__rate}\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}


{\ttfamily \#include $<$callback\+\_\+learning\+\_\+rate.\+hpp$>$}



Inheritance diagram for lbann\+:\+:lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=192pt]{classlbann_1_1lbann__callback__poly__learning__rate__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for lbann\+:\+:lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=207pt]{classlbann_1_1lbann__callback__poly__learning__rate__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_ac36d25516687e0d0c43b51acae9eb1ff}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} (double p, uint64\+\_\+t n\+\_\+epochs, uint64\+\_\+t max\+\_\+iter)
\item 
\hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a4aba2a61c3b5d08c08909b7a4d78ea74}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} (double p, uint64\+\_\+t n\+\_\+epochs, uint64\+\_\+t max\+\_\+iter, std\+::unordered\+\_\+set$<$ \hyperlink{classlbann_1_1weights}{weights} $\ast$$>$ weights\+\_\+list)
\item 
\hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a9c55d816c11b6c79d0bbc145e7211995}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} (const \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} \&)=default
\item 
\hyperlink{classlbann_1_1lbann__callback__poly__learning__rate}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} \& \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a5e93001766ab49b38d0cc387362970e3}{operator=} (const \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} \&)=default
\item 
\hyperlink{classlbann_1_1lbann__callback__poly__learning__rate}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} $\ast$ \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_aea01c416903c421cf6dce1a7f320c94b}{copy} () const override
\item 
void \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a47d3d2a94157f1992bf4a964620208f3}{setup} (\hyperlink{classlbann_1_1model}{model} $\ast$m) override
\item 
std\+::string \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a755be6dc66e1c403edc69db11592a4ea}{name} () const override
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
float \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a6302be36ef16079105b812c7599dac76}{global\+\_\+schedule} (\hyperlink{classlbann_1_1model}{model} $\ast$m) override
\item 
float \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a55414af733e519be126572ec92492bf7}{optimizer\+\_\+schedule} (\hyperlink{classlbann_1_1model}{model} $\ast$m, \hyperlink{classlbann_1_1optimizer}{optimizer} \&opt) override
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a03c8c9a738036f9b778f11416112fd80}{m\+\_\+p}
\begin{DoxyCompactList}\small\item\em The exponent to compute new learning rate in poly policy. \end{DoxyCompactList}\item 
uint64\+\_\+t \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a493de3bbdea4bed802e663af9b81af8e}{m\+\_\+num\+\_\+epochs}
\begin{DoxyCompactList}\small\item\em The number of epochs for training. \end{DoxyCompactList}\item 
uint64\+\_\+t \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}{m\+\_\+max\+\_\+iter}
\begin{DoxyCompactList}\small\item\em The maximum number of iterations until which the learning rate changes. \end{DoxyCompactList}\item 
float \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}{m\+\_\+lr}
\begin{DoxyCompactList}\small\item\em The current rate to scale the base learning rate. \end{DoxyCompactList}\item 
float \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_aad95c34cfb705392bf38ecbb0dc97b32}{m\+\_\+last\+\_\+epoch\+\_\+lr}
\begin{DoxyCompactList}\small\item\em The learning rate scale used at the end of the last epoch. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
Decrease the learning rate by polynomial policy base\+\_\+lr$\ast$(1 -\/ i\+\_\+cur/i\+\_\+max)$^\wedge$p, where base\+\_\+lr is the initial learning rate, i\+\_\+cur is the current iteration, i\+\_\+max is the maximum iteration, and p is a parameter. 

Definition at line 238 of file callback\+\_\+learning\+\_\+rate.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_ac36d25516687e0d0c43b51acae9eb1ff}\label{classlbann_1_1lbann__callback__poly__learning__rate_ac36d25516687e0d0c43b51acae9eb1ff}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\index{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate()}{lbann\_callback\_poly\_learning\_rate()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate (\begin{DoxyParamCaption}\item[{double}]{p,  }\item[{uint64\+\_\+t}]{n\+\_\+epochs,  }\item[{uint64\+\_\+t}]{max\+\_\+iter }\end{DoxyParamCaption})}

This constructor takes the policy specific parameters, the exponent (p) and the maximum number of iterations (max\+\_\+iter). In case that max\+\_\+iter is set to 0, it is calculated from the number of epochs (n\+\_\+epochs). n\+\_\+epochs is not used otherwise. 

Definition at line 222 of file callback\+\_\+learning\+\_\+rate.\+cpp.


\begin{DoxyCode}
224   : \hyperlink{classlbann_1_1lbann__callback__learning__rate_a69687cd55f4d09c480e08e18488519fe}{lbann\_callback\_learning\_rate}(std::unordered\_set<weights *>()),
225     \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a03c8c9a738036f9b778f11416112fd80}{m\_p}(p), \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a493de3bbdea4bed802e663af9b81af8e}{m\_num\_epochs}(n\_epochs), \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}{m\_max\_iter}(max\_iter),
226     \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}{m\_lr}(1.0f), \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_aad95c34cfb705392bf38ecbb0dc97b32}{m\_last\_epoch\_lr}(1.0f) \{\}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a4aba2a61c3b5d08c08909b7a4d78ea74}\label{classlbann_1_1lbann__callback__poly__learning__rate_a4aba2a61c3b5d08c08909b7a4d78ea74}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\index{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate()}{lbann\_callback\_poly\_learning\_rate()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate (\begin{DoxyParamCaption}\item[{double}]{p,  }\item[{uint64\+\_\+t}]{n\+\_\+epochs,  }\item[{uint64\+\_\+t}]{max\+\_\+iter,  }\item[{std\+::unordered\+\_\+set$<$ \hyperlink{classlbann_1_1weights}{weights} $\ast$$>$}]{weights\+\_\+list }\end{DoxyParamCaption})}



Definition at line 228 of file callback\+\_\+learning\+\_\+rate.\+cpp.


\begin{DoxyCode}
230   : \hyperlink{classlbann_1_1lbann__callback__learning__rate_a69687cd55f4d09c480e08e18488519fe}{lbann\_callback\_learning\_rate}(weights\_list),
231     \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a03c8c9a738036f9b778f11416112fd80}{m\_p}(p), \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a493de3bbdea4bed802e663af9b81af8e}{m\_num\_epochs}(n\_epochs), \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}{m\_max\_iter}(max\_iter),
232     \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}{m\_lr}(1.0f), \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_aad95c34cfb705392bf38ecbb0dc97b32}{m\_last\_epoch\_lr}(1.0f) \{\}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a9c55d816c11b6c79d0bbc145e7211995}\label{classlbann_1_1lbann__callback__poly__learning__rate_a9c55d816c11b6c79d0bbc145e7211995}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\index{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate()}{lbann\_callback\_poly\_learning\_rate()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_aea01c416903c421cf6dce1a7f320c94b}\label{classlbann_1_1lbann__callback__poly__learning__rate_aea01c416903c421cf6dce1a7f320c94b}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!copy@{copy}}
\index{copy@{copy}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}$\ast$ lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::copy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \hyperlink{classlbann_1_1lbann__callback_a9f545d1269a8c7af335625d049691f26}{lbann\+::lbann\+\_\+callback}.



Definition at line 247 of file callback\+\_\+learning\+\_\+rate.\+hpp.


\begin{DoxyCode}
247                                                            \{
248     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_ac36d25516687e0d0c43b51acae9eb1ff}{lbann\_callback\_poly\_learning\_rate}(*\textcolor{keyword}{this});
249   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__poly__learning__rate_aea01c416903c421cf6dce1a7f320c94b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a6302be36ef16079105b812c7599dac76}\label{classlbann_1_1lbann__callback__poly__learning__rate_a6302be36ef16079105b812c7599dac76}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!global\+\_\+schedule@{global\+\_\+schedule}}
\index{global\+\_\+schedule@{global\+\_\+schedule}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{global\+\_\+schedule()}{global\_schedule()}}
{\footnotesize\ttfamily float lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::global\+\_\+schedule (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Keep the record of the learning rate at the end of the current epoch. 

Reimplemented from \hyperlink{classlbann_1_1lbann__callback__learning__rate_a7869b93e5963d6f76da68d8c8137b979}{lbann\+::lbann\+\_\+callback\+\_\+learning\+\_\+rate}.



Definition at line 248 of file callback\+\_\+learning\+\_\+rate.\+cpp.


\begin{DoxyCode}
248                                                                  \{
249   \textcolor{keyword}{const} \textcolor{keywordtype}{float} scale = \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}{m\_lr} / \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_aad95c34cfb705392bf38ecbb0dc97b32}{m\_last\_epoch\_lr};
250   \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_aad95c34cfb705392bf38ecbb0dc97b32}{m\_last\_epoch\_lr} = \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}{m\_lr};
251   \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1lbann__callback__learning__rate_a97194f282c29a748c915d9811a8a99fb}{m\_cur\_global\_lr} * scale;
252 \}
\end{DoxyCode}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a755be6dc66e1c403edc69db11592a4ea}\label{classlbann_1_1lbann__callback__poly__learning__rate_a755be6dc66e1c403edc69db11592a4ea}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!name@{name}}
\index{name@{name}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{name()}{name()}}
{\footnotesize\ttfamily std\+::string lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Return this callback\textquotesingle{}s name. 

Implements \hyperlink{classlbann_1_1lbann__callback_a7522c7a14f1d6a1ea762cc2d7248eb3a}{lbann\+::lbann\+\_\+callback}.



Definition at line 251 of file callback\+\_\+learning\+\_\+rate.\+hpp.


\begin{DoxyCode}
251 \{ \textcolor{keywordflow}{return} \textcolor{stringliteral}{"poly learning rate"}; \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__poly__learning__rate_a755be6dc66e1c403edc69db11592a4ea_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a5e93001766ab49b38d0cc387362970e3}\label{classlbann_1_1lbann__callback__poly__learning__rate_a5e93001766ab49b38d0cc387362970e3}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!operator=@{operator=}}
\index{operator=@{operator=}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}\& lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate}{lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}

\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a55414af733e519be126572ec92492bf7}\label{classlbann_1_1lbann__callback__poly__learning__rate_a55414af733e519be126572ec92492bf7}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!optimizer\+\_\+schedule@{optimizer\+\_\+schedule}}
\index{optimizer\+\_\+schedule@{optimizer\+\_\+schedule}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{optimizer\+\_\+schedule()}{optimizer\_schedule()}}
{\footnotesize\ttfamily float lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::optimizer\+\_\+schedule (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m,  }\item[{\hyperlink{classlbann_1_1optimizer}{optimizer} \&}]{opt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}

Compute the learning rate for the next iteration. 

Reimplemented from \hyperlink{classlbann_1_1lbann__callback__learning__rate_acf7f3921a68e7f1f772106e18c545345}{lbann\+::lbann\+\_\+callback\+\_\+learning\+\_\+rate}.



Definition at line 257 of file callback\+\_\+learning\+\_\+rate.\+cpp.


\begin{DoxyCode}
257                                                                                     \{
258   \textcolor{keyword}{const} uint64\_t cur\_iter = \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(m->get\_cur\_step());
259   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}{m\_max\_iter} > cur\_iter) \{
260     \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}{m\_lr} = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(std::pow(static\_cast<double>(\hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}{m\_max\_iter} - cur\_iter)/
      \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}{m\_max\_iter}, \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a03c8c9a738036f9b778f11416112fd80}{m\_p}));
261   \}
262   \textcolor{keyword}{const} \textcolor{keywordtype}{float} scale = \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}{m\_lr} / \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_aad95c34cfb705392bf38ecbb0dc97b32}{m\_last\_epoch\_lr};
263   \textcolor{keywordflow}{return} \hyperlink{classlbann_1_1lbann__callback__learning__rate_a97194f282c29a748c915d9811a8a99fb}{m\_cur\_global\_lr} * scale;
264 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__poly__learning__rate_a55414af733e519be126572ec92492bf7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a47d3d2a94157f1992bf4a964620208f3}\label{classlbann_1_1lbann__callback__poly__learning__rate_a47d3d2a94157f1992bf4a964620208f3}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!setup@{setup}}
\index{setup@{setup}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{setup()}{setup()}}
{\footnotesize\ttfamily void lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::setup (\begin{DoxyParamCaption}\item[{\hyperlink{classlbann_1_1model}{model} $\ast$}]{m }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Check if the maximum number of iterations is set. If not, compute it by the number of epochs and the number of iterations per epoch. 

Reimplemented from \hyperlink{classlbann_1_1lbann__callback__learning__rate_a501f31a6b8fde1282a60e4b347e8d9d3}{lbann\+::lbann\+\_\+callback\+\_\+learning\+\_\+rate}.



Definition at line 238 of file callback\+\_\+learning\+\_\+rate.\+cpp.


\begin{DoxyCode}
238                                                       \{
239   \hyperlink{classlbann_1_1lbann__callback__learning__rate_a501f31a6b8fde1282a60e4b347e8d9d3}{lbann\_callback\_learning\_rate::setup}(m);
240   \textcolor{keywordflow}{if} (\hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}{m\_max\_iter} == 0ull) \{
241     \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}{m\_max\_iter} = \hyperlink{classlbann_1_1lbann__callback__poly__learning__rate_a493de3bbdea4bed802e663af9b81af8e}{m\_num\_epochs} * m->get\_num\_iterations\_per\_epoch(
      \hyperlink{base_8hpp_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214}{execution\_mode::training});
242   \}
243 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classlbann_1_1lbann__callback__poly__learning__rate_a47d3d2a94157f1992bf4a964620208f3_cgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_aad95c34cfb705392bf38ecbb0dc97b32}\label{classlbann_1_1lbann__callback__poly__learning__rate_aad95c34cfb705392bf38ecbb0dc97b32}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!m\+\_\+last\+\_\+epoch\+\_\+lr@{m\+\_\+last\+\_\+epoch\+\_\+lr}}
\index{m\+\_\+last\+\_\+epoch\+\_\+lr@{m\+\_\+last\+\_\+epoch\+\_\+lr}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{m\+\_\+last\+\_\+epoch\+\_\+lr}{m\_last\_epoch\_lr}}
{\footnotesize\ttfamily float lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::m\+\_\+last\+\_\+epoch\+\_\+lr\hspace{0.3cm}{\ttfamily [private]}}



The learning rate scale used at the end of the last epoch. 



Definition at line 265 of file callback\+\_\+learning\+\_\+rate.\+hpp.

\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}\label{classlbann_1_1lbann__callback__poly__learning__rate_a02cb265abba03e10fcba2be3cbbafce4}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!m\+\_\+lr@{m\+\_\+lr}}
\index{m\+\_\+lr@{m\+\_\+lr}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{m\+\_\+lr}{m\_lr}}
{\footnotesize\ttfamily float lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::m\+\_\+lr\hspace{0.3cm}{\ttfamily [private]}}



The current rate to scale the base learning rate. 



Definition at line 263 of file callback\+\_\+learning\+\_\+rate.\+hpp.

\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}\label{classlbann_1_1lbann__callback__poly__learning__rate_a43c06187577baff885bda6177fe56c3f}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!m\+\_\+max\+\_\+iter@{m\+\_\+max\+\_\+iter}}
\index{m\+\_\+max\+\_\+iter@{m\+\_\+max\+\_\+iter}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{m\+\_\+max\+\_\+iter}{m\_max\_iter}}
{\footnotesize\ttfamily uint64\+\_\+t lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::m\+\_\+max\+\_\+iter\hspace{0.3cm}{\ttfamily [private]}}



The maximum number of iterations until which the learning rate changes. 



Definition at line 261 of file callback\+\_\+learning\+\_\+rate.\+hpp.

\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a493de3bbdea4bed802e663af9b81af8e}\label{classlbann_1_1lbann__callback__poly__learning__rate_a493de3bbdea4bed802e663af9b81af8e}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!m\+\_\+num\+\_\+epochs@{m\+\_\+num\+\_\+epochs}}
\index{m\+\_\+num\+\_\+epochs@{m\+\_\+num\+\_\+epochs}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{m\+\_\+num\+\_\+epochs}{m\_num\_epochs}}
{\footnotesize\ttfamily uint64\+\_\+t lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::m\+\_\+num\+\_\+epochs\hspace{0.3cm}{\ttfamily [private]}}



The number of epochs for training. 



Definition at line 259 of file callback\+\_\+learning\+\_\+rate.\+hpp.

\mbox{\Hypertarget{classlbann_1_1lbann__callback__poly__learning__rate_a03c8c9a738036f9b778f11416112fd80}\label{classlbann_1_1lbann__callback__poly__learning__rate_a03c8c9a738036f9b778f11416112fd80}} 
\index{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}!m\+\_\+p@{m\+\_\+p}}
\index{m\+\_\+p@{m\+\_\+p}!lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate@{lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate}}
\subsubsection{\texorpdfstring{m\+\_\+p}{m\_p}}
{\footnotesize\ttfamily double lbann\+::lbann\+\_\+callback\+\_\+poly\+\_\+learning\+\_\+rate\+::m\+\_\+p\hspace{0.3cm}{\ttfamily [private]}}



The exponent to compute new learning rate in poly policy. 



Definition at line 257 of file callback\+\_\+learning\+\_\+rate.\+hpp.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/include/lbann/callbacks/\hyperlink{callback__learning__rate_8hpp}{callback\+\_\+learning\+\_\+rate.\+hpp}\item 
/\+Users/mckinney27/doxy-\/testbed/lbann/src/callbacks/\hyperlink{callback__learning__rate_8cpp}{callback\+\_\+learning\+\_\+rate.\+cpp}\end{DoxyCompactItemize}
